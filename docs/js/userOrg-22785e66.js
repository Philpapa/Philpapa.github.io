import{h as n}from"./_vue@2.7.16@vue-83e28a6d.js";import{u as l}from"./useUserQuery-eb6f6700.js";import{n as p,N as d}from"./index-69501200.js";import"./_@antv_x6-common@2.0.17@@antv-5f61d1c3.js";import"./_lodash-es@4.17.21@lodash-es-326016e5.js";import"./_element-ui@2.15.14@element-ui-fc052bc5.js";import"./_deepmerge@1.5.2@deepmerge-251d9111.js";import"./_resize-observer-polyfill@1.5.1@resize-observer-polyfill-9304753a.js";import"./_throttle-debounce@1.1.0@throttle-debounce-d93b3c53.js";import"./_babel-helper-vue-jsx-merge-props@2.0.3@babel-helper-vue-jsx-merge-props-72d30afb.js";import"./_normalize-wheel@1.0.1@normalize-wheel-1b789469.js";import"./_async-validator@1.8.5@async-validator-0d2cd599.js";import"./_babel-runtime@6.26.0@babel-runtime-ff8b37cd.js";import"./_core-js@2.6.12@core-js-edebcccf.js";import"./_vuex@3.6.2@vuex-0d722715.js";import"./_axios@1.6.6@axios-0e1c8a69.js";import"./_side-channel@1.0.4@side-channel-286692b5.js";import"./_get-intrinsic@1.2.2@get-intrinsic-d65d77de.js";import"./_has-symbols@1.0.3@has-symbols-af84758f.js";import"./_has-proto@1.0.1@has-proto-ed1b0be6.js";import"./_function-bind@1.1.2@function-bind-0a5fc7a8.js";import"./_hasown@2.0.0@hasown-843e4100.js";import"./_call-bind@1.0.5@call-bind-875e1b33.js";import"./_set-function-length@1.2.0@set-function-length-16fcf548.js";import"./_define-data-property@1.1.1@define-data-property-b4413702.js";import"./_has-property-descriptors@1.0.1@has-property-descriptors-19326040.js";import"./_gopd@1.0.1@gopd-5fc553b7.js";import"./_qs@6.11.2@qs-b0c89749.js";import"./_vue-router@3.5.3@vue-router-44f70d6f.js";import"./_nanoid@3.3.7@nanoid-3ec3f908.js";import"./_gm-crypto@0.1.12@gm-crypto-0d53e928.js";import"./_to-arraybuffer@1.0.1@to-arraybuffer-11df8309.js";import"./_buffer@5.7.1@buffer-3f1a9d90.js";import"./_base64-js@1.5.1@base64-js-787d8b6c.js";import"./_ieee754@1.2.1@ieee754-00029a05.js";import"./_jsbn@1.1.0@jsbn-569987c9.js";import"./_element-resize-detector@1.2.4@element-resize-detector-0b105688.js";import"./_batch-processor@1.0.0@batch-processor-252a9c8d.js";import"./_@vueuse_core@10.7.2@@vueuse-c641c031.js";import"./_@vueuse_shared@10.7.2@@vueuse-de6891b4.js";import"./_vue-demi@0.14.6@vue-demi-7b32015b.js";import"./_v-region@2.3.0@v-region-1f02d150.js";import"./_@antv_x6@2.18.1@@antv-b1d372ee.js";import"./_@antv_x6-geometry@2.0.5@@antv-094791ee.js";import"./_@antv_x6-vue-shape@2.1.1@@antv-8e71ca73.js";import"./_vuedraggable@2.24.3@vuedraggable-31bb3ba2.js";import"./_sortablejs@1.10.2@sortablejs-39264ca6.js";const c=n({name:"userOrg",setup(){const[e,t,a,i,r,s,o]=l({api:d,params:{}});return i(),{reqLoading:e,page:t,list:a,queryCB:i,changeSize:r,changeCurrent:s,deletePageChange:o}},data(){return{options:[]}},methods:{edit(e){e.cache=JSON.stringify(e);const t=e.hasright_orgid?e.hasright_orgid.split(","):[];this.$set(e,"oriIds",t),this.$set(e,"edit",!0)},orgChange(e){e.hasright_orgid="",e.hasright_orgname="",e.oriIds=[]},OrgInfo(){this.$api.userorg.getOrgInfo({}).then(e=>{e.status===104&&(this.options=e.data)})},save(e){const{oriIds:t,defalut_orgid:a}=e;if(t.length){const i=[];t.forEach(r=>{const s=this.options.find(o=>o.id===r);i.push(s.name)}),e.hasright_orgid=t.join(","),e.hasright_orgname=i.join(",")}else e.hasright_orgid="",e.hasright_orgname="";a&&(e.defalut_orgname=this.options.find(i=>i.id===a).name),e.loading=!0,this.$api.userorg.submit({...e}).then(i=>{i.status===100&&(this.$message({type:"success",message:i.msg}),this.queryCB())}).finally(()=>{e.loading=!1})},cancel(e){const t=JSON.parse(e.cache);Object.keys(t).forEach(a=>{e[a]=t[a]}),e.edit=!1},orgFilterHandler(e,t){!e||(t.oriIds=t.oriIds.filter(a=>a!==e))}},created(){this.OrgInfo()}});var m=function(){var t=this,a=t._self._c;return t._self._setupProxy,a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.reqLoading,expression:"reqLoading"}],staticClass:"organization-con"},[a("el-table",{staticClass:"plain_table",staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",data:t.list,height:"calc(100% - 60px)"}},[a("el-table-column",{attrs:{type:"index",label:"\u5E8F\u53F7",width:"75"}}),a("el-table-column",{attrs:{prop:"id",label:"\u7528\u6237id",width:"130"}}),a("el-table-column",{attrs:{prop:"name",label:"\u7528\u6237\u540D",width:"180"}}),a("el-table-column",{attrs:{prop:"defalut_orgname","show-overflow-ellipsis":"",label:"\u9ED8\u8BA4\u7EC4\u7EC7\u673A\u6784",width:"210"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[i.edit?a("el-select",{attrs:{placeholder:"\u8BF7\u9009\u62E9",size:"mini"},on:{change:r=>{t.orgFilterHandler(r,i)}},model:{value:i.defalut_orgid,callback:function(r){t.$set(i,"defalut_orgid",r)},expression:"row.defalut_orgid"}},t._l(t.options,function(r){return a("el-option",{key:r.id,attrs:{label:r.name,value:r.id}})}),1):[t._v(t._s(i.defalut_orgname))]]}}])}),a("el-table-column",{attrs:{prop:"hasright_orgname","show-overflow-ellipsis":"",label:"\u6709\u6743\u9650\u7684\u673A\u6784"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[i.edit?a("el-select",{attrs:{multiple:"","collapse-tags":"",placeholder:"\u8BF7\u9009\u62E9",size:"mini"},model:{value:i.oriIds,callback:function(r){t.$set(i,"oriIds",r)},expression:"row.oriIds"}},t._l(t.options.filter(r=>r.id!==i.defalut_orgid),function(r){return a("el-option",{key:r.id,attrs:{label:r.name,value:r.id}})}),1):[t._v(t._s(i.hasright_orgname))]]}}])}),a("el-table-column",{attrs:{label:"\u64CD\u4F5C",width:"130"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[i.edit?t._e():a("el-button",{attrs:{type:"text"},on:{click:function(r){return t.edit(i)}}},[t._v("\u7F16\u8F91")]),i.edit?a("el-button",{attrs:{type:"text",loading:i.loading},on:{click:function(r){return t.save(i)}}},[t._v("\u4FDD\u5B58")]):t._e(),i.edit?a("el-button",{staticClass:"cancel-btn",attrs:{type:"text"},on:{click:function(r){return t.cancel(i)}}},[t._v("\u53D6\u6D88")]):t._e()]}}])})],1),a("d-page",{staticClass:"c-paginate",attrs:{"pager-count":5,"current-page":t.page.pageNum,"page-sizes":[10,20,30,50,100],"page-size":t.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.page.total},on:{"current-change":t.changeCurrent,"size-change":t.changeSize}})],1)},u=[],g=p(c,m,u,!1,null,"002ae106",null,null);const lt=g.exports;export{lt as default};

import{c as n}from"./category-7c1bf082.js";import{n as l,_ as d}from"./index-69501200.js";import"./_vue@2.7.16@vue-83e28a6d.js";import"./_@antv_x6-common@2.0.17@@antv-5f61d1c3.js";import"./_lodash-es@4.17.21@lodash-es-326016e5.js";import"./_element-ui@2.15.14@element-ui-fc052bc5.js";import"./_deepmerge@1.5.2@deepmerge-251d9111.js";import"./_resize-observer-polyfill@1.5.1@resize-observer-polyfill-9304753a.js";import"./_throttle-debounce@1.1.0@throttle-debounce-d93b3c53.js";import"./_babel-helper-vue-jsx-merge-props@2.0.3@babel-helper-vue-jsx-merge-props-72d30afb.js";import"./_normalize-wheel@1.0.1@normalize-wheel-1b789469.js";import"./_async-validator@1.8.5@async-validator-0d2cd599.js";import"./_babel-runtime@6.26.0@babel-runtime-ff8b37cd.js";import"./_core-js@2.6.12@core-js-edebcccf.js";import"./_vuex@3.6.2@vuex-0d722715.js";import"./_axios@1.6.6@axios-0e1c8a69.js";import"./_side-channel@1.0.4@side-channel-286692b5.js";import"./_get-intrinsic@1.2.2@get-intrinsic-d65d77de.js";import"./_has-symbols@1.0.3@has-symbols-af84758f.js";import"./_has-proto@1.0.1@has-proto-ed1b0be6.js";import"./_function-bind@1.1.2@function-bind-0a5fc7a8.js";import"./_hasown@2.0.0@hasown-843e4100.js";import"./_call-bind@1.0.5@call-bind-875e1b33.js";import"./_set-function-length@1.2.0@set-function-length-16fcf548.js";import"./_define-data-property@1.1.1@define-data-property-b4413702.js";import"./_has-property-descriptors@1.0.1@has-property-descriptors-19326040.js";import"./_gopd@1.0.1@gopd-5fc553b7.js";import"./_qs@6.11.2@qs-b0c89749.js";import"./_vue-router@3.5.3@vue-router-44f70d6f.js";import"./_nanoid@3.3.7@nanoid-3ec3f908.js";import"./_gm-crypto@0.1.12@gm-crypto-0d53e928.js";import"./_to-arraybuffer@1.0.1@to-arraybuffer-11df8309.js";import"./_buffer@5.7.1@buffer-3f1a9d90.js";import"./_base64-js@1.5.1@base64-js-787d8b6c.js";import"./_ieee754@1.2.1@ieee754-00029a05.js";import"./_jsbn@1.1.0@jsbn-569987c9.js";import"./_element-resize-detector@1.2.4@element-resize-detector-0b105688.js";import"./_batch-processor@1.0.0@batch-processor-252a9c8d.js";import"./_@vueuse_core@10.7.2@@vueuse-c641c031.js";import"./_@vueuse_shared@10.7.2@@vueuse-de6891b4.js";import"./_vue-demi@0.14.6@vue-demi-7b32015b.js";import"./_v-region@2.3.0@v-region-1f02d150.js";import"./_@antv_x6@2.18.1@@antv-b1d372ee.js";import"./_@antv_x6-geometry@2.0.5@@antv-094791ee.js";import"./_@antv_x6-vue-shape@2.1.1@@antv-8e71ca73.js";import"./_vuedraggable@2.24.3@vuedraggable-31bb3ba2.js";import"./_sortablejs@1.10.2@sortablejs-39264ca6.js";const m={name:"dataSource",data(){return{loading:!1,actived:"sqlserver",title:"\u57FA\u7840\u914D\u7F6E",btnState:"view",btnloading:!1,form:{dat_name:"",dat_sevip:"",dat_dbname:"",dat_username:"",dat_password:""},showFormVisible:!1,rules:{dat_name:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u636E\u6E90\u540D\u79F0",trigger:"blur"}],dat_username:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:"blur"}],dat_password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"}],dat_dbname:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u636E\u5E93\u540D\u79F0",trigger:"blur"}],dat_sevip:[{required:!0,message:"\u8BF7\u8F93\u5165\u94FE\u63A5\u5730\u5740",trigger:"blur"}]},list:[],showMoreId:"",cacheInfo:null,showTab:!0,currentGroup:{}}},components:{category:n},methods:{handleMoreCommand(a,t){a==="a"?this.test(t):a==="b"&&this.saveMove(t)},changeState(){this.btnState="save",this.form.dat_password=""},getList(a,t){const e={filter:{type:a,dat_range:t},pageNum:0,pageSize:0};this.actived=a,this.loading=!0,this.list=[],this.$api.customForm.getDataSourceList(e).then(s=>{const{status:i,msg:r,data:{list:o}}=s;i==104?this.list=o:this.$message.warning(r)}).finally(()=>{this.loading=!1})},test(a){console.log(a);const t=this.currentGroup.dat_range,e={name:a?a.dat_name:this.form.dat_name,dbname:a?a.dat_dbname:this.form.dat_dbname,username:a?a.dat_username:this.form.dat_username,password:a?a.dat_password:this.form.dat_password,sevip:a?a.dat_sevip:this.form.dat_sevip,type:this.actived,act:this.btnState==="view"?"view":"add",dat_range:t};a?this.$api.customForm.testLink(e).then(s=>{s.status==100&&this.$message({type:"success",message:s.msg})}):this.$refs.sForm.validate(s=>{s&&this.$api.customForm.testLink(e).then(i=>{i.status==100&&this.$message({type:"success",message:i.msg})})})},handleAdd(){this.title="\u65B0\u5EFA",this.showFormVisible=!0,this.btnState="save",this.cacheInfo=JSON.parse(JSON.stringify(this.list))},handleUpdate(a,t){this.cacheInfo=JSON.parse(JSON.stringify(this.list)),this.title=t==="save"?"\u7F16\u8F91":"\u67E5\u770B",this.btnState=t,this.form=a,t==="save"&&(this.form.dat_password=""),console.log(this.form),this.showFormVisible=!0},handleDelete(a){this.$confirm("\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664, \u662F\u5426\u7EE7\u7EED?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88"}).then(()=>{this.$api.customForm.submitDtsInfo({id:a.dat_id,act:"del"}).then(t=>{t.status==102?(this.$message({type:"success",message:t.msg}),this.getList(this.currentGroup.id,this.currentGroup.dat_range)):this.$message({type:"warning",message:t.msg})})}).catch(()=>{})},saveUpdate(a){const t=this.currentGroup.dat_range,e={name:this.form.dat_name,dbname:this.form.dat_dbname,username:this.form.dat_username,password:this.form.dat_password,sevip:this.form.dat_sevip,type:this.actived,act:a?"mod":"add",dat_range:t};a&&this.$set(e,"id",a),this.$refs.sForm.validate(s=>{s&&(this.btnloading=!0,this.$api.customForm.submitDtsInfo(e).then(i=>{i.status==100?(this.$message({type:"success",message:i.msg}),this.closeDialog(),this.getList(this.currentGroup.id,this.currentGroup.dat_range),this.btnState="view"):this.$message({type:"warning",message:i.msg})}).catch(i=>{console.log(i)}).finally(()=>{this.cacheInfo=null,this.btnloading=!1}))})},closeDialog(){this.$refs.sForm.resetFields(),this.$refs.sForm.clearValidate(),this.list=JSON.parse(JSON.stringify(this.cacheInfo)),console.log(this.list,"this.list"),this.cacheInfo=null,this.form=this.$options.data().form,this.showFormVisible=!1},saveMove(a){console.log(a,"item"),this.$api.customForm.actDatasource({act:"mov",id:a.dat_id,dat_range:this.currentGroup.dat_range==="0"?"1":"0"}).then(t=>{t.status==100?(this.$message.success({message:t.msg}),this.getList(this.currentGroup.id,this.currentGroup.dat_range)):this.$message({type:"warning",message:t.msg})})}}};var c=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"container"},[e("div",{staticClass:"asideBox"},[e("category",{attrs:{type:"4",title:"\u6570\u636E\u6E90\u914D\u7F6E"},on:{"node-click":(s,i)=>{t.currentGroup={...s,dat_range:i},t.getList(s.id,i)},"tab-toggle":s=>{t.showTab=s}}})],1),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"contentboxRight"},[e("div",{staticClass:"demo-form-inline",class:{isIndent:!t.showTab}},[e("div",{staticClass:"breadCrumb"},[e("span",{staticClass:"cateName"},[t._v(t._s(t.currentGroup.name))]),e("span",{staticClass:"count"},[t._v("/\u5171"+t._s(t.list.length)+"\u6761\u6570\u636E")])]),e("el-button",{staticStyle:{"border-radius":"4px!important"},attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:t.handleAdd}},[t._v("\u65B0\u589E")])],1),e("div",{staticClass:"card-container"},[t.list&&t.list.length>0?t._l(t.list,function(s){return e("div",{key:s.dat_id,staticClass:"card-item"},[e("div",{staticClass:"card-item-title",attrs:{title:s.dat_name}},[e("div",{staticClass:"card-item-box"},[e("div",{staticClass:"card-item-name"},[t._v(" "+t._s(s.dat_name)+" ")]),e("i",{class:`el-icon-my-${t.actived}`})]),e("div",{staticClass:"card-item-flex"},[e("div",{staticClass:"cart-item-box2"},[e("dIcon",{attrs:{name:"link",size:"13"}}),e("div",{staticClass:"card-item-name"},[t._v(" "+t._s(s.dat_sevip)+" ")])],1),e("div",{staticClass:"cart-item-box2"},[e("dIcon",{attrs:{name:"database",size:"13"}}),e("div",{staticClass:"card-item-name"},[t._v(" "+t._s(s.dat_dbname)+" ")])],1)])]),e("div",{staticClass:"card-item-tool"},[e("div",{staticClass:"tools-box"},[e("div",{staticClass:"tools-btn",on:{click:function(i){return t.handleUpdate(s,"save")}}},[e("dIcon",{attrs:{name:"edit"}}),e("span",[t._v("\u7F16\u8F91")])],1),e("div",{staticClass:"tools-btn",on:{click:function(i){return t.handleUpdate(s,"view")}}},[e("dIcon",{attrs:{name:"viewLst"}}),e("span",[t._v("\u67E5\u770B")])],1),e("div",{staticClass:"tools-btn",on:{click:function(i){return t.handleDelete(s)}}},[e("dIcon",{attrs:{name:"delLst"}}),e("span",[t._v("\u5220\u9664")])],1)]),e("div",{staticClass:"card-item-dropMenu"},[e("el-dropdown",{attrs:{trigger:"click",placement:"bottom-start","hide-on-click":!1},on:{"visible-change":i=>{i?t.showMoreId=s.dat_id:t.showMoreId=""},command:i=>{t.handleMoreCommand(i,s)}}},[e("i",{staticClass:"el-dropdown-link",class:t.showMoreId===s.dat_id?"el-icon-my-moreActive":"el-icon-my-more",staticStyle:{cursor:"pointer"}}),e("el-dropdown-menu",[e("el-dropdown-item",{attrs:{command:"b"}},[t._v(" \u79FB\u52A8\u81F3"+t._s(t.currentGroup.dat_range==="0"?"\u5E73\u53F0\u7A7A\u95F4":"\u7EC4\u7EC7\u7A7A\u95F4")+" ")])],1)],1)],1)])])}):e("div",{staticClass:"empty-container"},[e("el-empty",{attrs:{image:d,description:"\u6682\u65E0\u6570\u636E\u54E6\uFF5E","image-size":280}})],1)],2)]),e("el-dialog",{staticClass:"dataSource-dialog",attrs:{"z-index":1e3,title:t.title,"close-on-click-modal":!1,visible:t.showFormVisible,"before-close":t.closeDialog},on:{"update:visible":function(s){t.showFormVisible=s}}},[e("el-form",{ref:"sForm",attrs:{model:t.form,rules:t.rules,size:"mini","label-width":"110px"}},[e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"\u6570\u636E\u6E90\u7C7B\u578B",prop:""}},[e("el-input",{attrs:{disabled:""},model:{value:t.actived,callback:function(s){t.actived=typeof s=="string"?s.trim():s},expression:"actived"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"\u6570\u636E\u6E90\u540D\u79F0",prop:"dat_name"}},[e("el-input",{attrs:{maxlength:"15",disabled:t.btnState==="view"},model:{value:t.form.dat_name,callback:function(s){t.$set(t.form,"dat_name",typeof s=="string"?s.trim():s)},expression:"form.dat_name"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"\u94FE\u63A5\u5730\u5740",prop:"dat_sevip"}},[e("el-input",{attrs:{disabled:t.btnState==="view"},model:{value:t.form.dat_sevip,callback:function(s){t.$set(t.form,"dat_sevip",typeof s=="string"?s.trim():s)},expression:"form.dat_sevip"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"\u6570\u636E\u5E93\u540D\u79F0",prop:"dat_dbname"}},[e("el-input",{attrs:{maxlength:"15",disabled:t.btnState==="view"},model:{value:t.form.dat_dbname,callback:function(s){t.$set(t.form,"dat_dbname",typeof s=="string"?s.trim():s)},expression:"form.dat_dbname"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"\u7528\u6237\u540D",prop:"dat_username"}},[e("el-input",{attrs:{maxlength:"15",disabled:t.btnState==="view"},model:{value:t.form.dat_username,callback:function(s){t.$set(t.form,"dat_username",typeof s=="string"?s.trim():s)},expression:"form.dat_username"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"\u5BC6\u7801",prop:"dat_password"}},[e("el-input",{attrs:{type:"password",maxlength:"30",disabled:t.btnState==="view"},model:{value:t.form.dat_password,callback:function(s){t.$set(t.form,"dat_password",typeof s=="string"?s.trim():s)},expression:"form.dat_password"}})],1)],1)],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.title==="\u7F16\u8F91"||t.title==="\u65B0\u5EFA"?e("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:function(s){return t.test(null)}}},[t._v("\u6D4B\u8BD5\u8FDE\u63A5")]):t._e(),t.title==="\u7F16\u8F91"&&t.btnState==="save"?e("el-button",{attrs:{type:"primary",size:"small",loading:t.btnloading},on:{click:function(s){return t.saveUpdate(t.form.dat_id)}}},[t._v("\u4FDD\u5B58")]):t._e(),t.title==="\u65B0\u5EFA"?e("el-button",{attrs:{type:"primary",size:"small",loading:t.btnloading},on:{click:function(s){return t.saveUpdate()}}},[t._v("\u4FDD\u5B58")]):t._e(),e("el-button",{attrs:{size:"small"},on:{click:t.closeDialog}},[t._v("\u53D6\u6D88")])],1)],1)],1)},p=[],u=l(m,c,p,!1,null,"225d57cd",null,null);const nt=u.exports;export{nt as default};

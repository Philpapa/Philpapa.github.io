import{r as D,c as w}from"./_@antv_x6-common@2.0.17@@antv-e9d2c7f8.js";import{r as B}from"./_@antv_x6-geometry@2.0.5@@antv-5981308d.js";var no={},Zn={},Je={},Z={},Ze={},Ge={},ke={},ae={},Bi={},z={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.Registry=void 0;const r=D;class i{constructor(c){this.options=Object.assign({},c),this.data=this.options.data||{},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this)}get names(){return Object.keys(this.data)}register(c,f,h=!1){if(typeof c=="object"){Object.entries(c).forEach(([s,e])=>{this.register(s,e,f)});return}this.exist(c)&&!h&&!r.Platform.isApplyingHMR()&&this.onDuplicated(c);const u=this.options.process,g=u?r.FunctionExt.call(u,this,c,f):f;return this.data[c]=g,g}unregister(c){const f=c?this.data[c]:null;return delete this.data[c],f}get(c){return c?this.data[c]:null}exist(c){return c?this.data[c]!=null:!1}onDuplicated(c){try{throw this.options.onConflict&&r.FunctionExt.call(this.options.onConflict,this,c),new Error(`${r.StringExt.upperFirst(this.options.type)} with name '${c}' already registered.`)}catch(f){throw f}}onNotFound(c,f){throw new Error(this.getSpellingSuggestion(c,f))}getSpellingSuggestion(c,f){const h=this.getSpellingSuggestionForName(c),u=f?`${f} ${r.StringExt.lowerFirst(this.options.type)}`:this.options.type;return`${r.StringExt.upperFirst(u)} with name '${c}' does not exist.${h?` Did you mean '${h}'?`:""}`}getSpellingSuggestionForName(c){return r.StringExt.getSpellingSuggestion(c,Object.keys(this.data),f=>f)}}o.Registry=i,function(l){function c(f){return new l(f)}l.create=c}(i=o.Registry||(o.Registry={}))})(z);var Ni={},vt={};Object.defineProperty(vt,"__esModule",{value:!0});vt.dot=void 0;const ro=D;vt.dot={color:"#aaaaaa",thickness:1,markup:"rect",update(o,r){const i=r.thickness*r.sx,l=r.thickness*r.sy;ro.Dom.attr(o,{width:i,height:l,rx:i,ry:l,fill:r.color})}};var _t={};Object.defineProperty(_t,"__esModule",{value:!0});_t.fixedDot=void 0;const io=D;_t.fixedDot={color:"#aaaaaa",thickness:1,markup:"rect",update(o,r){const i=r.sx<=1?r.thickness*r.sx:r.thickness;io.Dom.attr(o,{width:i,height:i,rx:i,ry:i,fill:r.color})}};var wt={};Object.defineProperty(wt,"__esModule",{value:!0});wt.mesh=void 0;const so=D;wt.mesh={color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(o,r){let i;const l=r.width,c=r.height,f=r.thickness;l-f>=0&&c-f>=0?i=["M",l,0,"H0 M0 0 V0",c].join(" "):i="M 0 0 0 0",so.Dom.attr(o,{d:i,stroke:r.color,"stroke-width":r.thickness})}};var Pt={};Object.defineProperty(Pt,"__esModule",{value:!0});Pt.doubleMesh=void 0;const $r=D;Pt.doubleMesh=[{color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(o,r){let i;const l=r.width,c=r.height,f=r.thickness;l-f>=0&&c-f>=0?i=["M",l,0,"H0 M0 0 V0",c].join(" "):i="M 0 0 0 0",$r.Dom.attr(o,{d:i,stroke:r.color,"stroke-width":r.thickness})}},{color:"rgba(224,224,224,0.2)",thickness:3,factor:4,markup:"path",update(o,r){let i;const l=r.factor||1,c=r.width*l,f=r.height*l,h=r.thickness;c-h>=0&&f-h>=0?i=["M",c,0,"H0 M0 0 V0",f].join(" "):i="M 0 0 0 0",r.width=c,r.height=f,$r.Dom.attr(o,{d:i,stroke:r.color,"stroke-width":r.thickness})}}];(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(vt,o),i(_t,o),i(wt,o),i(Pt,o)})(Ni);(function(o){var r=w&&w.__createBinding||(Object.create?function(g,s,e,t){t===void 0&&(t=e);var n=Object.getOwnPropertyDescriptor(s,e);(!n||("get"in n?!s.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return s[e]}}),Object.defineProperty(g,t,n)}:function(g,s,e,t){t===void 0&&(t=e),g[t]=s[e]}),i=w&&w.__setModuleDefault||(Object.create?function(g,s){Object.defineProperty(g,"default",{enumerable:!0,value:s})}:function(g,s){g.default=s}),l=w&&w.__importStar||function(g){if(g&&g.__esModule)return g;var s={};if(g!=null)for(var e in g)e!=="default"&&Object.prototype.hasOwnProperty.call(g,e)&&r(s,g,e);return i(s,g),s};Object.defineProperty(o,"__esModule",{value:!0}),o.Grid=void 0;const c=D,f=z,h=l(Ni);class u{constructor(){this.patterns={},this.root=c.Vector.create(c.Dom.createSvgDocument(),{width:"100%",height:"100%"},[c.Dom.createSvgElement("defs")]).node}add(s,e){const t=this.root.childNodes[0];t&&t.appendChild(e),this.patterns[s]=e,c.Vector.create("rect",{width:"100%",height:"100%",fill:`url(#${s})`}).appendTo(this.root)}get(s){return this.patterns[s]}has(s){return this.patterns[s]!=null}}o.Grid=u,function(g){g.presets=h,g.registry=f.Registry.create({type:"grid"}),g.registry.register(g.presets,!0)}(u=o.Grid||(o.Grid={}))})(Bi);var Ri={},$i={},Ot={};Object.defineProperty(Ot,"__esModule",{value:!0});Ot.flipX=void 0;const oo=function(o){const r=document.createElement("canvas"),i=o.width,l=o.height;r.width=i*2,r.height=l;const c=r.getContext("2d");return c.drawImage(o,0,0,i,l),c.translate(2*i,0),c.scale(-1,1),c.drawImage(o,0,0,i,l),r};Ot.flipX=oo;var xt={};Object.defineProperty(xt,"__esModule",{value:!0});xt.flipY=void 0;const ao=function(o){const r=document.createElement("canvas"),i=o.width,l=o.height;r.width=i,r.height=l*2;const c=r.getContext("2d");return c.drawImage(o,0,0,i,l),c.translate(0,2*l),c.scale(1,-1),c.drawImage(o,0,0,i,l),r};xt.flipY=ao;var Ct={};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.flipXY=void 0;const lo=function(o){const r=document.createElement("canvas"),i=o.width,l=o.height;r.width=2*i,r.height=2*l;const c=r.getContext("2d");return c.drawImage(o,0,0,i,l),c.setTransform(-1,0,0,-1,r.width,r.height),c.drawImage(o,0,0,i,l),c.setTransform(-1,0,0,1,r.width,0),c.drawImage(o,0,0,i,l),c.setTransform(1,0,0,-1,0,r.height),c.drawImage(o,0,0,i,l),r};Ct.flipXY=lo;var Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.watermark=void 0;const co=B,uo=function(o,r){const i=o.width,l=o.height,c=document.createElement("canvas");c.width=i*3,c.height=l*3;const f=c.getContext("2d"),h=r.angle!=null?-r.angle:-20,u=co.Angle.toRad(h),g=c.width/4,s=c.height/4;for(let e=0;e<4;e+=1)for(let t=0;t<4;t+=1)(e+t)%2>0&&(f.setTransform(1,0,0,1,(2*e-1)*g,(2*t-1)*s),f.rotate(u),f.drawImage(o,-i/2,-l/2,i,l));return c};Mt.watermark=uo;(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(Ot,o),i(xt,o),i(Ct,o),i(Mt,o)})($i);(function(o){var r=w&&w.__createBinding||(Object.create?function(h,u,g,s){s===void 0&&(s=g);var e=Object.getOwnPropertyDescriptor(u,g);(!e||("get"in e?!u.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return u[g]}}),Object.defineProperty(h,s,e)}:function(h,u,g,s){s===void 0&&(s=g),h[s]=u[g]}),i=w&&w.__setModuleDefault||(Object.create?function(h,u){Object.defineProperty(h,"default",{enumerable:!0,value:u})}:function(h,u){h.default=u}),l=w&&w.__importStar||function(h){if(h&&h.__esModule)return h;var u={};if(h!=null)for(var g in h)g!=="default"&&Object.prototype.hasOwnProperty.call(h,g)&&r(u,h,g);return i(u,h),u};Object.defineProperty(o,"__esModule",{value:!0}),o.Background=void 0;const c=z,f=l($i);(function(h){h.presets=Object.assign({},f),h.presets["flip-x"]=f.flipX,h.presets["flip-y"]=f.flipY,h.presets["flip-xy"]=f.flipXY,h.registry=c.Registry.create({type:"background pattern"}),h.registry.register(h.presets,!0)})(o.Background||(o.Background={}))})(Ri);var Vi={},Li={},Et={},U={};Object.defineProperty(U,"__esModule",{value:!0});U.getNumber=U.getString=void 0;function ho(o,r){return o!=null?o:r}U.getString=ho;function go(o,r){return o!=null&&Number.isFinite(o)?o:r}U.getNumber=go;Object.defineProperty(Et,"__esModule",{value:!0});Et.outline=void 0;const lt=U;function fo(o={}){const r=(0,lt.getString)(o.color,"blue"),i=(0,lt.getNumber)(o.width,1),l=(0,lt.getNumber)(o.margin,2),c=(0,lt.getNumber)(o.opacity,1),f=l,h=l+i;return`
    <filter>
      <feFlood flood-color="${r}" flood-opacity="${c}" result="colored"/>
      <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${h}" />
      <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${f}" />
      <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>
      <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>
      <feMerge>
        <feMergeNode in="outline"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  `.trim()}Et.outline=fo;var jt={};Object.defineProperty(jt,"__esModule",{value:!0});jt.highlight=void 0;const ct=U;function po(o={}){const r=(0,ct.getString)(o.color,"red"),i=(0,ct.getNumber)(o.blur,0),l=(0,ct.getNumber)(o.width,1),c=(0,ct.getNumber)(o.opacity,1);return`
      <filter>
        <feFlood flood-color="${r}" flood-opacity="${c}" result="colored"/>
        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${l}"/>
        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>
        <feGaussianBlur result="blured" in="composed" stdDeviation="${i}"/>
        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>
      </filter>
    `.trim()}jt.highlight=po;var St={};Object.defineProperty(St,"__esModule",{value:!0});St.blur=void 0;const mo=U;function bo(o={}){const r=(0,mo.getNumber)(o.x,2);return`
    <filter>
      <feGaussianBlur stdDeviation="${o.y!=null&&Number.isFinite(o.y)?[r,o.y]:r}"/>
    </filter>
  `.trim()}St.blur=bo;var At={};Object.defineProperty(At,"__esModule",{value:!0});At.dropShadow=void 0;const Ue=U;function yo(o={}){const r=(0,Ue.getNumber)(o.dx,0),i=(0,Ue.getNumber)(o.dy,0),l=(0,Ue.getString)(o.color,"black"),c=(0,Ue.getNumber)(o.blur,4),f=(0,Ue.getNumber)(o.opacity,1);return"SVGFEDropShadowElement"in window?`<filter>
         <feDropShadow stdDeviation="${c}" dx="${r}" dy="${i}" flood-color="${l}" flood-opacity="${f}" />
       </filter>`.trim():`<filter>
         <feGaussianBlur in="SourceAlpha" stdDeviation="${c}" />
         <feOffset dx="${r}" dy="${i}" result="offsetblur" />
         <feFlood flood-color="${l}" />
         <feComposite in2="offsetblur" operator="in" />
         <feComponentTransfer>
           <feFuncA type="linear" slope="${f}" />
         </feComponentTransfer>
         <feMerge>
           <feMergeNode/>
           <feMergeNode in="SourceGraphic"/>
         </feMerge>
       </filter>`.trim()}At.dropShadow=yo;var Dt={};Object.defineProperty(Dt,"__esModule",{value:!0});Dt.grayScale=void 0;const vo=U;function _o(o={}){const r=(0,vo.getNumber)(o.amount,1),i=.2126+.7874*(1-r),l=.7152-.7152*(1-r),c=.0722-.0722*(1-r),f=.2126-.2126*(1-r),h=.7152+.2848*(1-r),u=.0722-.0722*(1-r),g=.2126-.2126*(1-r),s=.0722+.9278*(1-r);return`
    <filter>
      <feColorMatrix type="matrix" values="${i} ${l} ${c} 0 0 ${f} ${h} ${u} 0 0 ${g} ${l} ${s} 0 0 0 0 0 1 0"/>
    </filter>
  `.trim()}Dt.grayScale=_o;var Tt={};Object.defineProperty(Tt,"__esModule",{value:!0});Tt.sepia=void 0;const wo=U;function Po(o={}){const r=(0,wo.getNumber)(o.amount,1),i=.393+.607*(1-r),l=.769-.769*(1-r),c=.189-.189*(1-r),f=.349-.349*(1-r),h=.686+.314*(1-r),u=.168-.168*(1-r),g=.272-.272*(1-r),s=.534-.534*(1-r),e=.131+.869*(1-r);return`
      <filter>
        <feColorMatrix type="matrix" values="${i} ${l} ${c} 0 0 ${f} ${h} ${u} 0 0 ${g} ${s} ${e} 0 0 0 0 0 1 0"/>
      </filter>
    `.trim()}Tt.sepia=Po;var Bt={};Object.defineProperty(Bt,"__esModule",{value:!0});Bt.saturate=void 0;const Oo=U;function xo(o={}){return`
      <filter>
        <feColorMatrix type="saturate" values="${1-(0,Oo.getNumber)(o.amount,1)}"/>
      </filter>
    `.trim()}Bt.saturate=xo;var Nt={};Object.defineProperty(Nt,"__esModule",{value:!0});Nt.hueRotate=void 0;const Co=U;function Mo(o={}){return`
      <filter>
        <feColorMatrix type="hueRotate" values="${(0,Co.getNumber)(o.angle,0)}"/>
      </filter>
    `.trim()}Nt.hueRotate=Mo;var Rt={};Object.defineProperty(Rt,"__esModule",{value:!0});Rt.invert=void 0;const Eo=U;function jo(o={}){const r=(0,Eo.getNumber)(o.amount,1),i=1-r;return`
      <filter>
        <feComponentTransfer>
          <feFuncR type="table" tableValues="${r} ${i}"/>
          <feFuncG type="table" tableValues="${r} ${i}"/>
          <feFuncB type="table" tableValues="${r} ${i}"/>
        </feComponentTransfer>
      </filter>
    `.trim()}Rt.invert=jo;var $t={};Object.defineProperty($t,"__esModule",{value:!0});$t.brightness=void 0;const So=U;function Ao(o={}){const r=(0,So.getNumber)(o.amount,1);return`
    <filter>
      <feComponentTransfer>
        <feFuncR type="linear" slope="${r}"/>
        <feFuncG type="linear" slope="${r}"/>
        <feFuncB type="linear" slope="${r}"/>
      </feComponentTransfer>
    </filter>
  `.trim()}$t.brightness=Ao;var Vt={};Object.defineProperty(Vt,"__esModule",{value:!0});Vt.contrast=void 0;const Do=U;function To(o={}){const r=(0,Do.getNumber)(o.amount,1),i=.5-r/2;return`
    <filter>
     <feComponentTransfer>
        <feFuncR type="linear" slope="${r}" intercept="${i}"/>
        <feFuncG type="linear" slope="${r}" intercept="${i}"/>
        <feFuncB type="linear" slope="${r}" intercept="${i}"/>
      </feComponentTransfer>
    </filter>
  `.trim()}Vt.contrast=To;(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(Et,o),i(jt,o),i(St,o),i(At,o),i(Dt,o),i(Tt,o),i(Bt,o),i(Nt,o),i(Rt,o),i($t,o),i(Vt,o)})(Li);(function(o){var r=w&&w.__createBinding||(Object.create?function(h,u,g,s){s===void 0&&(s=g);var e=Object.getOwnPropertyDescriptor(u,g);(!e||("get"in e?!u.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return u[g]}}),Object.defineProperty(h,s,e)}:function(h,u,g,s){s===void 0&&(s=g),h[s]=u[g]}),i=w&&w.__setModuleDefault||(Object.create?function(h,u){Object.defineProperty(h,"default",{enumerable:!0,value:u})}:function(h,u){h.default=u}),l=w&&w.__importStar||function(h){if(h&&h.__esModule)return h;var u={};if(h!=null)for(var g in h)g!=="default"&&Object.prototype.hasOwnProperty.call(h,g)&&r(u,h,g);return i(u,h),u};Object.defineProperty(o,"__esModule",{value:!0}),o.Filter=void 0;const c=z,f=l(Li);(function(h){h.presets=f,h.registry=c.Registry.create({type:"filter"}),h.registry.register(h.presets,!0)})(o.Filter||(o.Filter={}))})(Vi);var Er={},Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});Lt.raw=void 0;Lt.raw={xlinkHref:"xlink:href",xlinkShow:"xlink:show",xlinkRole:"xlink:role",xlinkType:"xlink:type",xlinkArcrole:"xlink:arcrole",xlinkTitle:"xlink:title",xlinkActuate:"xlink:actuate",xmlSpace:"xml:space",xmlBase:"xml:base",xmlLang:"xml:lang",preserveAspectRatio:"preserveAspectRatio",requiredExtension:"requiredExtension",requiredFeatures:"requiredFeatures",systemLanguage:"systemLanguage",externalResourcesRequired:"externalResourceRequired"};var Ii={},zi={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.refHeight2=o.refWidth2=o.refY2=o.refX2=o.refPoints=o.refD=o.refR=o.refPointsKeepOffset=o.refPointsResetOffset=o.refDKeepOffset=o.refDResetOffset=o.refCy=o.refCx=o.refRCircumscribed=o.refRInscribed=o.refRy=o.refRx=o.refHeight=o.refWidth=o.refDy=o.refDx=o.refY=o.refX=o.ref=void 0;const r=B,i=D;o.ref={},o.refX={position:l("x","width","origin")},o.refY={position:l("y","height","origin")},o.refDx={position:l("x","width","corner")},o.refDy={position:l("y","height","corner")},o.refWidth={set:c("width","width")},o.refHeight={set:c("height","height")},o.refRx={set:c("rx","width")},o.refRy={set:c("ry","height")},o.refRInscribed={set:(g=>{const s=c(g,"width"),e=c(g,"height");return function(t,n){const a=n.refBBox,d=a.height>a.width?s:e;return i.FunctionExt.call(d,this,t,n)}})("r")},o.refRCircumscribed={set(g,{refBBox:s}){let e=parseFloat(g);const t=i.NumberExt.isPercentage(g);t&&(e/=100);const n=Math.sqrt(s.height*s.height+s.width*s.width);let a;return Number.isFinite(e)&&(t||e>=0&&e<=1?a=e*n:a=Math.max(e+n,0)),{r:a}}},o.refCx={set:c("cx","width")},o.refCy={set:c("cy","height")},o.refDResetOffset={set:h({resetOffset:!0})},o.refDKeepOffset={set:h({resetOffset:!1})},o.refPointsResetOffset={set:u({resetOffset:!0})},o.refPointsKeepOffset={set:u({resetOffset:!1})},o.refR=o.refRInscribed,o.refD=o.refDResetOffset,o.refPoints=o.refPointsResetOffset,o.refX2=o.refX,o.refY2=o.refY,o.refWidth2=o.refWidth,o.refHeight2=o.refHeight;function l(g,s,e){return(t,{refBBox:n})=>{if(t==null)return null;let a=parseFloat(t);const d=i.NumberExt.isPercentage(t);d&&(a/=100);let m;if(Number.isFinite(a)){const b=n[e];d||a>0&&a<1?m=b[g]+n[s]*a:m=b[g]+a}const p=new r.Point;return p[g]=m||0,p}}function c(g,s){return function(e,{refBBox:t}){let n=parseFloat(e);const a=i.NumberExt.isPercentage(e);a&&(n/=100);const d={};if(Number.isFinite(n)){const m=a||n>=0&&n<=1?n*t[s]:Math.max(n+t[s],0);d[g]=m}return d}}function f(g,s){const e="x6-shape",t=s&&s.resetOffset;return function(n,{elem:a,refBBox:d}){let m=i.Dom.data(a,e);if(!m||m.value!==n){const M=g(n);m={value:n,shape:M,shapeBBox:M.bbox()},i.Dom.data(a,e,m)}const p=m.shape.clone(),b=m.shapeBBox.clone(),y=b.getOrigin(),_=d.getOrigin();b.x=_.x,b.y=_.y;const O=d.getMaxScaleToFit(b,_),x=b.width===0||d.width===0?1:O.sx,C=b.height===0||d.height===0?1:O.sy;return p.scale(x,C,y),t&&p.translate(-y.x,-y.y),p}}function h(g){function s(t){return r.Path.parse(t)}const e=f(s,g);return(t,n)=>({d:e(t,n).serialize()})}function u(g){const s=f(e=>new r.Polyline(e),g);return(e,t)=>({points:s(e,t).serialize()})}})(zi);var It={};Object.defineProperty(It,"__esModule",{value:!0});It.fill=void 0;const Bo=D;It.fill={qualify:Bo.ObjectExt.isPlainObject,set(o,{view:r}){return`url(#${r.graph.defineGradient(o)})`}};var zt={};Object.defineProperty(zt,"__esModule",{value:!0});zt.stroke=void 0;const No=D;zt.stroke={qualify:No.ObjectExt.isPlainObject,set(o,{view:r}){const i=r.cell,l=Object.assign({},o);if(i.isEdge()&&l.type==="linearGradient"){const c=r,f=c.sourcePoint,h=c.targetPoint;l.id=`gradient-${l.type}-${i.id}`,l.attrs=Object.assign(Object.assign({},l.attrs),{x1:f.x,y1:f.y,x2:h.x,y2:h.y,gradientUnits:"userSpaceOnUse"}),r.graph.defs.remove(l.id)}return`url(#${r.graph.defineGradient(l)})`}};var Fi={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.displayEmpty=o.eol=o.annotations=o.textPath=o.textVerticalAnchor=o.lineHeight=o.textWrap=o.text=void 0;const r=D;o.text={qualify(l,{attrs:c}){return c.textWrap==null||!r.ObjectExt.isPlainObject(c.textWrap)},set(l,{view:c,elem:f,attrs:h}){const u="x6-text",g=r.Dom.data(f,u),s=a=>{try{return JSON.parse(a)}catch{return a}},e={x:h.x,eol:h.eol,annotations:s(h.annotations),textPath:s(h["text-path"]||h.textPath),textVerticalAnchor:h["text-vertical-anchor"]||h.textVerticalAnchor,displayEmpty:(h["display-empty"]||h.displayEmpty)==="true",lineHeight:h["line-height"]||h.lineHeight},t=h["font-size"]||h.fontSize,n=JSON.stringify([l,e]);if(t&&f.setAttribute("font-size",t),g==null||g!==n){const a=e.textPath;if(a!=null&&typeof a=="object"){const d=a.selector;if(typeof d=="string"){const m=c.find(d)[0];m instanceof SVGPathElement&&(r.Dom.ensureId(m),e.textPath=Object.assign({"xlink:href":`#${m.id}`},a))}}r.Dom.text(f,`${l}`,e),r.Dom.data(f,u,n)}}},o.textWrap={qualify:r.ObjectExt.isPlainObject,set(l,{view:c,elem:f,attrs:h,refBBox:u}){const g=l,s=g.width||0;r.NumberExt.isPercentage(s)?u.width*=parseFloat(s)/100:s<=0?u.width+=s:u.width=s;const e=g.height||0;r.NumberExt.isPercentage(e)?u.height*=parseFloat(e)/100:e<=0?u.height+=e:u.height=e;let t,n=g.text;n==null&&(n=h.text||(f==null?void 0:f.textContent)),n!=null?t=r.Dom.breakText(`${n}`,u,{"font-weight":h["font-weight"]||h.fontWeight,"font-size":h["font-size"]||h.fontSize,"font-family":h["font-family"]||h.fontFamily,lineHeight:h.lineHeight},{ellipsis:g.ellipsis}):t="",r.FunctionExt.call(o.text.set,this,t,{view:c,elem:f,attrs:h,refBBox:u,cell:c.cell})}};const i=(l,{attrs:c})=>c.text!==void 0;o.lineHeight={qualify:i},o.textVerticalAnchor={qualify:i},o.textPath={qualify:i},o.annotations={qualify:i},o.eol={qualify:i},o.displayEmpty={qualify:i}})(Fi);var Ft={};Object.defineProperty(Ft,"__esModule",{value:!0});Ft.title=void 0;const Vr=D;Ft.title={qualify(o,{elem:r}){return r instanceof SVGElement},set(o,{elem:r}){const i="x6-title",l=`${o}`,c=Vr.Dom.data(r,i);if(c==null||c!==l){Vr.Dom.data(r,i,l);const f=r.firstChild;if(f&&f.tagName.toUpperCase()==="TITLE"){const h=f;h.textContent=l}else{const h=document.createElementNS(r.namespaceURI,"title");h.textContent=l,r.insertBefore(h,f)}}}};var xe={};Object.defineProperty(xe,"__esModule",{value:!0});xe.resetOffset=xe.yAlign=xe.xAlign=void 0;const Ro=D,$o=B;xe.xAlign={offset:Gi("x","width","right")};xe.yAlign={offset:Gi("y","height","bottom")};xe.resetOffset={offset(o,{refBBox:r}){return o?{x:-r.x,y:-r.y}:{x:0,y:0}}};function Gi(o,r,i){return(l,{refBBox:c})=>{const f=new $o.Point;let h;return l==="middle"?h=c[r]/2:l===i?h=c[r]:typeof l=="number"&&Number.isFinite(l)?h=l>-1&&l<1?-c[r]*l:-l:Ro.NumberExt.isPercentage(l)?h=c[r]*parseFloat(l)/100:h=0,f[o]=-(c[o]+h),f}}var Gt={};Object.defineProperty(Gt,"__esModule",{value:!0});Gt.style=void 0;const Lr=D;Gt.style={qualify:Lr.ObjectExt.isPlainObject,set(o,{elem:r}){Lr.Dom.css(r,o)}};var kt={};Object.defineProperty(kt,"__esModule",{value:!0});kt.html=void 0;kt.html={set(o,{elem:r}){r.innerHTML=`${o}`}};var Ht={};Object.defineProperty(Ht,"__esModule",{value:!0});Ht.filter=void 0;const Vo=D;Ht.filter={qualify:Vo.ObjectExt.isPlainObject,set(o,{view:r}){return`url(#${r.graph.defineFilter(o)})`}};var Ut={};Object.defineProperty(Ut,"__esModule",{value:!0});Ut.port=void 0;Ut.port={set(o){return o!=null&&typeof o=="object"&&o.id?o.id:o}};var Ce={},jr={},ki={},Le={},le={};Object.defineProperty(le,"__esModule",{value:!0});le.normalize=void 0;const Lo=B;function Io(o,r,i){let l,c;typeof r=="object"?(l=r.x,c=r.y):(l=r,c=i);const f=Lo.Path.parse(o),h=f.bbox();if(h){let u=-h.height/2-h.y,g=-h.width/2-h.x;typeof l=="number"&&(g-=l),typeof c=="number"&&(u-=c),f.translate(g,u)}return f.serialize()}le.normalize=Io;var Hi=w&&w.__rest||function(o,r){var i={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.indexOf(l)<0&&(i[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(o);c<l.length;c++)r.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(o,l[c])&&(i[l[c]]=o[l[c]]);return i};Object.defineProperty(Le,"__esModule",{value:!0});Le.classic=Le.block=void 0;const zo=B,Fo=D,Go=le,ko=o=>{var{size:r,width:i,height:l,offset:c,open:f}=o,h=Hi(o,["size","width","height","offset","open"]);return Ui({size:r,width:i,height:l,offset:c},f===!0,!0,void 0,h)};Le.block=ko;const Ho=o=>{var{size:r,width:i,height:l,offset:c,factor:f}=o,h=Hi(o,["size","width","height","offset","factor"]);return Ui({size:r,width:i,height:l,offset:c},!1,!1,f,h)};Le.classic=Ho;function Ui(o,r,i,l=3/4,c={}){const f=o.size||10,h=o.width||f,u=o.height||f,g=new zo.Path,s={};if(r)g.moveTo(h,0).lineTo(0,u/2).lineTo(h,u),s.fill="none";else{if(g.moveTo(0,u/2),g.lineTo(h,0),!i){const e=Fo.NumberExt.clamp(l,0,1);g.lineTo(h*e,u/2)}g.lineTo(h,u),g.close()}return Object.assign(Object.assign(Object.assign({},s),c),{tagName:"path",d:(0,Go.normalize)(g.serialize(),{x:o.offset!=null?o.offset:-h/2})})}var qt={},Uo=w&&w.__rest||function(o,r){var i={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.indexOf(l)<0&&(i[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(o);c<l.length;c++)r.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(o,l[c])&&(i[l[c]]=o[l[c]]);return i};Object.defineProperty(qt,"__esModule",{value:!0});qt.diamond=void 0;const qo=B,Wo=le,Xo=o=>{var{size:r,width:i,height:l,offset:c}=o,f=Uo(o,["size","width","height","offset"]);const h=r||10,u=i||h,g=l||h,s=new qo.Path;return s.moveTo(0,g/2).lineTo(u/2,0).lineTo(u,g/2).lineTo(u/2,g).close(),Object.assign(Object.assign({},f),{tagName:"path",d:(0,Wo.normalize)(s.serialize(),c==null?-u/2:c)})};qt.diamond=Xo;var Wt={},Jo=w&&w.__rest||function(o,r){var i={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.indexOf(l)<0&&(i[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(o);c<l.length;c++)r.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(o,l[c])&&(i[l[c]]=o[l[c]]);return i};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.path=void 0;const Yo=le,Ko=o=>{var{d:r,offsetX:i,offsetY:l}=o,c=Jo(o,["d","offsetX","offsetY"]);return Object.assign(Object.assign({},c),{tagName:"path",d:(0,Yo.normalize)(r,i,l)})};Wt.path=Ko;var Xt={},Zo=w&&w.__rest||function(o,r){var i={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.indexOf(l)<0&&(i[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(o);c<l.length;c++)r.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(o,l[c])&&(i[l[c]]=o[l[c]]);return i};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.cross=void 0;const Qo=B,ea=le,ta=o=>{var{size:r,width:i,height:l,offset:c}=o,f=Zo(o,["size","width","height","offset"]);const h=r||10,u=i||h,g=l||h,s=new Qo.Path;return s.moveTo(0,0).lineTo(u,g).moveTo(0,g).lineTo(u,0),Object.assign(Object.assign({},f),{tagName:"path",fill:"none",d:(0,ea.normalize)(s.serialize(),c||-u/2)})};Xt.cross=ta;var Jt={},na=w&&w.__rest||function(o,r){var i={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.indexOf(l)<0&&(i[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(o);c<l.length;c++)r.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(o,l[c])&&(i[l[c]]=o[l[c]]);return i};Object.defineProperty(Jt,"__esModule",{value:!0});Jt.async=void 0;const ra=B,ia=le,sa=o=>{var{width:r,height:i,offset:l,open:c,flip:f}=o,h=na(o,["width","height","offset","open","flip"]);let u=i||6;const g=r||10,s=c===!0,e=f===!0,t=Object.assign(Object.assign({},h),{tagName:"path"});e&&(u=-u);const n=new ra.Path;return n.moveTo(0,u).lineTo(g,0),s?t.fill="none":(n.lineTo(g,u),n.close()),t.d=(0,ia.normalize)(n.serialize(),{x:l||-g/2,y:u/2}),t};Jt.async=sa;var qi={};(function(o){var r=w&&w.__rest||function(h,u){var g={};for(var s in h)Object.prototype.hasOwnProperty.call(h,s)&&u.indexOf(s)<0&&(g[s]=h[s]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var e=0,s=Object.getOwnPropertySymbols(h);e<s.length;e++)u.indexOf(s[e])<0&&Object.prototype.propertyIsEnumerable.call(h,s[e])&&(g[s[e]]=h[s[e]]);return g};Object.defineProperty(o,"__esModule",{value:!0}),o.circlePlus=o.circle=void 0;const i=B,l=le,c=h=>{var{r:u}=h,g=r(h,["r"]);const s=u||5;return Object.assign(Object.assign({cx:s},g),{tagName:"circle",r:s})};o.circle=c;const f=h=>{var{r:u}=h,g=r(h,["r"]);const s=u||5,e=new i.Path;return e.moveTo(s,0).lineTo(s,s*2),e.moveTo(0,s).lineTo(s*2,s),{children:[Object.assign(Object.assign({},(0,o.circle)({r:s})),{fill:"none"}),Object.assign(Object.assign({},g),{tagName:"path",d:(0,l.normalize)(e.serialize(),-s)})]}};o.circlePlus=f})(qi);var Yt={},oa=w&&w.__rest||function(o,r){var i={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.indexOf(l)<0&&(i[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(o);c<l.length;c++)r.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(o,l[c])&&(i[l[c]]=o[l[c]]);return i};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.ellipse=void 0;const aa=o=>{var{rx:r,ry:i}=o,l=oa(o,["rx","ry"]);const c=r||5,f=i||5;return Object.assign(Object.assign({cx:c},l),{tagName:"ellipse",rx:c,ry:f})};Yt.ellipse=aa;(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(Le,o),i(qt,o),i(Wt,o),i(Xt,o),i(Jt,o),i(qi,o),i(Yt,o)})(ki);(function(o){var r=w&&w.__createBinding||(Object.create?function(u,g,s,e){e===void 0&&(e=s);var t=Object.getOwnPropertyDescriptor(g,s);(!t||("get"in t?!g.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return g[s]}}),Object.defineProperty(u,e,t)}:function(u,g,s,e){e===void 0&&(e=s),u[e]=g[s]}),i=w&&w.__setModuleDefault||(Object.create?function(u,g){Object.defineProperty(u,"default",{enumerable:!0,value:g})}:function(u,g){u.default=g}),l=w&&w.__importStar||function(u){if(u&&u.__esModule)return u;var g={};if(u!=null)for(var s in u)s!=="default"&&Object.prototype.hasOwnProperty.call(u,s)&&r(g,u,s);return i(g,u),g};Object.defineProperty(o,"__esModule",{value:!0}),o.Marker=void 0;const c=z,f=l(ki),h=le;(function(u){u.presets=f,u.registry=c.Registry.create({type:"marker"}),u.registry.register(u.presets,!0)})(o.Marker||(o.Marker={})),function(u){u.normalize=h.normalize}(o.Marker||(o.Marker={}))})(jr);var la=w&&w.__rest||function(o,r){var i={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.indexOf(l)<0&&(i[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(o);c<l.length;c++)r.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(o,l[c])&&(i[l[c]]=o[l[c]]);return i};Object.defineProperty(Ce,"__esModule",{value:!0});Ce.vertexMarker=Ce.targetMarker=Ce.sourceMarker=void 0;const ca=D,Ir=jr;function Sr(o){return typeof o=="string"||ca.ObjectExt.isPlainObject(o)}Ce.sourceMarker={qualify:Sr,set(o,{view:r,attrs:i}){return Ar("marker-start",o,r,i)}};Ce.targetMarker={qualify:Sr,set(o,{view:r,attrs:i}){return Ar("marker-end",o,r,i,{transform:"rotate(180)"})}};Ce.vertexMarker={qualify:Sr,set(o,{view:r,attrs:i}){return Ar("marker-mid",o,r,i)}};function Ar(o,r,i,l,c={}){const f=typeof r=="string"?{name:r}:r,{name:h,args:u}=f,g=la(f,["name","args"]);let s=g;if(h&&typeof h=="string"){const t=Ir.Marker.registry.get(h);if(t)s=t(Object.assign(Object.assign({},g),u));else return Ir.Marker.registry.onNotFound(h)}const e=Object.assign(Object.assign(Object.assign({},ua(l,o)),c),s);return{[o]:`url(#${i.graph.defineMarker(e)})`}}function ua(o,r){const i={},l=o.stroke;typeof l=="string"&&(i.stroke=l,i.fill=l);let c=o.strokeOpacity;if(c==null&&(c=o["stroke-opacity"]),c==null&&(c=o.opacity),c!=null&&(i["stroke-opacity"]=c,i["fill-opacity"]=c),r!=="marker-mid"){const f=parseFloat(o.strokeWidth||o["stroke-width"]);if(Number.isFinite(f)&&f>1){const h=Math.ceil(f/2);i.refX=r==="marker-start"?h:-h}}return i}var Wi={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.atConnectionRatio=o.atConnectionLength=o.atConnectionRatioIgnoreGradient=o.atConnectionRatioKeepGradient=o.atConnectionLengthIgnoreGradient=o.atConnectionLengthKeepGradient=o.connection=void 0;const r=(l,{view:c})=>c.cell.isEdge();o.connection={qualify:r,set(l,c){var f,h,u,g;const s=c.view,e=l.reverse||!1,t=l.stubs||0;let n;if(Number.isFinite(t)&&t!==0)if(e){let a,d;const m=s.getConnectionLength()||0;t<0?(a=(m+t)/2,d=-t):(a=t,d=m-t*2);const p=s.getConnection();n=(g=(u=(h=(f=p==null?void 0:p.divideAtLength(a))===null||f===void 0?void 0:f[1])===null||h===void 0?void 0:h.divideAtLength(d))===null||u===void 0?void 0:u[0])===null||g===void 0?void 0:g.serialize()}else{let a;t<0?a=((s.getConnectionLength()||0)+t)/2:a=t;const d=s.getConnection();if(d){const m=d.divideAtLength(a),p=d.divideAtLength(-a);m&&p&&(n=`${m[0].serialize()} ${p[1].serialize()}`)}}return{d:n||s.getConnectionPathData()}}},o.atConnectionLengthKeepGradient={qualify:r,set:i("getTangentAtLength",{rotate:!0})},o.atConnectionLengthIgnoreGradient={qualify:r,set:i("getTangentAtLength",{rotate:!1})},o.atConnectionRatioKeepGradient={qualify:r,set:i("getTangentAtRatio",{rotate:!0})},o.atConnectionRatioIgnoreGradient={qualify:r,set:i("getTangentAtRatio",{rotate:!1})},o.atConnectionLength=o.atConnectionLengthKeepGradient,o.atConnectionRatio=o.atConnectionRatioKeepGradient;function i(l,c){const f={x:1,y:0};return(h,u)=>{let g,s;const e=u.view,t=e[l](Number(h));return t?(s=c.rotate?t.vector().vectorAngle(f):0,g=t.start):(g=e.path.start,s=0),s===0?{transform:`translate(${g.x},${g.y}')`}:{transform:`translate(${g.x},${g.y}') rotate(${s})`}}}})(Wi);(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(zi,o),i(It,o),i(zt,o),i(Fi,o),i(Ft,o),i(xe,o),i(Gt,o),i(kt,o),i(Ht,o),i(Ut,o),i(Ce,o),i(Wi,o)})(Ii);(function(o){var r=w&&w.__createBinding||(Object.create?function(g,s,e,t){t===void 0&&(t=e);var n=Object.getOwnPropertyDescriptor(s,e);(!n||("get"in n?!s.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return s[e]}}),Object.defineProperty(g,t,n)}:function(g,s,e,t){t===void 0&&(t=e),g[t]=s[e]}),i=w&&w.__setModuleDefault||(Object.create?function(g,s){Object.defineProperty(g,"default",{enumerable:!0,value:s})}:function(g,s){g.default=s}),l=w&&w.__importStar||function(g){if(g&&g.__esModule)return g;var s={};if(g!=null)for(var e in g)e!=="default"&&Object.prototype.hasOwnProperty.call(g,e)&&r(s,g,e);return i(s,g),s};Object.defineProperty(o,"__esModule",{value:!0}),o.Attr=void 0;const c=D,f=z,h=Lt,u=l(Ii);(function(g){function s(e,t,n){return!!(e!=null&&(typeof e=="string"||typeof e.qualify!="function"||c.FunctionExt.call(e.qualify,this,t,n)))}g.isValidDefinition=s})(o.Attr||(o.Attr={})),function(g){g.presets=Object.assign(Object.assign({},h.raw),u),g.registry=f.Registry.create({type:"attribute definition"}),g.registry.register(g.presets,!0)}(o.Attr||(o.Attr={}))})(Er);var Xi={},Ji={},Kt={},ce={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.Config=void 0,o.Config={prefixCls:"x6",autoInsertCSS:!0,useCSSSelector:!0,prefix(r){return`${o.Config.prefixCls}-${r}`}}})(ce);Object.defineProperty(Kt,"__esModule",{value:!0});Kt.className=void 0;const zr=D,ha=ce,Fr=ha.Config.prefix("highlighted");Kt.className={highlight(o,r,i){const l=i&&i.className||Fr;zr.Dom.addClass(r,l)},unhighlight(o,r,i){const l=i&&i.className||Fr;zr.Dom.removeClass(r,l)}};var Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.opacity=void 0;const Gr=D,ga=ce,kr=ga.Config.prefix("highlight-opacity");Zt.opacity={highlight(o,r){Gr.Dom.addClass(r,kr)},unhighlight(o,r){Gr.Dom.removeClass(r,kr)}};var Qt={},ue={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.Util=void 0;const r=B,i=D,l=le;(function(c){c.normalizeMarker=l.normalize;function f(p,b){const y=i.Dom.createSVGPoint(p.x,p.y).matrixTransform(b);return new r.Point(y.x,y.y)}c.transformPoint=f;function h(p,b){return new r.Line(f(p.start,b),f(p.end,b))}c.transformLine=h;function u(p,b){let y=p instanceof r.Polyline?p.points:p;return Array.isArray(y)||(y=[]),new r.Polyline(y.map(_=>f(_,b)))}c.transformPolyline=u;function g(p,b){const _=i.Dom.createSvgElement("svg").createSVGPoint();_.x=p.x,_.y=p.y;const O=_.matrixTransform(b);_.x=p.x+p.width,_.y=p.y;const x=_.matrixTransform(b);_.x=p.x+p.width,_.y=p.y+p.height;const C=_.matrixTransform(b);_.x=p.x,_.y=p.y+p.height;const M=_.matrixTransform(b),A=Math.min(O.x,x.x,C.x,M.x),j=Math.max(O.x,x.x,C.x,M.x),v=Math.min(O.y,x.y,C.y,M.y),P=Math.max(O.y,x.y,C.y,M.y);return new r.Rectangle(A,v,j-A,P-v)}c.transformRectangle=g;function s(p,b,y){let _;const O=p.ownerSVGElement;if(!O)return new r.Rectangle(0,0,0,0);try{_=p.getBBox()}catch{_={x:p.clientLeft,y:p.clientTop,width:p.clientWidth,height:p.clientHeight}}if(b)return r.Rectangle.create(_);const x=i.Dom.getTransformToElement(p,y||O);return g(_,x)}c.bbox=s;function e(p,b={}){let y;if(!p.ownerSVGElement||!i.Dom.isSVGGraphicsElement(p)){if(i.Dom.isHTMLElement(p)){const{left:C,top:M,width:A,height:j}=t(p);return new r.Rectangle(C,M,A,j)}return new r.Rectangle(0,0,0,0)}let O=b.target;if(!b.recursive){try{y=p.getBBox()}catch{y={x:p.clientLeft,y:p.clientTop,width:p.clientWidth,height:p.clientHeight}}if(!O)return r.Rectangle.create(y);const C=i.Dom.getTransformToElement(p,O);return g(y,C)}{const C=p.childNodes,M=C.length;if(M===0)return e(p,{target:O});O||(O=p);for(let A=0;A<M;A+=1){const j=C[A];let v;j.childNodes.length===0?v=e(j,{target:O}):v=e(j,{target:O,recursive:!0}),y?y=y.union(v):y=v}return y}}c.getBBox=e;function t(p){let b=0,y=0,_=0,O=0;if(p){let x=p;for(;x;)b+=x.offsetLeft,y+=x.offsetTop,x=x.offsetParent,x&&(b+=parseInt(i.Dom.getComputedStyle(x,"borderLeft"),10),y+=parseInt(i.Dom.getComputedStyle(x,"borderTop"),10));_=p.offsetWidth,O=p.offsetHeight}return{left:b,top:y,width:_,height:O}}c.getBoundingOffsetRect=t;function n(p){const b=y=>{const _=p.getAttribute(y),O=_?parseFloat(_):0;return Number.isNaN(O)?0:O};switch(p instanceof SVGElement&&p.nodeName.toLowerCase()){case"rect":return new r.Rectangle(b("x"),b("y"),b("width"),b("height"));case"circle":return new r.Ellipse(b("cx"),b("cy"),b("r"),b("r"));case"ellipse":return new r.Ellipse(b("cx"),b("cy"),b("rx"),b("ry"));case"polyline":{const y=i.Dom.getPointsFromSvgElement(p);return new r.Polyline(y)}case"polygon":{const y=i.Dom.getPointsFromSvgElement(p);return y.length>1&&y.push(y[0]),new r.Polyline(y)}case"path":{let y=p.getAttribute("d");return r.Path.isValid(y)||(y=r.Path.normalize(y)),r.Path.parse(y)}case"line":return new r.Line(b("x1"),b("y1"),b("x2"),b("y2"))}return e(p)}c.toGeometryShape=n;function a(p,b,y,_){const O=r.Point.create(b),x=r.Point.create(y);_||(_=p instanceof SVGSVGElement?p:p.ownerSVGElement);const C=i.Dom.scale(p);p.setAttribute("transform","");const M=e(p,{target:_}).scale(C.sx,C.sy),A=i.Dom.createSVGTransform();A.setTranslate(-M.x-M.width/2,-M.y-M.height/2);const j=i.Dom.createSVGTransform(),v=O.angleBetween(x,O.clone().translate(1,0));v&&j.setRotate(v,0,0);const P=i.Dom.createSVGTransform(),E=O.clone().move(x,M.width/2);P.setTranslate(2*O.x-E.x,2*O.y-E.y);const S=i.Dom.getTransformToElement(p,_),T=i.Dom.createSVGTransform();T.setMatrix(P.matrix.multiply(j.matrix.multiply(A.matrix.multiply(S.scale(C.sx,C.sy))))),p.setAttribute("transform",i.Dom.matrixToTransformString(T.matrix))}c.translateAndAutoOrient=a;function d(p){if(p==null)return null;let b=p;do{let y=b.tagName;if(typeof y!="string")return null;if(y=y.toUpperCase(),i.Dom.hasClass(b,"x6-port"))b=b.nextElementSibling;else if(y==="G")b=b.firstElementChild;else if(y==="TITLE")b=b.nextElementSibling;else break}while(b);return b}c.findShapeNode=d;function m(p){const b=d(p);if(!i.Dom.isSVGGraphicsElement(b)){if(i.Dom.isHTMLElement(p)){const{left:O,top:x,width:C,height:M}=t(p);return new r.Rectangle(O,x,C,M)}return new r.Rectangle(0,0,0,0)}return n(b).bbox()||r.Rectangle.create()}c.getBBoxV2=m})(o.Util||(o.Util={}))})(ue);Object.defineProperty(Qt,"__esModule",{value:!0});Qt.stroke=void 0;const ee=D,fa=ce,Qn=ue,da={padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}};Qt.stroke={highlight(o,r,i){const l=Oe.getHighlighterId(r,i);if(Oe.hasCache(l))return;i=ee.ObjectExt.defaultsDeep({},i,da);const c=ee.Vector.create(r);let f,h;try{f=c.toPathData()}catch{h=Qn.Util.bbox(c.node,!0),f=ee.Dom.rectToPathData(Object.assign(Object.assign({},i),h))}const u=ee.Dom.createSvgElement("path");if(ee.Dom.attr(u,Object.assign({d:f,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},i.attrs?ee.Dom.kebablizeAttrs(i.attrs):null)),o.isEdgeElement(r))ee.Dom.attr(u,"d",o.getConnectionPathData());else{let e=c.getTransformToElement(o.container);const t=i.padding;if(t){h==null&&(h=Qn.Util.bbox(c.node,!0));const n=h.x+h.width/2,a=h.y+h.height/2;h=Qn.Util.transformRectangle(h,e);const d=Math.max(h.width,1),m=Math.max(h.height,1),p=(d+t)/d,b=(m+t)/m,y=ee.Dom.createSVGMatrix({a:p,b:0,c:0,d:b,e:n-p*n,f:a-b*a});e=e.multiply(y)}ee.Dom.transform(u,e)}ee.Dom.addClass(u,fa.Config.prefix("highlight-stroke"));const g=o.cell,s=()=>Oe.removeHighlighter(l);g.on("removed",s),g.model&&g.model.on("reseted",s),o.container.appendChild(u),Oe.setCache(l,u)},unhighlight(o,r,i){Oe.removeHighlighter(Oe.getHighlighterId(r,i))}};var Oe;(function(o){function r(h,u){return ee.Dom.ensureId(h),h.id+JSON.stringify(u)}o.getHighlighterId=r;const i={};function l(h,u){i[h]=u}o.setCache=l;function c(h){return i[h]!=null}o.hasCache=c;function f(h){const u=i[h];u&&(ee.Dom.remove(u),delete i[h])}o.removeHighlighter=f})(Oe||(Oe={}));(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(Kt,o),i(Zt,o),i(Qt,o)})(Ji);(function(o){var r=w&&w.__createBinding||(Object.create?function(h,u,g,s){s===void 0&&(s=g);var e=Object.getOwnPropertyDescriptor(u,g);(!e||("get"in e?!u.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return u[g]}}),Object.defineProperty(h,s,e)}:function(h,u,g,s){s===void 0&&(s=g),h[s]=u[g]}),i=w&&w.__setModuleDefault||(Object.create?function(h,u){Object.defineProperty(h,"default",{enumerable:!0,value:u})}:function(h,u){h.default=u}),l=w&&w.__importStar||function(h){if(h&&h.__esModule)return h;var u={};if(h!=null)for(var g in h)g!=="default"&&Object.prototype.hasOwnProperty.call(h,g)&&r(u,h,g);return i(u,h),u};Object.defineProperty(o,"__esModule",{value:!0}),o.Highlighter=void 0;const c=z,f=l(Ji);(function(h){function u(g,s){if(typeof s.highlight!="function")throw new Error(`Highlighter '${g}' is missing required \`highlight()\` method`);if(typeof s.unhighlight!="function")throw new Error(`Highlighter '${g}' is missing required \`unhighlight()\` method`)}h.check=u})(o.Highlighter||(o.Highlighter={})),function(h){h.presets=f,h.registry=c.Registry.create({type:"highlighter"}),h.registry.register(h.presets,!0)}(o.Highlighter||(o.Highlighter={}))})(Xi);var Yi={},Ki={},en={},Ee={};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.toResult=Ee.normalizePoint=void 0;const Hr=D,pa=B;function ma(o,r={}){return new pa.Point(Hr.NumberExt.normalizePercentage(r.x,o.width),Hr.NumberExt.normalizePercentage(r.y,o.height))}Ee.normalizePoint=ma;function ba(o,r,i){return Object.assign({angle:r,position:o.toJSON()},i)}Ee.toResult=ba;Object.defineProperty(en,"__esModule",{value:!0});en.absolute=void 0;const Ur=Ee,ya=(o,r)=>o.map(({x:i,y:l,angle:c})=>(0,Ur.toResult)((0,Ur.normalizePoint)(r,{x:i,y:l}),c||0));en.absolute=ya;var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0});Ie.ellipseSpread=Ie.ellipse=void 0;const va=B,_a=Ee,wa=(o,r,i)=>{const l=i.start||0,c=i.step||20;return Zi(o,r,l,(f,h)=>(f+.5-h/2)*c)};Ie.ellipse=wa;const Pa=(o,r,i)=>{const l=i.start||0,c=i.step||360/o.length;return Zi(o,r,l,f=>f*c)};Ie.ellipseSpread=Pa;function Zi(o,r,i,l){const c=r.getCenter(),f=r.getTopCenter(),h=r.width/r.height,u=va.Ellipse.fromRect(r),g=o.length;return o.map((s,e)=>{const t=i+l(e,g),n=f.clone().rotate(-t,c).scale(h,1,c),a=s.compensateRotate?-u.tangentTheta(n):0;return(s.dx||s.dy)&&n.translate(s.dx||0,s.dy||0),s.dr&&n.move(c,s.dr),(0,_a.toResult)(n.round(),a,s)})}var ne={},Oa=w&&w.__rest||function(o,r){var i={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.indexOf(l)<0&&(i[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(o);c<l.length;c++)r.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(o,l[c])&&(i[l[c]]=o[l[c]]);return i};Object.defineProperty(ne,"__esModule",{value:!0});ne.bottom=ne.top=ne.right=ne.left=ne.line=void 0;const xa=B,wr=Ee,Ca=(o,r,i)=>{const l=(0,wr.normalizePoint)(r,i.start||r.getOrigin()),c=(0,wr.normalizePoint)(r,i.end||r.getCorner());return Qe(o,l,c,i)};ne.line=Ca;const Ma=(o,r,i)=>Qe(o,r.getTopLeft(),r.getBottomLeft(),i);ne.left=Ma;const Ea=(o,r,i)=>Qe(o,r.getTopRight(),r.getBottomRight(),i);ne.right=Ea;const ja=(o,r,i)=>Qe(o,r.getTopLeft(),r.getTopRight(),i);ne.top=ja;const Sa=(o,r,i)=>Qe(o,r.getBottomLeft(),r.getBottomRight(),i);ne.bottom=Sa;function Qe(o,r,i,l){const c=new xa.Line(r,i),f=o.length;return o.map((h,u)=>{var{strict:g}=h,s=Oa(h,["strict"]);const e=g||l.strict?(u+1)/(f+1):(u+.5)/f,t=c.pointAt(e);return(s.dx||s.dy)&&t.translate(s.dx||0,s.dy||0),(0,wr.toResult)(t.round(),0,s)})}(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(en,o),i(Ie,o),i(ne,o)})(Ki);(function(o){var r=w&&w.__createBinding||(Object.create?function(h,u,g,s){s===void 0&&(s=g);var e=Object.getOwnPropertyDescriptor(u,g);(!e||("get"in e?!u.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return u[g]}}),Object.defineProperty(h,s,e)}:function(h,u,g,s){s===void 0&&(s=g),h[s]=u[g]}),i=w&&w.__setModuleDefault||(Object.create?function(h,u){Object.defineProperty(h,"default",{enumerable:!0,value:u})}:function(h,u){h.default=u}),l=w&&w.__importStar||function(h){if(h&&h.__esModule)return h;var u={};if(h!=null)for(var g in h)g!=="default"&&Object.prototype.hasOwnProperty.call(h,g)&&r(u,h,g);return i(u,h),u};Object.defineProperty(o,"__esModule",{value:!0}),o.PortLayout=void 0;const c=z,f=l(Ki);(function(h){h.presets=f,h.registry=c.Registry.create({type:"port layout"}),h.registry.register(h.presets,!0)})(o.PortLayout||(o.PortLayout={}))})(Yi);var Qi={},es={},re={},He={};Object.defineProperty(He,"__esModule",{value:!0});He.toResult=void 0;const Aa=D,Da={position:{x:0,y:0},angle:0,attrs:{".":{y:"0","text-anchor":"start"}}};function Ta(o,r){const{x:i,y:l,angle:c,attrs:f}=r||{};return Aa.ObjectExt.defaultsDeep({},{angle:c,attrs:f,position:{x:i,y:l}},o,Da)}He.toResult=Ta;Object.defineProperty(re,"__esModule",{value:!0});re.bottom=re.top=re.right=re.left=re.manual=void 0;const et=He,Ba=(o,r,i)=>(0,et.toResult)({position:r.getTopLeft()},i);re.manual=Ba;const Na=(o,r,i)=>(0,et.toResult)({position:{x:-15,y:0},attrs:{".":{y:".3em","text-anchor":"end"}}},i);re.left=Na;const Ra=(o,r,i)=>(0,et.toResult)({position:{x:15,y:0},attrs:{".":{y:".3em","text-anchor":"start"}}},i);re.right=Ra;const $a=(o,r,i)=>(0,et.toResult)({position:{x:0,y:-15},attrs:{".":{"text-anchor":"middle"}}},i);re.top=$a;const Va=(o,r,i)=>(0,et.toResult)({position:{x:0,y:15},attrs:{".":{y:".6em","text-anchor":"middle"}}},i);re.bottom=Va;var de={};Object.defineProperty(de,"__esModule",{value:!0});de.insideOriented=de.inside=de.outsideOriented=de.outside=void 0;const ts=He,La=(o,r,i)=>ns(o,r,!1,i);de.outside=La;const Ia=(o,r,i)=>ns(o,r,!0,i);de.outsideOriented=Ia;const za=(o,r,i)=>rs(o,r,!1,i);de.inside=za;const Fa=(o,r,i)=>rs(o,r,!0,i);de.insideOriented=Fa;function ns(o,r,i,l){const c=l.offset!=null?l.offset:15,f=r.getCenter().theta(o),h=is(r);let u,g,s,e,t=0;return f<h[1]||f>h[2]?(u=".3em",g=c,s=0,e="start"):f<h[0]?(u="0",g=0,s=-c,i?(t=-90,e="start"):e="middle"):f<h[3]?(u=".3em",g=-c,s=0,e="end"):(u=".6em",g=0,s=c,i?(t=90,e="start"):e="middle"),(0,ts.toResult)({position:{x:Math.round(g),y:Math.round(s)},angle:t,attrs:{".":{y:u,"text-anchor":e}}},l)}function rs(o,r,i,l){const c=l.offset!=null?l.offset:15,f=r.getCenter().theta(o),h=is(r);let u,g,s,e,t=0;return f<h[1]||f>h[2]?(u=".3em",g=-c,s=0,e="end"):f<h[0]?(u=".6em",g=0,s=c,i?(t=90,e="start"):e="middle"):f<h[3]?(u=".3em",g=c,s=0,e="start"):(u="0em",g=0,s=-c,i?(t=-90,e="start"):e="middle"),(0,ts.toResult)({position:{x:Math.round(g),y:Math.round(s)},angle:t,attrs:{".":{y:u,"text-anchor":e}}},l)}function is(o){const r=o.getCenter(),i=r.theta(o.getTopLeft()),l=r.theta(o.getBottomLeft()),c=r.theta(o.getBottomRight()),f=r.theta(o.getTopRight());return[i,f,c,l]}var ze={};Object.defineProperty(ze,"__esModule",{value:!0});ze.radialOriented=ze.radial=void 0;const Ga=B,ka=He,Ha=(o,r,i)=>ss(o.diff(r.getCenter()),!1,i);ze.radial=Ha;const Ua=(o,r,i)=>ss(o.diff(r.getCenter()),!0,i);ze.radialOriented=Ua;function ss(o,r,i){const l=i.offset!=null?i.offset:20,c=new Ga.Point(0,0),f=-o.theta(c),h=o.clone().move(c,l).diff(o).round();let u=".3em",g,s=f;return(f+90)%180===0?(g=r?"end":"middle",!r&&f===-270&&(u="0em")):f>-270&&f<-90?(g="start",s=f-180):g="end",(0,ka.toResult)({position:h.round().toJSON(),angle:r?s:0,attrs:{".":{y:u,"text-anchor":g}}},i)}(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(re,o),i(de,o),i(ze,o)})(es);(function(o){var r=w&&w.__createBinding||(Object.create?function(h,u,g,s){s===void 0&&(s=g);var e=Object.getOwnPropertyDescriptor(u,g);(!e||("get"in e?!u.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return u[g]}}),Object.defineProperty(h,s,e)}:function(h,u,g,s){s===void 0&&(s=g),h[s]=u[g]}),i=w&&w.__setModuleDefault||(Object.create?function(h,u){Object.defineProperty(h,"default",{enumerable:!0,value:u})}:function(h,u){h.default=u}),l=w&&w.__importStar||function(h){if(h&&h.__esModule)return h;var u={};if(h!=null)for(var g in h)g!=="default"&&Object.prototype.hasOwnProperty.call(h,g)&&r(u,h,g);return i(u,h),u};Object.defineProperty(o,"__esModule",{value:!0}),o.PortLabelLayout=void 0;const c=z,f=l(es);(function(h){h.presets=f,h.registry=c.Registry.create({type:"port label layout"}),h.registry.register(h.presets,!0)})(o.PortLabelLayout||(o.PortLabelLayout={}))})(Qi);var er={},tr={},Te={};(function(o){var r=w&&w.__decorate||function(h,u,g,s){var e=arguments.length,t=e<3?u:s===null?s=Object.getOwnPropertyDescriptor(u,g):s,n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")t=Reflect.decorate(h,u,g,s);else for(var a=h.length-1;a>=0;a--)(n=h[a])&&(t=(e<3?n(t):e>3?n(u,g,t):n(u,g))||t);return e>3&&t&&Object.defineProperty(u,g,t),t};Object.defineProperty(o,"__esModule",{value:!0}),o.View=void 0;const i=D,l=ce;class c extends i.Basecoat{get priority(){return 2}get disposeContainer(){return!0}constructor(){super(),this.cid=f.uniqueId(),c.views[this.cid]=this}confirmUpdate(u,g){return 0}empty(u=this.container){return i.Dom.empty(u),this}unmount(u=this.container){return i.Dom.remove(u),this}remove(u=this.container){return u===this.container?(this.removeEventListeners(document),this.onRemove(),delete c.views[this.cid],this.disposeContainer&&this.unmount(u)):this.unmount(u),this}onRemove(){}setClass(u,g=this.container){g.classList.value=Array.isArray(u)?u.join(" "):u}addClass(u,g=this.container){return i.Dom.addClass(g,Array.isArray(u)?u.join(" "):u),this}removeClass(u,g=this.container){return i.Dom.removeClass(g,Array.isArray(u)?u.join(" "):u),this}setStyle(u,g=this.container){return i.Dom.css(g,u),this}setAttrs(u,g=this.container){return u!=null&&g!=null&&i.Dom.attr(g,u),this}findAttr(u,g=this.container){let s=g;for(;s&&s.nodeType===1;){const e=s.getAttribute(u);if(e!=null)return e;if(s===this.container)return null;s=s.parentNode}return null}find(u,g=this.container,s=this.selectors){return c.find(u,g,s).elems}findOne(u,g=this.container,s=this.selectors){const e=this.find(u,g,s);return e.length>0?e[0]:null}findByAttr(u,g=this.container){let s=g;for(;s&&s.getAttribute;){const e=s.getAttribute(u);if((e!=null||s===this.container)&&e!=="false")return s;s=s.parentNode}return null}getSelector(u,g){let s;if(u===this.container)return typeof g=="string"&&(s=`> ${g}`),s;if(u){const e=i.Dom.index(u)+1;s=`${u.tagName.toLowerCase()}:nth-child(${e})`,g&&(s+=` > ${g}`),s=this.getSelector(u.parentNode,s)}return s}prefixClassName(u){return l.Config.prefix(u)}delegateEvents(u,g){if(u==null)return this;g||this.undelegateEvents();const s=/^(\S+)\s*(.*)$/;return Object.keys(u).forEach(e=>{const t=e.match(s);if(t==null)return;const n=this.getEventHandler(u[e]);typeof n=="function"&&this.delegateEvent(t[1],t[2],n)}),this}undelegateEvents(){return i.Dom.Event.off(this.container,this.getEventNamespace()),this}delegateDocumentEvents(u,g){return this.addEventListeners(document,u,g),this}undelegateDocumentEvents(){return this.removeEventListeners(document),this}delegateEvent(u,g,s){return i.Dom.Event.on(this.container,u+this.getEventNamespace(),g,s),this}undelegateEvent(u,g,s){const e=u+this.getEventNamespace();return g==null?i.Dom.Event.off(this.container,e):typeof g=="string"?i.Dom.Event.off(this.container,e,g,s):i.Dom.Event.off(this.container,e,g),this}addEventListeners(u,g,s){if(g==null)return this;const e=this.getEventNamespace();return Object.keys(g).forEach(t=>{const n=this.getEventHandler(g[t]);typeof n=="function"&&i.Dom.Event.on(u,t+e,s,n)}),this}removeEventListeners(u){return u!=null&&i.Dom.Event.off(u,this.getEventNamespace()),this}getEventNamespace(){return`.${l.Config.prefixCls}-event-${this.cid}`}getEventHandler(u){let g;if(typeof u=="string"){const s=this[u];typeof s=="function"&&(g=(...e)=>s.call(this,...e))}else g=(...s)=>u.call(this,...s);return g}getEventTarget(u,g={}){const{target:s,type:e,clientX:t=0,clientY:n=0}=u;return g.fromPoint||e==="touchmove"||e==="touchend"?document.elementFromPoint(t,n):s}stopPropagation(u){return this.setEventData(u,{propagationStopped:!0}),this}isPropagationStopped(u){return this.getEventData(u).propagationStopped===!0}getEventData(u){return this.eventData(u)}setEventData(u,g){return this.eventData(u,g)}eventData(u,g){if(u==null)throw new TypeError("Event object required");let s=u.data;const e=`__${this.cid}__`;return g==null?s==null?{}:s[e]||{}:(s==null&&(s=u.data={}),s[e]==null?s[e]=Object.assign({},g):s[e]=Object.assign(Object.assign({},s[e]),g),s[e])}normalizeEvent(u){return c.normalizeEvent(u)}dispose(){this.remove()}}r([c.dispose()],c.prototype,"dispose",null),o.View=c,function(h){function u(e,t){return t?i.Dom.createSvgElement(e||"g"):i.Dom.createElementNS(e||"div")}h.createElement=u;function g(e,t,n){if(!e||e===".")return{elems:[t]};if(n){const a=n[e];if(a)return{elems:Array.isArray(a)?a:[a]}}if(l.Config.useCSSSelector){const a=e.includes(">")?`:scope ${e}`:e;return{isCSSSelector:!0,elems:Array.prototype.slice.call(t.querySelectorAll(a))}}return{elems:[]}}h.find=g;function s(e){let t=e;const n=e.originalEvent,a=n&&n.changedTouches&&n.changedTouches[0];if(a){for(const d in e)a[d]===void 0&&(a[d]=e[d]);t=a}return t}h.normalizeEvent=s}(c=o.View||(o.View={})),function(h){h.views={};function u(g){return h.views[g]||null}h.getView=u}(c=o.View||(o.View={}));var f;(function(h){let u=0;function g(){const s=`v${u}`;return u+=1,s}h.uniqueId=g})(f||(f={}))})(Te);var nr={},tn={};Object.defineProperty(tn,"__esModule",{value:!0});tn.Cache=void 0;const rr=D,qr=ue;class qa{constructor(r){this.view=r,this.clean()}clean(){this.elemCache&&this.elemCache.dispose(),this.elemCache=new rr.Dictionary,this.pathCache={}}get(r){return this.elemCache.has(r)||this.elemCache.set(r,{}),this.elemCache.get(r)}getData(r){const i=this.get(r);return i.data||(i.data={}),i.data}getMatrix(r){const i=this.get(r);if(i.matrix==null){const l=this.view.container;i.matrix=rr.Dom.getTransformToParentElement(r,l)}return rr.Dom.createSVGMatrix(i.matrix)}getShape(r){const i=this.get(r);return i.shape==null&&(i.shape=qr.Util.toGeometryShape(r)),i.shape.clone()}getBoundingRect(r){const i=this.get(r);return i.boundingRect==null&&(i.boundingRect=qr.Util.getBBoxV2(r)),i.boundingRect.clone()}}tn.Cache=qa;var Be={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.Markup=void 0;const r=D;(function(i){function l(t){return t!=null&&!c(t)}i.isJSONMarkup=l;function c(t){return t!=null&&typeof t=="string"}i.isStringMarkup=c;function f(t){return t==null||c(t)?t:r.ObjectExt.cloneDeep(t)}i.clone=f;function h(t){return`${t}`.trim().replace(/[\r|\n]/g," ").replace(/>\s+</g,"><")}i.sanitize=h;function u(t,n={ns:r.Dom.ns.svg}){const a=document.createDocumentFragment(),d={},m={},p=[{markup:Array.isArray(t)?t:[t],parent:a,ns:n.ns}];for(;p.length>0;){const b=p.pop();let y=b.ns||r.Dom.ns.svg;const _=b.markup,O=b.parent;_.forEach(x=>{const C=x.tagName;if(!C)throw new TypeError("Invalid tagName");x.ns&&(y=x.ns);const M=y?r.Dom.createElementNS(C,y):r.Dom.createElement(C),A=x.attrs;A&&r.Dom.attr(M,r.Dom.kebablizeAttrs(A));const j=x.style;j&&r.Dom.css(M,j);const v=x.className;v!=null&&M.setAttribute("class",Array.isArray(v)?v.join(" "):v),x.textContent&&(M.textContent=x.textContent);const P=x.selector;if(P!=null){if(m[P])throw new TypeError("Selector must be unique");m[P]=M}if(x.groupSelector){let S=x.groupSelector;Array.isArray(S)||(S=[S]),S.forEach(T=>{d[T]||(d[T]=[]),d[T].push(M)})}O.appendChild(M);const E=x.children;Array.isArray(E)&&p.push({ns:y,markup:E,parent:M})})}return Object.keys(d).forEach(b=>{if(m[b])throw new Error("Ambiguous group selector");m[b]=d[b]}),{fragment:a,selectors:m,groups:d}}i.parseJSONMarkup=u;function g(t){return t instanceof SVGElement?r.Dom.createSvgElement("g"):r.Dom.createElement("div")}function s(t){if(c(t)){const m=r.Vector.createVectors(t),p=m.length;if(p===1)return{elem:m[0].node};if(p>1){const b=g(m[0].node);return m.forEach(y=>{b.appendChild(y.node)}),{elem:b}}return{}}const n=u(t),a=n.fragment;let d=null;return a.childNodes.length>1?(d=g(a.firstChild),d.appendChild(a)):d=a.firstChild,{elem:d,selectors:n.selectors}}i.renderMarkup=s;function e(t){const n=r.Vector.createVectors(t),a=document.createDocumentFragment();for(let d=0,m=n.length;d<m;d+=1){const p=n[d].node;a.appendChild(p)}return{fragment:a,selectors:{}}}i.parseLabelStringMarkup=e})(o.Markup||(o.Markup={})),function(i){function l(c,f,h){if(c!=null){let u;const g=c.tagName.toLowerCase();if(c===f)return typeof h=="string"?u=`> ${g} > ${h}`:u=`> ${g}`,u;const s=c.parentNode;if(s&&s.childNodes.length>1){const e=r.Dom.index(c)+1;u=`${g}:nth-child(${e})`}else u=g;return h&&(u+=` > ${h}`),l(c.parentNode,f,u)}return h}i.getSelector=l}(o.Markup||(o.Markup={})),function(i){function l(){return"g"}i.getPortContainerMarkup=l;function c(){return{tagName:"circle",selector:"circle",attrs:{r:10,fill:"#FFFFFF",stroke:"#000000"}}}i.getPortMarkup=c;function f(){return{tagName:"text",selector:"text",attrs:{fill:"#000000"}}}i.getPortLabelMarkup=f}(o.Markup||(o.Markup={})),function(i){function l(){return[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}]}i.getEdgeMarkup=l}(o.Markup||(o.Markup={})),function(i){function l(c=!1){return{tagName:"foreignObject",selector:"fo",children:[{ns:r.Dom.ns.xhtml,tagName:"body",selector:"foBody",attrs:{xmlns:r.Dom.ns.xhtml},style:{width:"100%",height:"100%",background:"transparent"},children:c?[]:[{tagName:"div",selector:"foContent",style:{width:"100%",height:"100%"}}]}]}}i.getForeignObjectMarkup=l}(o.Markup||(o.Markup={}))})(Be);var nn={};Object.defineProperty(nn,"__esModule",{value:!0});nn.AttrManager=void 0;const k=D,ir=B,Wa=Er,Xa=Te,sr=ue;class Ja{constructor(r){this.view=r}get cell(){return this.view.cell}getDefinition(r){return this.cell.getAttrDefinition(r)}processAttrs(r,i){let l,c,f,h;const u=[];return Object.keys(i).forEach(g=>{const s=i[g],e=this.getDefinition(g),t=k.FunctionExt.call(Wa.Attr.isValidDefinition,this.view,e,s,{elem:r,attrs:i,cell:this.cell,view:this.view});if(e&&t)typeof e=="string"?(l==null&&(l={}),l[e]=s):s!==null&&u.push({name:g,definition:e});else{l==null&&(l={});const n=k.Dom.CASE_SENSITIVE_ATTR.includes(g)?g:k.StringExt.kebabCase(g);l[n]=s}}),u.forEach(({name:g,definition:s})=>{const e=i[g];typeof s.set=="function"&&(c==null&&(c={}),c[g]=e),typeof s.offset=="function"&&(f==null&&(f={}),f[g]=e),typeof s.position=="function"&&(h==null&&(h={}),h[g]=e)}),{raw:i,normal:l,set:c,offset:f,position:h}}mergeProcessedAttrs(r,i){r.set=Object.assign(Object.assign({},r.set),i.set),r.position=Object.assign(Object.assign({},r.position),i.position),r.offset=Object.assign(Object.assign({},r.offset),i.offset);const l=r.normal&&r.normal.transform;l!=null&&i.normal&&(i.normal.transform=l),r.normal=i.normal}findAttrs(r,i,l,c){const f=[],h=new k.Dictionary;return Object.keys(r).forEach(u=>{const g=r[u];if(!k.ObjectExt.isPlainObject(g))return;const{isCSSSelector:s,elems:e}=Xa.View.find(u,i,c);l[u]=e;for(let t=0,n=e.length;t<n;t+=1){const a=e[t],d=c&&c[u]===a,m=h.get(a);if(m){m.array||(f.push(a),m.array=!0,m.attrs=[m.attrs],m.priority=[m.priority]);const p=m.attrs,b=m.priority;if(d)p.unshift(g),b.unshift(-1);else{const y=k.ArrayExt.sortedIndex(b,s?-1:n);p.splice(y,0,g),b.splice(y,0,n)}}else h.set(a,{elem:a,attrs:g,priority:d?-1:n,array:!1})}}),f.forEach(u=>{const g=h.get(u),s=g.attrs;g.attrs=s.reduceRight((e,t)=>k.ObjectExt.merge(e,t),{})}),h}updateRelativeAttrs(r,i,l){const c=i.raw||{};let f=i.normal||{};const h=i.set,u=i.position,g=i.offset,s=()=>({elem:r,cell:this.cell,view:this.view,attrs:c,refBBox:l.clone()});if(h!=null&&Object.keys(h).forEach(p=>{const b=h[p],y=this.getDefinition(p);if(y!=null){const _=k.FunctionExt.call(y.set,this.view,b,s());typeof _=="object"?f=Object.assign(Object.assign({},f),_):_!=null&&(f[p]=_)}}),r instanceof HTMLElement){this.view.setAttrs(f,r);return}const e=f.transform,t=e?`${e}`:null,n=k.Dom.transformStringToMatrix(t),a=new ir.Point(n.e,n.f);e&&(delete f.transform,n.e=0,n.f=0);let d=!1;u!=null&&Object.keys(u).forEach(p=>{const b=u[p],y=this.getDefinition(p);if(y!=null){const _=k.FunctionExt.call(y.position,this.view,b,s());_!=null&&(d=!0,a.translate(ir.Point.create(_)))}}),this.view.setAttrs(f,r);let m=!1;if(g!=null){const p=this.view.getBoundingRectOfElement(r);if(p.width>0&&p.height>0){const b=sr.Util.transformRectangle(p,n);Object.keys(g).forEach(y=>{const _=g[y],O=this.getDefinition(y);if(O!=null){const x=k.FunctionExt.call(O.offset,this.view,_,{elem:r,cell:this.cell,view:this.view,attrs:c,refBBox:b});x!=null&&(m=!0,a.translate(ir.Point.create(x)))}})}}(e!=null||d||m)&&(a.round(1),n.e=a.x,n.f=a.y,r.setAttribute("transform",k.Dom.matrixToTransformString(n)))}update(r,i,l){const c={},f=this.findAttrs(l.attrs||i,r,c,l.selectors),h=l.attrs?this.findAttrs(i,r,c,l.selectors):f,u=[];f.each(e=>{const t=e.elem,n=e.attrs,a=this.processAttrs(t,n);if(a.set==null&&a.position==null&&a.offset==null)this.view.setAttrs(a.normal,t);else{const d=h.get(t),m=d?d.attrs:null,p=m&&n.ref==null?m.ref:n.ref;let b;if(p){if(b=(c[p]||this.view.find(p,r,l.selectors))[0],!b)throw new Error(`"${p}" reference does not exist.`)}else b=null;const y={node:t,refNode:b,attributes:m,processedAttributes:a},_=u.findIndex(O=>O.refNode===t);_>-1?u.splice(_,0,y):u.push(y)}});const g=new k.Dictionary;let s;u.forEach(e=>{const t=e.node,n=e.refNode;let a;const d=n!=null&&l.rotatableNode!=null&&k.Dom.contains(l.rotatableNode,n);if(n&&(a=g.get(n)),!a){const b=d?l.rotatableNode:r;a=n?sr.Util.getBBox(n,{target:b}):l.rootBBox,n&&g.set(n,a)}let m;l.attrs&&e.attributes?(m=this.processAttrs(t,e.attributes),this.mergeProcessedAttrs(m,e.processedAttributes)):m=e.processedAttributes;let p=a;d&&l.rotatableNode!=null&&!l.rotatableNode.contains(t)&&(s||(s=k.Dom.transformStringToMatrix(k.Dom.attr(l.rotatableNode,"transform"))),p=sr.Util.transformRectangle(a,s)),this.updateRelativeAttrs(t,m,p)})}}nn.AttrManager=Ja;var rn={};Object.defineProperty(rn,"__esModule",{value:!0});rn.FlagManager=void 0;class Ya{get cell(){return this.view.cell}constructor(r,i,l=[]){this.view=r;const c={},f={};let h=0;Object.keys(i).forEach(g=>{let s=i[g];Array.isArray(s)||(s=[s]),s.forEach(e=>{let t=c[e];t||(h+=1,t=c[e]=1<<h),f[g]|=t})});let u=l;if(Array.isArray(u)||(u=[u]),u.forEach(g=>{c[g]||(h+=1,c[g]=1<<h)}),h>25)throw new Error("Maximum number of flags exceeded.");this.flags=c,this.attrs=f,this.bootstrap=l}getFlag(r){const i=this.flags;return i==null?0:Array.isArray(r)?r.reduce((l,c)=>l|i[c],0):i[r]|0}hasAction(r,i){return r&this.getFlag(i)}removeAction(r,i){return r^r&this.getFlag(i)}getBootstrapFlag(){return this.getFlag(this.bootstrap)}getChangedFlag(){let r=0;return this.attrs&&Object.keys(this.attrs).forEach(i=>{this.cell.hasChanged(i)&&(r|=this.attrs[i])}),r}}rn.FlagManager=Ya;var Wr;function sn(){return Wr||(Wr=1,function(o){var r=w&&w.__decorate||function(d,m,p,b){var y=arguments.length,_=y<3?m:b===null?b=Object.getOwnPropertyDescriptor(m,p):b,O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(d,m,p,b);else for(var x=d.length-1;x>=0;x--)(O=d[x])&&(_=(y<3?O(_):y>3?O(m,p,_):O(m,p))||_);return y>3&&_&&Object.defineProperty(m,p,_),_},i=w&&w.__rest||function(d,m){var p={};for(var b in d)Object.prototype.hasOwnProperty.call(d,b)&&m.indexOf(b)<0&&(p[b]=d[b]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,b=Object.getOwnPropertySymbols(d);y<b.length;y++)m.indexOf(b[y])<0&&Object.prototype.propertyIsEnumerable.call(d,b[y])&&(p[b[y]]=d[b[y]]);return p};Object.defineProperty(o,"__esModule",{value:!0}),o.CellView=void 0;const l=B,c=D,f=z,h=Te,u=tn,g=Be,s=me(),e=nn,t=rn,n=ue;class a extends h.View{static getDefaults(){return this.defaults}static config(m){this.defaults=this.getOptions(m)}static getOptions(m){const p=(M,A)=>A!=null?c.ArrayExt.uniq([...Array.isArray(M)?M:[M],...Array.isArray(A)?A:[A]]):Array.isArray(M)?[...M]:[M],b=c.ObjectExt.cloneDeep(this.getDefaults()),{bootstrap:y,actions:_,events:O,documentEvents:x}=m,C=i(m,["bootstrap","actions","events","documentEvents"]);return y&&(b.bootstrap=p(b.bootstrap,y)),_&&Object.entries(_).forEach(([M,A])=>{const j=b.actions[M];A&&j?b.actions[M]=p(j,A):A&&(b.actions[M]=p(A))}),O&&(b.events=Object.assign(Object.assign({},b.events),O)),m.documentEvents&&(b.documentEvents=Object.assign(Object.assign({},b.documentEvents),x)),c.ObjectExt.merge(b,C)}get[Symbol.toStringTag](){return a.toStringTag}constructor(m,p={}){super(),this.cell=m,this.options=this.ensureOptions(p),this.graph=this.options.graph,this.attr=new e.AttrManager(this),this.flag=new t.FlagManager(this,this.options.actions,this.options.bootstrap),this.cache=new u.Cache(this),this.setContainer(this.ensureContainer()),this.setup(),this.init()}init(){}onRemove(){this.removeTools()}get priority(){return this.options.priority}get rootSelector(){return this.options.rootSelector}getConstructor(){return this.constructor}ensureOptions(m){return this.getConstructor().getOptions(m)}getContainerTagName(){return this.options.isSvgElement?"g":"div"}getContainerStyle(){}getContainerAttrs(){return{"data-cell-id":this.cell.id,"data-shape":this.cell.shape}}getContainerClassName(){return this.prefixClassName("cell")}ensureContainer(){return h.View.createElement(this.getContainerTagName(),this.options.isSvgElement)}setContainer(m){if(this.container!==m){this.undelegateEvents(),this.container=m,this.options.events!=null&&this.delegateEvents(this.options.events);const p=this.getContainerAttrs();p!=null&&this.setAttrs(p,m);const b=this.getContainerStyle();b!=null&&this.setStyle(b,m);const y=this.getContainerClassName();y!=null&&this.addClass(y,m)}return this}isNodeView(){return!1}isEdgeView(){return!1}render(){return this}confirmUpdate(m,p={}){return 0}getBootstrapFlag(){return this.flag.getBootstrapFlag()}getFlag(m){return this.flag.getFlag(m)}hasAction(m,p){return this.flag.hasAction(m,p)}removeAction(m,p){return this.flag.removeAction(m,p)}handleAction(m,p,b,y){if(this.hasAction(m,p)){b();const _=[p];return y&&(typeof y=="string"?_.push(y):_.push(...y)),this.removeAction(m,_)}return m}setup(){this.cell.on("changed",this.onCellChanged,this)}onCellChanged({options:m}){this.onAttrsChange(m)}onAttrsChange(m){let p=this.flag.getChangedFlag();m.updated||!p||(m.dirty&&this.hasAction(p,"update")&&(p|=this.getFlag("render")),m.toolId&&(m.async=!1),this.graph!=null&&this.graph.renderer.requestViewUpdate(this,p,m))}parseJSONMarkup(m,p){const b=g.Markup.parseJSONMarkup(m),y=b.selectors,_=this.rootSelector;if(p&&_){if(y[_])throw new Error("Invalid root selector");y[_]=p}return b}can(m){let p=this.graph.options.interacting;if(typeof p=="function"&&(p=c.FunctionExt.call(p,this.graph,this)),typeof p=="object"){let b=p[m];return typeof b=="function"&&(b=c.FunctionExt.call(b,this.graph,this)),b!==!1}return typeof p=="boolean"?p:!1}cleanCache(){return this.cache.clean(),this}getCache(m){return this.cache.get(m)}getDataOfElement(m){return this.cache.getData(m)}getMatrixOfElement(m){return this.cache.getMatrix(m)}getShapeOfElement(m){return this.cache.getShape(m)}getBoundingRectOfElement(m){return this.cache.getBoundingRect(m)}getBBoxOfElement(m){const p=this.getBoundingRectOfElement(m),b=this.getMatrixOfElement(m),y=this.getRootRotatedMatrix(),_=this.getRootTranslatedMatrix();return n.Util.transformRectangle(p,_.multiply(y).multiply(b))}getUnrotatedBBoxOfElement(m){const p=this.getBoundingRectOfElement(m),b=this.getMatrixOfElement(m),y=this.getRootTranslatedMatrix();return n.Util.transformRectangle(p,y.multiply(b))}getBBox(m={}){let p;if(m.useCellGeometry){const b=this.cell,y=b.isNode()?b.getAngle():0;p=b.getBBox().bbox(y)}else p=this.getBBoxOfElement(this.container);return this.graph.coord.localToGraphRect(p)}getRootTranslatedMatrix(){const m=this.cell,p=m.isNode()?m.getPosition():{x:0,y:0};return c.Dom.createSVGMatrix().translate(p.x,p.y)}getRootRotatedMatrix(){let m=c.Dom.createSVGMatrix();const p=this.cell,b=p.isNode()?p.getAngle():0;if(b){const y=p.getBBox(),_=y.width/2,O=y.height/2;m=m.translate(_,O).rotate(b).translate(-_,-O)}return m}findMagnet(m=this.container){return this.findByAttr("magnet",m)}updateAttrs(m,p,b={}){b.rootBBox==null&&(b.rootBBox=new l.Rectangle),b.selectors==null&&(b.selectors=this.selectors),this.attr.update(m,p,b)}isEdgeElement(m){return this.cell.isEdge()&&(m==null||m===this.container)}prepareHighlight(m,p={}){const b=m||this.container;return p.partial=b===this.container,b}highlight(m,p={}){const b=this.prepareHighlight(m,p);return this.notify("cell:highlight",{magnet:b,options:p,view:this,cell:this.cell}),this.isEdgeView()?this.notify("edge:highlight",{magnet:b,options:p,view:this,edge:this.cell,cell:this.cell}):this.isNodeView()&&this.notify("node:highlight",{magnet:b,options:p,view:this,node:this.cell,cell:this.cell}),this}unhighlight(m,p={}){const b=this.prepareHighlight(m,p);return this.notify("cell:unhighlight",{magnet:b,options:p,view:this,cell:this.cell}),this.isNodeView()?this.notify("node:unhighlight",{magnet:b,options:p,view:this,node:this.cell,cell:this.cell}):this.isEdgeView()&&this.notify("edge:unhighlight",{magnet:b,options:p,view:this,edge:this.cell,cell:this.cell}),this}notifyUnhighlight(m,p){}getEdgeTerminal(m,p,b,y,_){const O=this.cell,x=this.findAttr("port",m),C=m.getAttribute("data-selector"),M={cell:O.id};return C!=null&&(M.magnet=C),x!=null?(M.port=x,O.isNode()&&!O.hasPort(x)&&C==null&&(M.selector=this.getSelector(m))):C==null&&this.container!==m&&(M.selector=this.getSelector(m)),M}getMagnetFromEdgeTerminal(m){const p=this.cell,b=this.container,y=m.port;let _=m.magnet,O;return y!=null&&p.isNode()&&p.hasPort(y)?O=this.findPortElem(y,_)||b:(_||(_=m.selector),!_&&y!=null&&(_=`[port="${y}"]`),O=this.findOne(_,b,this.selectors)),O}hasTools(m){const p=this.tools;return p==null?!1:m==null?!0:p.name===m}addTools(m){if(this.removeTools(),m){if(!this.can("toolsAddable"))return this;const p=s.ToolsView.isToolsView(m)?m:new s.ToolsView(m);this.tools=p,p.config({view:this}),p.mount()}return this}updateTools(m={}){return this.tools&&this.tools.update(m),this}removeTools(){return this.tools&&(this.tools.remove(),this.tools=null),this}hideTools(){return this.tools&&this.tools.hide(),this}showTools(){return this.tools&&this.tools.show(),this}renderTools(){const m=this.cell.getTools();return this.addTools(m),this}notify(m,p){return this.trigger(m,p),this.graph.trigger(m,p),this}getEventArgs(m,p,b){const y=this,_=y.cell;return p==null||b==null?{e:m,view:y,cell:_}:{e:m,x:p,y:b,view:y,cell:_}}onClick(m,p,b){this.notify("cell:click",this.getEventArgs(m,p,b))}onDblClick(m,p,b){this.notify("cell:dblclick",this.getEventArgs(m,p,b))}onContextMenu(m,p,b){this.notify("cell:contextmenu",this.getEventArgs(m,p,b))}onMouseDown(m,p,b){this.cell.model&&(this.cachedModelForMouseEvent=this.cell.model,this.cachedModelForMouseEvent.startBatch("mouse")),this.notify("cell:mousedown",this.getEventArgs(m,p,b))}onMouseUp(m,p,b){this.notify("cell:mouseup",this.getEventArgs(m,p,b)),this.cachedModelForMouseEvent&&(this.cachedModelForMouseEvent.stopBatch("mouse",{cell:this.cell}),this.cachedModelForMouseEvent=null)}onMouseMove(m,p,b){this.notify("cell:mousemove",this.getEventArgs(m,p,b))}onMouseOver(m){this.notify("cell:mouseover",this.getEventArgs(m))}onMouseOut(m){this.notify("cell:mouseout",this.getEventArgs(m))}onMouseEnter(m){this.notify("cell:mouseenter",this.getEventArgs(m))}onMouseLeave(m){this.notify("cell:mouseleave",this.getEventArgs(m))}onMouseWheel(m,p,b,y){this.notify("cell:mousewheel",Object.assign({delta:y},this.getEventArgs(m,p,b)))}onCustomEvent(m,p,b,y){this.notify("cell:customevent",Object.assign({name:p},this.getEventArgs(m,b,y))),this.notify(p,Object.assign({},this.getEventArgs(m,b,y)))}onMagnetMouseDown(m,p,b,y){}onMagnetDblClick(m,p,b,y){}onMagnetContextMenu(m,p,b,y){}onLabelMouseDown(m,p,b){}checkMouseleave(m){const p=this.getEventTarget(m,{fromPoint:!0}),b=this.graph.findViewByElem(p);b!==this&&(this.onMouseLeave(m),b&&b.onMouseEnter(m))}dispose(){this.cell.off("changed",this.onCellChanged,this)}}a.defaults={isSvgElement:!0,rootSelector:"root",priority:0,bootstrap:[],actions:{}},r([a.dispose()],a.prototype,"dispose",null),o.CellView=a,function(d){d.Flag=t.FlagManager,d.Attr=e.AttrManager}(a=o.CellView||(o.CellView={})),function(d){d.toStringTag=`X6.${d.name}`;function m(p){if(p==null)return!1;if(p instanceof d)return!0;const b=p[Symbol.toStringTag],y=p;return(b==null||b===d.toStringTag)&&typeof y.isNodeView=="function"&&typeof y.isEdgeView=="function"&&typeof y.confirmUpdate=="function"}d.isCellView=m}(a=o.CellView||(o.CellView={})),function(d){function m(b){return function(y){y.config({priority:b})}}d.priority=m;function p(b){return function(y){y.config({bootstrap:b})}}d.bootstrap=p}(a=o.CellView||(o.CellView={})),function(d){d.registry=f.Registry.create({type:"view"})}(a=o.CellView||(o.CellView={}))}(nr)),nr}var Xr;function me(){return Xr||(Xr=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.ToolsView=void 0;const r=D,i=cs(),l=Te,c=sn(),f=Be;class h extends l.View{get name(){return this.options.name}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get[Symbol.toStringTag](){return h.toStringTag}constructor(g={}){super(),this.svgContainer=this.createContainer(!0,g),this.htmlContainer=this.createContainer(!1,g),this.config(g)}createContainer(g,s){const e=g?l.View.createElement("g",!0):l.View.createElement("div",!1);return r.Dom.addClass(e,this.prefixClassName("cell-tools")),s.className&&r.Dom.addClass(e,s.className),e}config(g){if(this.options=Object.assign(Object.assign({},this.options),g),!c.CellView.isCellView(g.view)||g.view===this.cellView)return this;this.cellView=g.view,this.cell.isEdge()?(r.Dom.addClass(this.svgContainer,this.prefixClassName("edge-tools")),r.Dom.addClass(this.htmlContainer,this.prefixClassName("edge-tools"))):this.cell.isNode()&&(r.Dom.addClass(this.svgContainer,this.prefixClassName("node-tools")),r.Dom.addClass(this.htmlContainer,this.prefixClassName("node-tools"))),this.svgContainer.setAttribute("data-cell-id",this.cell.id),this.htmlContainer.setAttribute("data-cell-id",this.cell.id),this.name&&(this.svgContainer.setAttribute("data-tools-name",this.name),this.htmlContainer.setAttribute("data-tools-name",this.name));const s=this.options.items;if(!Array.isArray(s))return this;this.tools=[];const e=[];s.forEach(t=>{h.ToolItem.isToolItem(t)?t.name==="vertices"?e.unshift(t):e.push(t):(typeof t=="object"?t.name:t)==="vertices"?e.unshift(t):e.push(t)});for(let t=0;t<e.length;t+=1){const n=e[t];let a;if(h.ToolItem.isToolItem(n))a=n;else{const d=typeof n=="object"?n.name:n,m=typeof n=="object"?n.args||{}:{};if(d){if(this.cell.isNode()){const p=i.NodeTool.registry.get(d);if(p)a=new p(m);else return i.NodeTool.registry.onNotFound(d)}else if(this.cell.isEdge()){const p=i.EdgeTool.registry.get(d);if(p)a=new p(m);else return i.EdgeTool.registry.onNotFound(d)}}}a&&(a.config(this.cellView,this),a.render(),(a.options.isSVGElement!==!1?this.svgContainer:this.htmlContainer).appendChild(a.container),this.tools.push(a))}return this}update(g={}){const s=this.tools;return s&&s.forEach(e=>{g.toolId!==e.cid&&e.isVisible()&&e.update()}),this}focus(g){const s=this.tools;return s&&s.forEach(e=>{g===e?e.show():e.hide()}),this}blur(g){const s=this.tools;return s&&s.forEach(e=>{e!==g&&!e.isVisible()&&(e.show(),e.update())}),this}hide(){return this.focus(null)}show(){return this.blur(null)}remove(){const g=this.tools;return g&&(g.forEach(s=>s.remove()),this.tools=null),r.Dom.remove(this.svgContainer),r.Dom.remove(this.htmlContainer),super.remove()}mount(){const g=this.tools,s=this.cellView;if(s&&g){const e=g.some(n=>n.options.isSVGElement!==!1),t=g.some(n=>n.options.isSVGElement===!1);e&&(this.options.local?s.container:s.graph.view.decorator).appendChild(this.svgContainer),t&&this.graph.container.appendChild(this.htmlContainer)}return this}}o.ToolsView=h,function(u){u.toStringTag=`X6.${u.name}`;function g(s){if(s==null)return!1;if(s instanceof u)return!0;const e=s[Symbol.toStringTag],t=s;return(e==null||e===u.toStringTag)&&t.graph!=null&&t.cell!=null&&typeof t.config=="function"&&typeof t.update=="function"&&typeof t.focus=="function"&&typeof t.blur=="function"&&typeof t.show=="function"&&typeof t.hide=="function"}u.isToolsView=g}(h=o.ToolsView||(o.ToolsView={})),function(u){class g extends l.View{static getDefaults(){return this.defaults}static config(e){this.defaults=this.getOptions(e)}static getOptions(e){return r.ObjectExt.merge(r.ObjectExt.cloneDeep(this.getDefaults()),e)}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get name(){return this.options.name}get[Symbol.toStringTag](){return g.toStringTag}constructor(e={}){super(),this.visible=!0,this.options=this.getOptions(e),this.container=l.View.createElement(this.options.tagName||"g",this.options.isSVGElement!==!1),r.Dom.addClass(this.container,this.prefixClassName("cell-tool")),typeof this.options.className=="string"&&r.Dom.addClass(this.container,this.options.className),this.init()}init(){}getOptions(e){return this.constructor.getOptions(e)}delegateEvents(){return this.options.events&&super.delegateEvents(this.options.events),this}config(e,t){return this.cellView=e,this.parent=t,this.stamp(this.container),this.cell.isEdge()?r.Dom.addClass(this.container,this.prefixClassName("edge-tool")):this.cell.isNode()&&r.Dom.addClass(this.container,this.prefixClassName("node-tool")),this.name&&this.container.setAttribute("data-tool-name",this.name),this.delegateEvents(),this}render(){this.empty();const e=this.options.markup;if(e){const t=f.Markup.parseJSONMarkup(e);this.container.appendChild(t.fragment),this.childNodes=t.selectors}return this.onRender(),this}onRender(){}update(){return this}stamp(e){e&&e.setAttribute("data-cell-id",this.cellView.cell.id)}show(){return this.container.style.display="",this.visible=!0,this}hide(){return this.container.style.display="none",this.visible=!1,this}isVisible(){return this.visible}focus(){const e=this.options.focusOpacity;return e!=null&&Number.isFinite(e)&&(this.container.style.opacity=`${e}`),this.parent.focus(this),this}blur(){return this.container.style.opacity="",this.parent.blur(this),this}guard(e){return this.graph==null||this.cellView==null?!0:this.graph.view.guard(e,this.cellView)}}g.defaults={isSVGElement:!0,tagName:"g"},u.ToolItem=g,function(s){let e=0;function t(a){return a?r.StringExt.pascalCase(a):(e+=1,`CustomTool${e}`)}function n(a){const d=r.ObjectExt.createClass(t(a.name),this);return d.config(a),d}s.define=n}(g=u.ToolItem||(u.ToolItem={})),function(s){s.toStringTag=`X6.${s.name}`;function e(t){if(t==null)return!1;if(t instanceof s)return!0;const n=t[Symbol.toStringTag],a=t;return(n==null||n===s.toStringTag)&&a.graph!=null&&a.cell!=null&&typeof a.config=="function"&&typeof a.update=="function"&&typeof a.focus=="function"&&typeof a.blur=="function"&&typeof a.show=="function"&&typeof a.hide=="function"&&typeof a.isVisible=="function"}s.isToolItem=e}(g=u.ToolItem||(u.ToolItem={}))}(h=o.ToolsView||(o.ToolsView={}))}(tr)),tr}var or={},be={},os={},as={},on={};Object.defineProperty(on,"__esModule",{value:!0});on.noop=void 0;const Ka=o=>o;on.noop=Ka;var Fe={};Object.defineProperty(Fe,"__esModule",{value:!0});Fe.pinAbsolute=Fe.pinRelative=void 0;const Za=B;function Jr(o,r){return r===0?"0%":`${Math.round(o/r*100)}%`}function ls(o){return(i,l,c,f)=>l.isEdgeElement(c)?el(o,i,l,c,f):Qa(o,i,l,c,f)}function Qa(o,r,i,l,c){const f=i.cell,h=f.getAngle(),u=i.getUnrotatedBBoxOfElement(l),g=f.getBBox().getCenter(),s=Za.Point.create(c).rotate(h,g);let e=s.x-u.x,t=s.y-u.y;return o&&(e=Jr(e,u.width),t=Jr(t,u.height)),r.anchor={name:"topLeft",args:{dx:e,dy:t,rotate:!0}},r}function el(o,r,i,l,c){const f=i.getConnection();if(!f)return r;const h=f.closestPointLength(c);if(o){const u=f.length();r.anchor={name:"ratio",args:{ratio:h/u}}}else r.anchor={name:"length",args:{length:h}};return r}Fe.pinRelative=ls(!0);Fe.pinAbsolute=ls(!1);(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(on,o),i(Fe,o)})(as);(function(o){var r=w&&w.__createBinding||(Object.create?function(h,u,g,s){s===void 0&&(s=g);var e=Object.getOwnPropertyDescriptor(u,g);(!e||("get"in e?!u.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return u[g]}}),Object.defineProperty(h,s,e)}:function(h,u,g,s){s===void 0&&(s=g),h[s]=u[g]}),i=w&&w.__setModuleDefault||(Object.create?function(h,u){Object.defineProperty(h,"default",{enumerable:!0,value:u})}:function(h,u){h.default=u}),l=w&&w.__importStar||function(h){if(h&&h.__esModule)return h;var u={};if(h!=null)for(var g in h)g!=="default"&&Object.prototype.hasOwnProperty.call(h,g)&&r(u,h,g);return i(u,h),u};Object.defineProperty(o,"__esModule",{value:!0}),o.ConnectionStrategy=void 0;const c=z,f=l(as);(function(h){h.presets=f,h.registry=c.Registry.create({type:"connection strategy"}),h.registry.register(h.presets,!0)})(o.ConnectionStrategy||(o.ConnectionStrategy={}))})(os);Object.defineProperty(be,"__esModule",{value:!0});be.getViewBBox=be.getAnchor=void 0;const tl=D,nl=os;function rl(o,r,i,l){return tl.FunctionExt.call(nl.ConnectionStrategy.presets.pinRelative,this.graph,{},r,i,o,this.cell,l,{}).anchor}be.getAnchor=rl;function il(o,r){return r?o.cell.getBBox():o.cell.isEdge()?o.getConnection().bbox():o.getUnrotatedBBoxOfElement(o.container)}be.getViewBBox=il;var Yr;function sl(){return Yr||(Yr=1,function(o){var r=w&&w.__createBinding||(Object.create?function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}:function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]}),i=w&&w.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),l=w&&w.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)&&r(e,s,t);return i(e,s),e};Object.defineProperty(o,"__esModule",{value:!0}),o.Button=void 0;const c=B,f=D,h=me(),u=l(be);class g extends h.ToolsView.ToolItem{onRender(){f.Dom.addClass(this.container,this.prefixClassName("cell-tool-button")),this.update()}update(){return this.updatePosition(),this}updatePosition(){const t=this.cellView.cell.isEdge()?this.getEdgeMatrix():this.getNodeMatrix();f.Dom.transform(this.container,t,{absolute:!0})}getNodeMatrix(){const e=this.cellView,t=this.options;let{x:n=0,y:a=0}=t;const{offset:d,useCellGeometry:m,rotate:p}=t;let b=u.getViewBBox(e,m);const y=e.cell.getAngle();p||(b=b.bbox(y));let _=0,O=0;typeof d=="number"?(_=d,O=d):typeof d=="object"&&(_=d.x,O=d.y),n=f.NumberExt.normalizePercentage(n,b.width),a=f.NumberExt.normalizePercentage(a,b.height);let x=f.Dom.createSVGMatrix().translate(b.x+b.width/2,b.y+b.height/2);return p&&(x=x.rotate(y)),x=x.translate(n+_-b.width/2,a+O-b.height/2),x}getEdgeMatrix(){const e=this.cellView,t=this.options,{offset:n=0,distance:a=0,rotate:d}=t;let m,p,b;const y=f.NumberExt.normalizePercentage(a,1);y>=0&&y<=1?m=e.getTangentAtRatio(y):m=e.getTangentAtLength(y),m?(p=m.start,b=m.vector().vectorAngle(new c.Point(1,0))||0):(p=e.getConnection().start,b=0);let _=f.Dom.createSVGMatrix().translate(p.x,p.y).rotate(b);return typeof n=="object"?_=_.translate(n.x||0,n.y||0):_=_.translate(0,n),d||(_=_.rotate(-b)),_}onMouseDown(e){if(this.guard(e))return;e.stopPropagation(),e.preventDefault();const t=this.options.onClick;typeof t=="function"&&f.FunctionExt.call(t,this.cellView,{e,view:this.cellView,cell:this.cellView.cell,btn:this})}}o.Button=g,function(s){s.config({name:"button",useCellGeometry:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"}})}(g=o.Button||(o.Button={})),function(s){s.Remove=s.define({name:"button-remove",markup:[{tagName:"circle",selector:"button",attrs:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attrs:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],distance:60,offset:0,useCellGeometry:!0,onClick({view:e,btn:t}){t.parent.remove(),e.cell.remove({ui:!0,toolId:t.cid})}})}(g=o.Button||(o.Button={}))}(or)),or}var ar={},Kr;function ol(){return Kr||(Kr=1,function(o){var r=w&&w.__createBinding||(Object.create?function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}:function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]}),i=w&&w.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),l=w&&w.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)&&r(e,s,t);return i(e,s),e},c=w&&w.__rest||function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(t[n[a]]=s[n[a]]);return t};Object.defineProperty(o,"__esModule",{value:!0}),o.Boundary=void 0;const f=D,h=me(),u=l(be);class g extends h.ToolsView.ToolItem{onRender(){if(f.Dom.addClass(this.container,this.prefixClassName("cell-tool-boundary")),this.options.attrs){const e=this.options.attrs,{class:t}=e,n=c(e,["class"]);f.Dom.attr(this.container,f.Dom.kebablizeAttrs(n)),t&&f.Dom.addClass(this.container,t)}this.update()}update(){const e=this.cellView,t=this.options,{useCellGeometry:n,rotate:a}=t,d=f.NumberExt.normalizeSides(t.padding);let m=u.getViewBBox(e,n).moveAndExpand({x:-d.left,y:-d.top,width:d.left+d.right,height:d.top+d.bottom});const p=e.cell;if(p.isNode()){const b=p.getAngle();if(b)if(a){const y=p.getBBox().getCenter();f.Dom.rotate(this.container,b,y.x,y.y,{absolute:!0})}else m=m.bbox(b)}return f.Dom.attr(this.container,m.toJSON()),this}}o.Boundary=g,function(s){s.config({name:"boundary",tagName:"rect",padding:10,useCellGeometry:!0,attrs:{fill:"none",stroke:"#333","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"}})}(g=o.Boundary||(o.Boundary={}))}(ar)),ar}var lr={},Zr;function al(){return Zr||(Zr=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.Vertices=void 0;const r=B,i=D,l=ce,c=Te,f=me();class h extends f.ToolsView.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}onRender(){return this.addClass(this.prefixClassName("edge-tool-vertices")),this.options.addable&&this.updatePath(),this.resetHandles(),this.renderHandles(),this}update(){return this.vertices.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.addable&&this.updatePath(),this}resetHandles(){const g=this.handles;this.handles=[],g&&g.forEach(s=>{this.stopHandleListening(s),s.remove()})}renderHandles(){const g=this.vertices;for(let s=0,e=g.length;s<e;s+=1){const t=g[s],n=this.options.createHandle,a=this.options.processHandle,d=n({index:s,graph:this.graph,guard:m=>this.guard(m),attrs:this.options.attrs||{}});a&&a(d),d.updatePosition(t.x,t.y),this.stamp(d.container),this.container.appendChild(d.container),this.handles.push(d),this.startHandleListening(d)}}updateHandles(){const g=this.vertices;for(let s=0,e=g.length;s<e;s+=1){const t=g[s],n=this.handles[s];n&&n.updatePosition(t.x,t.y)}}updatePath(){const g=this.childNodes.connection;g&&g.setAttribute("d",this.cellView.getConnectionPathData())}startHandleListening(g){const s=this.cellView;s.can("vertexMovable")&&(g.on("change",this.onHandleChange,this),g.on("changing",this.onHandleChanging,this),g.on("changed",this.onHandleChanged,this)),s.can("vertexDeletable")&&g.on("remove",this.onHandleRemove,this)}stopHandleListening(g){const s=this.cellView;s.can("vertexMovable")&&(g.off("change",this.onHandleChange,this),g.off("changing",this.onHandleChanging,this),g.off("changed",this.onHandleChanged,this)),s.can("vertexDeletable")&&g.off("remove",this.onHandleRemove,this)}getNeighborPoints(g){const s=this.cellView,e=this.vertices,t=g>0?e[g-1]:s.sourceAnchor,n=g<e.length-1?e[g+1]:s.targetAnchor;return{prev:r.Point.create(t),next:r.Point.create(n)}}getMouseEventArgs(g){const s=this.normalizeEvent(g),{x:e,y:t}=this.graph.snapToGrid(s.clientX,s.clientY);return{e:s,x:e,y:t}}onHandleChange({e:g}){this.focus();const s=this.cellView;if(s.cell.startBatch("move-vertex",{ui:!0,toolId:this.cid}),!this.options.stopPropagation){const{e,x:t,y:n}=this.getMouseEventArgs(g);this.eventData(e,{start:{x:t,y:n}}),s.notifyMouseDown(e,t,n)}}onHandleChanging({handle:g,e:s}){const e=this.cellView,t=g.options.index,{e:n,x:a,y:d}=this.getMouseEventArgs(s),m={x:a,y:d};this.snapVertex(m,t),e.cell.setVertexAt(t,m,{ui:!0,toolId:this.cid}),g.updatePosition(m.x,m.y),this.options.stopPropagation||e.notifyMouseMove(n,a,d)}stopBatch(g){this.cell.stopBatch("move-vertex",{ui:!0,toolId:this.cid}),g&&this.cell.stopBatch("add-vertex",{ui:!0,toolId:this.cid})}onHandleChanged({e:g}){const s=this.options,e=this.cellView;if(s.addable&&this.updatePath(),!s.removeRedundancies){this.stopBatch(this.eventData(g).vertexAdded);return}e.removeRedundantLinearVertices({ui:!0,toolId:this.cid})&&this.render(),this.blur(),this.stopBatch(this.eventData(g).vertexAdded);const{e:n,x:a,y:d}=this.getMouseEventArgs(g);if(!this.options.stopPropagation){e.notifyMouseUp(n,a,d);const{start:m}=this.eventData(n);if(m){const{x:p,y:b}=m;p===a&&b===d&&e.onClick(n,a,d)}}e.checkMouseleave(n),s.onChanged&&s.onChanged({edge:e.cell,edgeView:e})}snapVertex(g,s){const e=this.options.snapRadius||0;if(e>0){const t=this.getNeighborPoints(s),n=t.prev,a=t.next;Math.abs(g.x-n.x)<e?g.x=n.x:Math.abs(g.x-a.x)<e&&(g.x=a.x),Math.abs(g.y-n.y)<e?g.y=t.prev.y:Math.abs(g.y-a.y)<e&&(g.y=a.y)}}onHandleRemove({handle:g,e:s}){if(this.options.removable){const e=g.options.index,t=this.cellView;t.cell.removeVertexAt(e,{ui:!0}),this.options.addable&&this.updatePath(),t.checkMouseleave(this.normalizeEvent(s))}}allowAddVertex(g){const s=this.guard(g),e=this.options.addable&&this.cellView.can("vertexAddable"),t=this.options.modifiers?i.ModifierKey.isMatch(g,this.options.modifiers):!0;return!s&&e&&t}onPathMouseDown(g){const s=this.cellView;if(!this.allowAddVertex(g))return;g.stopPropagation(),g.preventDefault();const e=this.normalizeEvent(g),t=this.graph.snapToGrid(e.clientX,e.clientY).toJSON();s.cell.startBatch("add-vertex",{ui:!0,toolId:this.cid});const n=s.getVertexIndex(t.x,t.y);this.snapVertex(t,n),s.cell.insertVertex(t,n,{ui:!0,toolId:this.cid}),this.render();const a=this.handles[n];this.eventData(e,{vertexAdded:!0}),a.onMouseDown(e)}onRemove(){this.resetHandles()}}o.Vertices=h,function(u){class g extends c.View{get graph(){return this.options.graph}constructor(e){super(),this.options=e,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDoubleClick"})}render(){this.container=c.View.createElement("circle",!0);const e=this.options.attrs;if(typeof e=="function"){const t=u.getDefaults();this.setAttrs(Object.assign(Object.assign({},t.attrs),e(this)))}else this.setAttrs(e);this.addClass(this.prefixClassName("edge-tool-vertex"))}updatePosition(e,t){this.setAttrs({cx:e,cy:t})}onMouseDown(e){this.options.guard(e)||(e.stopPropagation(),e.preventDefault(),this.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},e.data),this.emit("change",{e,handle:this}))}onMouseMove(e){this.emit("changing",{e,handle:this})}onMouseUp(e){this.emit("changed",{e,handle:this}),this.undelegateDocumentEvents(),this.graph.view.delegateEvents()}onDoubleClick(e){this.emit("remove",{e,handle:this})}}u.Handle=g}(h=o.Vertices||(o.Vertices={})),function(u){const g=l.Config.prefix("edge-tool-vertex-path");u.config({name:"vertices",snapRadius:20,addable:!0,removable:!0,removeRedundancies:!0,stopPropagation:!0,attrs:{r:6,fill:"#333",stroke:"#fff",cursor:"move","stroke-width":2},createHandle:s=>new u.Handle(s),markup:[{tagName:"path",selector:"connection",className:g,attrs:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"pointer"}}],events:{[`mousedown .${g}`]:"onPathMouseDown",[`touchstart .${g}`]:"onPathMouseDown"}})}(h=o.Vertices||(o.Vertices={}))}(lr)),lr}var cr={},Qr;function ll(){return Qr||(Qr=1,function(o){var r=w&&w.__createBinding||(Object.create?function(e,t,n,a){a===void 0&&(a=n);var d=Object.getOwnPropertyDescriptor(t,n);(!d||("get"in d?!t.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,d)}:function(e,t,n,a){a===void 0&&(a=n),e[a]=t[n]}),i=w&&w.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=w&&w.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(o,"__esModule",{value:!0}),o.Segments=void 0;const c=D,f=B,h=Te,u=me(),g=l(be);class s extends u.ToolsView.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}update(){return this.render(),this}onRender(){c.Dom.addClass(this.container,this.prefixClassName("edge-tool-segments")),this.resetHandles();const t=this.cellView,n=[...this.vertices];n.unshift(t.sourcePoint),n.push(t.targetPoint);for(let a=0,d=n.length;a<d-1;a+=1){const m=n[a],p=n[a+1],b=this.renderHandle(m,p,a);this.stamp(b.container),this.handles.push(b)}return this}renderHandle(t,n,a){const d=this.options.createHandle({index:a,graph:this.graph,guard:m=>this.guard(m),attrs:this.options.attrs||{}});return this.options.processHandle&&this.options.processHandle(d),this.updateHandle(d,t,n),this.container.appendChild(d.container),this.startHandleListening(d),d}startHandleListening(t){t.on("change",this.onHandleChange,this),t.on("changing",this.onHandleChanging,this),t.on("changed",this.onHandleChanged,this)}stopHandleListening(t){t.off("change",this.onHandleChange,this),t.off("changing",this.onHandleChanging,this),t.off("changed",this.onHandleChanged,this)}resetHandles(){const t=this.handles;this.handles=[],t&&t.forEach(n=>{this.stopHandleListening(n),n.remove()})}shiftHandleIndexes(t){const n=this.handles;for(let a=0,d=n.length;a<d;a+=1)n[a].options.index+=t}resetAnchor(t,n){const a=this.cellView.cell,d={ui:!0,toolId:this.cid};n?a.prop([t,"anchor"],n,d):a.removeProp([t,"anchor"],d)}snapHandle(t,n,a){const d=t.options.axis,m=t.options.index,y=this.cellView.cell.getVertices(),_=y[m-2]||a.sourceAnchor,O=y[m+1]||a.targetAnchor,x=this.options.snapRadius;return Math.abs(n[d]-_[d])<x?n[d]=_[d]:Math.abs(n[d]-O[d])<x&&(n[d]=O[d]),n}onHandleChanging({handle:t,e:n}){const a=this.graph,d=this.options,m=this.cellView,p=d.anchor,b=t.options.axis,y=t.options.index-1,_=this.getEventData(n),O=this.normalizeEvent(n),x=a.snapToGrid(O.clientX,O.clientY),C=this.snapHandle(t,x.clone(),_),M=c.ObjectExt.cloneDeep(this.vertices);let A=M[y],j=M[y+1];const v=m.sourceView,P=m.sourceBBox;let E=!1,S=!1;if(A?y===0?P.containsPoint(A)?(M.shift(),this.shiftHandleIndexes(-1),E=!0):(A[b]=C[b],S=!0):A[b]=C[b]:(A=m.sourceAnchor.toJSON(),A[b]=C[b],P.containsPoint(A)?E=!0:(M.unshift(A),this.shiftHandleIndexes(1),S=!0)),typeof p=="function"&&v){if(E){const ie=_.sourceAnchor.clone();ie[b]=C[b];const Q=c.FunctionExt.call(p,m,ie,v,m.sourceMagnet||v.container,"source",m,this);this.resetAnchor("source",Q)}S&&this.resetAnchor("source",_.sourceAnchorDef)}const T=m.targetView,R=m.targetBBox;let L=!1,_e=!1;if(j?y===M.length-2?R.containsPoint(j)?(M.pop(),L=!0):(j[b]=C[b],_e=!0):j[b]=C[b]:(j=m.targetAnchor.toJSON(),j[b]=C[b],R.containsPoint(j)?L=!0:(M.push(j),_e=!0)),typeof p=="function"&&T){if(L){const ie=_.targetAnchor.clone();ie[b]=C[b];const Q=c.FunctionExt.call(p,m,ie,T,m.targetMagnet||T.container,"target",m,this);this.resetAnchor("target",Q)}_e&&this.resetAnchor("target",_.targetAnchorDef)}f.Point.equalPoints(M,this.vertices)||this.cellView.cell.setVertices(M,{ui:!0,toolId:this.cid}),this.updateHandle(t,A,j,0),d.stopPropagation||m.notifyMouseMove(O,x.x,x.y)}onHandleChange({handle:t,e:n}){const a=this.options,d=this.handles,m=this.cellView,p=t.options.index;if(!!Array.isArray(d)){for(let b=0,y=d.length;b<y;b+=1)b!==p&&d[b].hide();if(this.focus(),this.setEventData(n,{sourceAnchor:m.sourceAnchor.clone(),targetAnchor:m.targetAnchor.clone(),sourceAnchorDef:c.ObjectExt.cloneDeep(this.cell.prop(["source","anchor"])),targetAnchorDef:c.ObjectExt.cloneDeep(this.cell.prop(["target","anchor"]))}),this.cell.startBatch("move-segment",{ui:!0,toolId:this.cid}),!a.stopPropagation){const b=this.normalizeEvent(n),y=this.graph.snapToGrid(b.clientX,b.clientY);m.notifyMouseDown(b,y.x,y.y)}}}onHandleChanged({e:t}){const n=this.options,a=this.cellView;n.removeRedundancies&&a.removeRedundantLinearVertices({ui:!0,toolId:this.cid});const d=this.normalizeEvent(t),m=this.graph.snapToGrid(d.clientX,d.clientY);this.render(),this.blur(),this.cell.stopBatch("move-segment",{ui:!0,toolId:this.cid}),n.stopPropagation||a.notifyMouseUp(d,m.x,m.y),a.checkMouseleave(d),n.onChanged&&n.onChanged({edge:a.cell,edgeView:a})}updateHandle(t,n,a,d=0){const m=this.options.precision||0,p=Math.abs(n.x-a.x)<m,b=Math.abs(n.y-a.y)<m;if(p||b){const y=new f.Line(n,a);if(y.length()<this.options.threshold)t.hide();else{const O=y.getCenter(),x=p?"x":"y";O[x]+=d||0;const C=y.vector().vectorAngle(new f.Point(1,0));t.updatePosition(O.x,O.y,C,this.cellView),t.show(),t.options.axis=x}}else t.hide()}onRemove(){this.resetHandles()}}o.Segments=s,function(e){class t extends h.View{constructor(a){super(),this.options=a,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"})}render(){this.container=h.View.createElement("rect",!0);const a=this.options.attrs;if(typeof a=="function"){const d=e.getDefaults();this.setAttrs(Object.assign(Object.assign({},d.attrs),a(this)))}else this.setAttrs(a);this.addClass(this.prefixClassName("edge-tool-segment"))}updatePosition(a,d,m,p){const b=p.getClosestPoint(new f.Point(a,d))||new f.Point(a,d);let y=c.Dom.createSVGMatrix().translate(b.x,b.y);if(b.equals({x:a,y:d}))y=y.rotate(m);else{let O=new f.Line(a,d,b.x,b.y).vector().vectorAngle(new f.Point(1,0));O!==0&&(O+=90),y=y.rotate(O)}this.setAttrs({transform:c.Dom.matrixToTransformString(y),cursor:m%180===0?"row-resize":"col-resize"})}onMouseDown(a){this.options.guard(a)||(this.trigger("change",{e:a,handle:this}),a.stopPropagation(),a.preventDefault(),this.options.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},a.data))}onMouseMove(a){this.emit("changing",{e:a,handle:this})}onMouseUp(a){this.emit("changed",{e:a,handle:this}),this.undelegateDocumentEvents(),this.options.graph.view.delegateEvents()}show(){this.container.style.display=""}hide(){this.container.style.display="none"}}e.Handle=t}(s=o.Segments||(o.Segments={})),function(e){e.config({name:"segments",precision:.5,threshold:40,snapRadius:10,stopPropagation:!0,removeRedundancies:!0,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#333",stroke:"#fff","stroke-width":2},createHandle:t=>new e.Handle(t),anchor:g.getAnchor})}(s=o.Segments||(o.Segments={}))}(cr)),cr}var je={},ei;function cl(){if(ei)return je;ei=1;var o=w&&w.__createBinding||(Object.create?function(g,s,e,t){t===void 0&&(t=e);var n=Object.getOwnPropertyDescriptor(s,e);(!n||("get"in n?!s.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return s[e]}}),Object.defineProperty(g,t,n)}:function(g,s,e,t){t===void 0&&(t=e),g[t]=s[e]}),r=w&&w.__setModuleDefault||(Object.create?function(g,s){Object.defineProperty(g,"default",{enumerable:!0,value:s})}:function(g,s){g.default=s}),i=w&&w.__importStar||function(g){if(g&&g.__esModule)return g;var s={};if(g!=null)for(var e in g)e!=="default"&&Object.prototype.hasOwnProperty.call(g,e)&&o(s,g,e);return r(s,g),s};Object.defineProperty(je,"__esModule",{value:!0}),je.TargetAnchor=je.SourceAnchor=void 0;const l=D,c=B,f=me(),h=i(be);class u extends f.ToolsView.ToolItem{get type(){return this.options.type}onRender(){l.Dom.addClass(this.container,this.prefixClassName(`edge-tool-${this.type}-anchor`)),this.toggleArea(!1),this.update()}update(){const s=this.type;return this.cellView.getTerminalView(s)?(this.updateAnchor(),this.updateArea(),this.container.style.display=""):this.container.style.display="none",this}updateAnchor(){const s=this.childNodes;if(!s)return;const e=s.anchor;if(!e)return;const t=this.type,n=this.cellView,a=this.options,d=n.getTerminalAnchor(t),m=n.cell.prop([t,"anchor"]);e.setAttribute("transform",`translate(${d.x}, ${d.y})`);const p=m?a.customAnchorAttrs:a.defaultAnchorAttrs;p&&Object.keys(p).forEach(b=>{e.setAttribute(b,p[b])})}updateArea(){const s=this.childNodes;if(!s)return;const e=s.area;if(!e)return;const t=this.type,n=this.cellView,a=n.getTerminalView(t);if(a){const d=a.cell,m=n.getTerminalMagnet(t);let p=this.options.areaPadding||0;Number.isFinite(p)||(p=0);let b,y,_;a.isEdgeElement(m)?(b=a.getBBox(),y=0,_=b.getCenter()):(b=a.getUnrotatedBBoxOfElement(m),y=d.getAngle(),_=b.getCenter(),y&&_.rotate(-y,d.getBBox().getCenter())),b.inflate(p),l.Dom.attr(e,{x:-b.width/2,y:-b.height/2,width:b.width,height:b.height,transform:`translate(${_.x}, ${_.y}) rotate(${y})`})}}toggleArea(s){if(this.childNodes){const e=this.childNodes.area;e&&(e.style.display=s?"":"none")}}onMouseDown(s){this.guard(s)||(s.stopPropagation(),s.preventDefault(),this.graph.view.undelegateEvents(),this.options.documentEvents&&this.delegateDocumentEvents(this.options.documentEvents),this.focus(),this.toggleArea(this.options.restrictArea),this.cell.startBatch("move-anchor",{ui:!0,toolId:this.cid}))}resetAnchor(s){const e=this.type,t=this.cell;s?t.prop([e,"anchor"],s,{rewrite:!0,ui:!0,toolId:this.cid}):t.removeProp([e,"anchor"],{ui:!0,toolId:this.cid})}onMouseMove(s){const e=this.type,t=this.cellView,n=t.getTerminalView(e);if(n==null)return;const a=this.normalizeEvent(s),d=n.cell,m=t.getTerminalMagnet(e);let p=this.graph.coord.clientToLocalPoint(a.clientX,a.clientY);const b=this.options.snap;if(typeof b=="function"){const O=l.FunctionExt.call(b,t,p,n,m,e,t,this);p=c.Point.create(O)}if(this.options.restrictArea)if(n.isEdgeElement(m)){const O=n.getClosestPoint(p);O&&(p=O)}else{const O=n.getUnrotatedBBoxOfElement(m),x=d.getAngle(),C=d.getBBox().getCenter(),M=p.clone().rotate(x,C);O.containsPoint(M)||(p=O.getNearestPointToPoint(M).rotate(-x,C))}let y;const _=this.options.anchor;typeof _=="function"&&(y=l.FunctionExt.call(_,t,p,n,m,e,t,this)),this.resetAnchor(y),this.update()}onMouseUp(s){this.graph.view.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);const e=this.cellView;this.options.removeRedundancies&&e.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.cell.stopBatch("move-anchor",{ui:!0,toolId:this.cid})}onDblClick(){const s=this.options.resetAnchor;s&&this.resetAnchor(s===!0?void 0:s),this.update()}}return function(g){g.config({tagName:"g",markup:[{tagName:"circle",selector:"anchor",attrs:{cursor:"pointer"}},{tagName:"rect",selector:"area",attrs:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDblClick"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},customAnchorAttrs:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttrs:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,resetAnchor:!0,restrictArea:!0,removeRedundancies:!0,anchor:h.getAnchor,snap(s,e,t,n,a,d){const m=d.options.snapRadius||0,p=n==="source",b=p?0:-1,y=this.cell.getVertexAt(b)||this.getTerminalAnchor(p?"target":"source");return y&&(Math.abs(y.x-s.x)<m&&(s.x=y.x),Math.abs(y.y-s.y)<m&&(s.y=y.y)),s}})}(u||(u={})),je.SourceAnchor=u.define({name:"source-anchor",type:"source"}),je.TargetAnchor=u.define({name:"target-anchor",type:"target"}),je}var Se={},ti;function ul(){if(ti)return Se;ti=1;var o=w&&w.__rest||function(f,h){var u={};for(var g in f)Object.prototype.hasOwnProperty.call(f,g)&&h.indexOf(g)<0&&(u[g]=f[g]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,g=Object.getOwnPropertySymbols(f);s<g.length;s++)h.indexOf(g[s])<0&&Object.prototype.propertyIsEnumerable.call(f,g[s])&&(u[g[s]]=f[g[s]]);return u};Object.defineProperty(Se,"__esModule",{value:!0}),Se.TargetArrowhead=Se.SourceArrowhead=void 0;const r=D,i=B,l=me();class c extends l.ToolsView.ToolItem{get type(){return this.options.type}get ratio(){return this.options.ratio}init(){if(this.options.attrs){const h=this.options.attrs,{class:u}=h,g=o(h,["class"]);this.setAttrs(g,this.container),u&&r.Dom.addClass(this.container,u)}}onRender(){r.Dom.addClass(this.container,this.prefixClassName(`edge-tool-${this.type}-arrowhead`)),this.update()}update(){const h=this.ratio,u=this.cellView,g=u.getTangentAtRatio(h),s=g?g.start:u.getPointAtRatio(h),e=g&&g.vector().vectorAngle(new i.Point(1,0))||0;if(!s)return this;const t=r.Dom.createSVGMatrix().translate(s.x,s.y).rotate(e);return r.Dom.transform(this.container,t,{absolute:!0}),this}onMouseDown(h){if(this.guard(h))return;h.stopPropagation(),h.preventDefault();const u=this.cellView;if(u.can("arrowheadMovable")){u.cell.startBatch("move-arrowhead",{ui:!0,toolId:this.cid});const g=this.graph.snapToGrid(h.clientX,h.clientY),s=u.prepareArrowheadDragging(this.type,{x:g.x,y:g.y,options:Object.assign(Object.assign({},this.options),{toolId:this.cid})});this.cellView.setEventData(h,s),this.delegateDocumentEvents(this.options.documentEvents,h.data),u.graph.view.undelegateEvents(),this.container.style.pointerEvents="none"}this.focus()}onMouseMove(h){const u=this.normalizeEvent(h),g=this.graph.snapToGrid(u.clientX,u.clientY);this.cellView.onMouseMove(u,g.x,g.y),this.update()}onMouseUp(h){this.undelegateDocumentEvents();const u=this.normalizeEvent(h),g=this.cellView,s=this.graph.snapToGrid(u.clientX,u.clientY);g.onMouseUp(u,s.x,s.y),this.graph.view.delegateEvents(),this.blur(),this.container.style.pointerEvents="",g.cell.stopBatch("move-arrowhead",{ui:!0,toolId:this.cid})}}return function(f){f.config({tagName:"path",isSVGElement:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}})}(c||(c={})),Se.SourceArrowhead=c.define({name:"source-arrowhead",type:"source",ratio:0,attrs:{d:"M 10 -8 -10 0 10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),Se.TargetArrowhead=c.define({name:"target-arrowhead",type:"target",ratio:1,attrs:{d:"M -10 -8 10 0 -10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),Se}var ur={},ni;function hl(){return ni||(ni=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.CellEditor=void 0;const r=B,i=D,l=me(),c=ue;class f extends l.ToolsView.ToolItem{constructor(){super(...arguments),this.labelIndex=-1,this.distance=.5,this.dblClick=this.onCellDblClick.bind(this)}onRender(){const u=this.cellView;u&&u.on("cell:dblclick",this.dblClick)}createElement(){const u=[this.prefixClassName(`${this.cell.isEdge()?"edge":"node"}-tool-editor`),this.prefixClassName("cell-tool-editor")];this.editor=l.ToolsView.createElement("div",!1),this.addClass(u,this.editor),this.editor.contentEditable="true",this.container.appendChild(this.editor)}removeElement(){this.undelegateDocumentEvents(),this.editor&&(this.container.removeChild(this.editor),this.editor=null)}updateEditor(){const{cell:u,editor:g}=this;if(!g)return;const{style:s}=g;u.isNode()?this.updateNodeEditorTransform():u.isEdge()&&this.updateEdgeEditorTransform();const{attrs:e}=this.options;s.fontSize=`${e.fontSize}px`,s.fontFamily=e.fontFamily,s.color=e.color,s.backgroundColor=e.backgroundColor;const t=this.getCellText()||"";return g.innerText=t,this.setCellText(""),this}updateNodeEditorTransform(){const{graph:u,cell:g,editor:s}=this;if(!s)return;let e=r.Point.create(),t=20,n="",{x:a,y:d}=this.options;const{width:m,height:p}=this.options;if(typeof a<"u"&&typeof d<"u"){const _=g.getBBox();a=i.NumberExt.normalizePercentage(a,_.width),d=i.NumberExt.normalizePercentage(d,_.height),e=_.topLeft.translate(a,d),t=_.width-a*2}else{const _=g.getBBox();e=_.center,t=_.width-4,n="translate(-50%, -50%)"}const b=u.scale(),{style:y}=s;e=u.localToGraph(e),y.left=`${e.x}px`,y.top=`${e.y}px`,y.transform=`scale(${b.sx}, ${b.sy}) ${n}`,y.minWidth=`${t}px`,typeof m=="number"&&(y.width=`${m}px`),typeof p=="number"&&(y.height=`${p}px`)}updateEdgeEditorTransform(){if(!this.event)return;const{graph:u,editor:g}=this;if(!g)return;let s=r.Point.create(),e=20;const{style:t}=g,n=this.event.target,a=n.parentElement;if(a&&i.Dom.hasClass(a,this.prefixClassName("edge-label"))){const p=a.getAttribute("data-index")||"0";this.labelIndex=parseInt(p,10);const b=a.getAttribute("transform"),{translation:y}=i.Dom.parseTransformString(b);s=new r.Point(y.tx,y.ty),e=c.Util.getBBox(n).width}else{if(!this.options.labelAddable)return this;s=u.clientToLocal(r.Point.create(this.event.clientX,this.event.clientY));const b=this.cellView.path.closestPointLength(s);this.distance=b,this.labelIndex=-1}s=u.localToGraph(s);const m=u.scale();t.left=`${s.x}px`,t.top=`${s.y}px`,t.minWidth=`${e}px`,t.transform=`scale(${m.sx}, ${m.sy}) translate(-50%, -50%)`}onDocumentMouseUp(u){if(this.editor&&u.target!==this.editor){const g=this.editor.innerText.replace(/\n$/,"")||"";this.setCellText(g!==""?g:null),this.removeElement()}}onCellDblClick({e:u}){this.editor||(u.stopPropagation(),this.removeElement(),this.event=u,this.createElement(),this.updateEditor(),this.autoFocus(),this.delegateDocumentEvents(this.options.documentEvents))}onMouseDown(u){u.stopPropagation()}autoFocus(){setTimeout(()=>{this.editor&&(this.editor.focus(),this.selectText())})}selectText(){if(window.getSelection&&this.editor){const u=document.createRange(),g=window.getSelection();u.selectNodeContents(this.editor),g.removeAllRanges(),g.addRange(u)}}getCellText(){const{getText:u}=this.options;if(typeof u=="function")return i.FunctionExt.call(u,this.cellView,{cell:this.cell,index:this.labelIndex});if(typeof u=="string"){if(this.cell.isNode())return this.cell.attr(u);if(this.cell.isEdge()&&this.labelIndex!==-1)return this.cell.prop(`labels/${this.labelIndex}/attrs/${u}`)}}setCellText(u){const g=this.options.setText;if(typeof g=="function"){i.FunctionExt.call(g,this.cellView,{cell:this.cell,value:u,index:this.labelIndex,distance:this.distance});return}if(typeof g=="string"){if(this.cell.isNode()){u!==null&&this.cell.attr(g,u);return}if(this.cell.isEdge()){const s=this.cell;if(this.labelIndex===-1){if(u){const e={position:{distance:this.distance},attrs:{}};i.ObjectExt.setByPath(e,`attrs/${g}`,u),s.appendLabel(e)}}else u!==null?s.prop(`labels/${this.labelIndex}/attrs/${g}`,u):typeof this.labelIndex=="number"&&s.removeLabelAt(this.labelIndex)}}}onRemove(){const u=this.cellView;u&&u.off("cell:dblclick",this.dblClick),this.removeElement()}}o.CellEditor=f,function(h){h.config({tagName:"div",isSVGElement:!1,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mouseup:"onDocumentMouseUp",touchend:"onDocumentMouseUp",touchcancel:"onDocumentMouseUp"}})}(f=o.CellEditor||(o.CellEditor={})),function(h){h.NodeEditor=h.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText:"text/text",setText:"text/text"}),h.EdgeEditor=h.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},labelAddable:!0,getText:"label/text",setText:"label/text"})}(f=o.CellEditor||(o.CellEditor={}))}(ur)),ur}var ri;function cs(){return ri||(ri=1,function(o){var r=w&&w.__rest||function(t,n){var a={};for(var d in t)Object.prototype.hasOwnProperty.call(t,d)&&n.indexOf(d)<0&&(a[d]=t[d]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var m=0,d=Object.getOwnPropertySymbols(t);m<d.length;m++)n.indexOf(d[m])<0&&Object.prototype.propertyIsEnumerable.call(t,d[m])&&(a[d[m]]=t[d[m]]);return a};Object.defineProperty(o,"__esModule",{value:!0}),o.EdgeTool=o.NodeTool=void 0;const i=z,l=me(),c=sl(),f=ol(),h=al(),u=ll(),g=cl(),s=ul(),e=hl();(function(t){t.presets={boundary:f.Boundary,button:c.Button,"button-remove":c.Button.Remove,"node-editor":e.CellEditor.NodeEditor},t.registry=i.Registry.create({type:"node tool",process(n,a){if(typeof a=="function")return a;let d=l.ToolsView.ToolItem;const{inherit:m}=a,p=r(a,["inherit"]);if(m){const b=this.get(m);b==null?this.onNotFound(m,"inherited"):d=b}return p.name==null&&(p.name=n),d.define.call(d,p)}}),t.registry.register(t.presets,!0)})(o.NodeTool||(o.NodeTool={})),function(t){t.presets={boundary:f.Boundary,vertices:h.Vertices,segments:u.Segments,button:c.Button,"button-remove":c.Button.Remove,"source-anchor":g.SourceAnchor,"target-anchor":g.TargetAnchor,"source-arrowhead":s.SourceArrowhead,"target-arrowhead":s.TargetArrowhead,"edge-editor":e.CellEditor.EdgeEditor},t.registry=i.Registry.create({type:"edge tool",process(n,a){if(typeof a=="function")return a;let d=l.ToolsView.ToolItem;const{inherit:m}=a,p=r(a,["inherit"]);if(m){const b=this.get(m);b==null?this.onNotFound(m,"inherited"):d=b}return p.name==null&&(p.name=n),d.define.call(d,p)}}),t.registry.register(t.presets,!0)}(o.EdgeTool||(o.EdgeTool={}))}(er)),er}var us={},hs={},I={};Object.defineProperty(I,"__esModule",{value:!0});I.bottomRight=I.bottomLeft=I.topRight=I.topLeft=I.right=I.left=I.bottom=I.top=I.center=void 0;const ii=D;I.center=ve("center");I.top=ve("topCenter");I.bottom=ve("bottomCenter");I.left=ve("leftMiddle");I.right=ve("rightMiddle");I.topLeft=ve("topLeft");I.topRight=ve("topRight");I.bottomLeft=ve("bottomLeft");I.bottomRight=ve("bottomRight");function ve(o){return function(r,i,l,c={}){const f=c.rotate?r.getUnrotatedBBoxOfElement(i):r.getBBoxOfElement(i),h=f[o];h.x+=ii.NumberExt.normalizePercentage(c.dx,f.width),h.y+=ii.NumberExt.normalizePercentage(c.dy,f.height);const u=r.cell;return c.rotate?h.rotate(-u.getAngle(),u.getBBox().getCenter()):h}}var an={},ye={};Object.defineProperty(ye,"__esModule",{value:!0});ye.getPointAtEdge=ye.resolve=void 0;const gl=D,fl=B;function dl(o){return function(r,i,l,c){if(l instanceof Element){const f=this.graph.findViewByElem(l);let h;if(f)if(f.isEdgeElement(l)){const u=c.fixedAt!=null?c.fixedAt:"50%";h=gs(f,u)}else h=f.getBBoxOfElement(l).getCenter();else h=new fl.Point;return o.call(this,r,i,h,c)}return o.apply(this,arguments)}}ye.resolve=dl;function gs(o,r){const i=gl.NumberExt.isPercentage(r),l=typeof r=="string"?parseFloat(r):r;return i?o.getPointAtRatio(l/100):o.getPointAtLength(l)}ye.getPointAtEdge=gs;Object.defineProperty(an,"__esModule",{value:!0});an.orth=void 0;const hr=B,pl=ye,ml=function(o,r,i,l){const c=hr.Angle.normalize(o.cell.getAngle()),f=o.getBBoxOfElement(r),h=f.getCenter(),u=f.getTopLeft(),g=f.getBottomRight();let s=l.padding;if(Number.isFinite(s)||(s=0),u.y+s<=i.y&&i.y<=g.y-s){const e=i.y-h.y;h.x+=c===0||c===180?0:e*1/Math.tan(hr.Angle.toRad(c)),h.y+=e}else if(u.x+s<=i.x&&i.x<=g.x-s){const e=i.x-h.x;h.y+=c===90||c===270?0:e*Math.tan(hr.Angle.toRad(c)),h.x+=e}return h};an.orth=(0,pl.resolve)(ml);var ln={};Object.defineProperty(ln,"__esModule",{value:!0});ln.nodeCenter=void 0;const bl=function(o,r,i,l,c){const f=o.cell.getConnectionPoint(this.cell,c);return(l.dx||l.dy)&&f.translate(l.dx||0,l.dy||0),f};ln.nodeCenter=bl;var cn={};Object.defineProperty(cn,"__esModule",{value:!0});cn.midSide=void 0;const yl=ye,vl=function(o,r,i,l){let c,f=0,h;const u=o.cell;l.rotate?(c=o.getUnrotatedBBoxOfElement(r),h=u.getBBox().getCenter(),f=u.getAngle()):c=o.getBBoxOfElement(r);const g=l.padding;g!=null&&Number.isFinite(g)&&c.inflate(g),l.rotate&&i.rotate(f,h);const s=c.getNearestSideToPoint(i);let e;switch(s){case"left":e=c.getLeftMiddle();break;case"right":e=c.getRightMiddle();break;case"top":e=c.getTopCenter();break;case"bottom":e=c.getBottomCenter();break}const t=l.direction;return t==="H"?(s==="top"||s==="bottom")&&(i.x<=c.x+c.width?e=c.getLeftMiddle():e=c.getRightMiddle()):t==="V"&&(i.y<=c.y+c.height?e=c.getTopCenter():e=c.getBottomCenter()),l.rotate?e.rotate(-f,h):e};cn.midSide=(0,yl.resolve)(vl);(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(I,o),i(an,o),i(ln,o),i(cn,o)})(hs);(function(o){var r=w&&w.__createBinding||(Object.create?function(h,u,g,s){s===void 0&&(s=g);var e=Object.getOwnPropertyDescriptor(u,g);(!e||("get"in e?!u.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return u[g]}}),Object.defineProperty(h,s,e)}:function(h,u,g,s){s===void 0&&(s=g),h[s]=u[g]}),i=w&&w.__setModuleDefault||(Object.create?function(h,u){Object.defineProperty(h,"default",{enumerable:!0,value:u})}:function(h,u){h.default=u}),l=w&&w.__importStar||function(h){if(h&&h.__esModule)return h;var u={};if(h!=null)for(var g in h)g!=="default"&&Object.prototype.hasOwnProperty.call(h,g)&&r(u,h,g);return i(u,h),u};Object.defineProperty(o,"__esModule",{value:!0}),o.NodeAnchor=void 0;const c=z,f=l(hs);(function(h){h.presets=f,h.registry=c.Registry.create({type:"node endpoint"}),h.registry.register(h.presets,!0)})(o.NodeAnchor||(o.NodeAnchor={}))})(us);var fs={},ds={},un={};Object.defineProperty(un,"__esModule",{value:!0});un.ratio=void 0;const _l=function(o,r,i,l){let c=l.ratio!=null?l.ratio:.5;return c>1&&(c/=100),o.getPointAtRatio(c)};un.ratio=_l;var hn={};Object.defineProperty(hn,"__esModule",{value:!0});hn.length=void 0;const wl=function(o,r,i,l){const c=l.length!=null?l.length:20;return o.getPointAtLength(c)};hn.length=wl;var gn={},Dr={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.closest=o.getClosestPoint=void 0;const r=B,i=ye,l=function(c,f,h,u){const g=c.getClosestPoint(h);return g!=null?g:new r.Point};o.getClosestPoint=l,o.closest=(0,i.resolve)(o.getClosestPoint)})(Dr);Object.defineProperty(gn,"__esModule",{value:!0});gn.orth=void 0;const si=B,Pl=D,ps=ye,Ol=Dr,xl=function(o,r,i,l){const f=o.getConnection(),h=o.getConnectionSubdivisions(),u=new si.Line(i.clone().translate(0,1e6),i.clone().translate(0,-1e6)),g=new si.Line(i.clone().translate(1e6,0),i.clone().translate(-1e6,0)),s=u.intersect(f,{segmentSubdivisions:h}),e=g.intersect(f,{segmentSubdivisions:h}),t=[];return s&&t.push(...s),e&&t.push(...e),t.length>0?i.closest(t):l.fallbackAt!=null?(0,ps.getPointAtEdge)(o,l.fallbackAt):Pl.FunctionExt.call(Ol.getClosestPoint,this,o,r,i,l)};gn.orth=(0,ps.resolve)(xl);(function(o){var r=w&&w.__createBinding||(Object.create?function(c,f,h,u){u===void 0&&(u=h);var g=Object.getOwnPropertyDescriptor(f,h);(!g||("get"in g?!f.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return f[h]}}),Object.defineProperty(c,u,g)}:function(c,f,h,u){u===void 0&&(u=h),c[u]=f[h]}),i=w&&w.__exportStar||function(c,f){for(var h in c)h!=="default"&&!Object.prototype.hasOwnProperty.call(f,h)&&r(f,c,h)};Object.defineProperty(o,"__esModule",{value:!0}),o.closest=void 0,i(un,o),i(hn,o),i(gn,o);var l=Dr;Object.defineProperty(o,"closest",{enumerable:!0,get:function(){return l.closest}})})(ds);(function(o){var r=w&&w.__createBinding||(Object.create?function(h,u,g,s){s===void 0&&(s=g);var e=Object.getOwnPropertyDescriptor(u,g);(!e||("get"in e?!u.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return u[g]}}),Object.defineProperty(h,s,e)}:function(h,u,g,s){s===void 0&&(s=g),h[s]=u[g]}),i=w&&w.__setModuleDefault||(Object.create?function(h,u){Object.defineProperty(h,"default",{enumerable:!0,value:u})}:function(h,u){h.default=u}),l=w&&w.__importStar||function(h){if(h&&h.__esModule)return h;var u={};if(h!=null)for(var g in h)g!=="default"&&Object.prototype.hasOwnProperty.call(h,g)&&r(u,h,g);return i(u,h),u};Object.defineProperty(o,"__esModule",{value:!0}),o.EdgeAnchor=void 0;const c=z,f=l(ds);(function(h){h.presets=f,h.registry=c.Registry.create({type:"edge endpoint"}),h.registry.register(h.presets,!0)})(o.EdgeAnchor||(o.EdgeAnchor={}))})(fs);var ms={},bs={},tt={},oe={};Object.defineProperty(oe,"__esModule",{value:!0});oe.findShapeNode=oe.getStrokeWidth=oe.offset=void 0;const Cl=B;function Ml(o,r,i){let l;if(typeof i=="object"){if(Number.isFinite(i.y)){const f=new Cl.Line(r,o),{start:h,end:u}=f.parallel(i.y);r=h,o=u}l=i.x}else l=i;if(l==null||!Number.isFinite(l))return o;const c=o.distance(r);return l===0&&c>0?o:o.move(r,-Math.min(l,c-1))}oe.offset=Ml;function El(o){const r=o.getAttribute("stroke-width");return r===null?0:parseFloat(r)||0}oe.getStrokeWidth=El;function jl(o){if(o==null)return null;let r=o;do{let i=r.tagName;if(typeof i!="string")return null;if(i=i.toUpperCase(),i==="G")r=r.firstElementChild;else if(i==="TITLE")r=r.nextElementSibling;else break}while(r);return r}oe.findShapeNode=jl;Object.defineProperty(tt,"__esModule",{value:!0});tt.bbox=void 0;const oi=oe,Sl=function(o,r,i,l){const c=r.getBBoxOfElement(i);l.stroked&&c.inflate((0,oi.getStrokeWidth)(i)/2);const f=o.intersect(c),h=f&&f.length?o.start.closest(f):o.end;return(0,oi.offset)(h,o.start,l.offset)};tt.bbox=Sl;var fn={};Object.defineProperty(fn,"__esModule",{value:!0});fn.rect=void 0;const Al=D,Dl=tt,ai=oe,Tl=function(o,r,i,l,c){const f=r.cell,h=f.isNode()?f.getAngle():0;if(h===0)return Al.FunctionExt.call(Dl.bbox,this,o,r,i,l,c);const u=r.getUnrotatedBBoxOfElement(i);l.stroked&&u.inflate((0,ai.getStrokeWidth)(i)/2);const g=u.getCenter(),s=o.clone().rotate(h,g),e=s.setLength(1e6).intersect(u),t=e&&e.length?s.start.closest(e).rotate(-h,g):o.end;return(0,ai.offset)(t,o.start,l.offset)};fn.rect=Tl;var dn={};Object.defineProperty(dn,"__esModule",{value:!0});dn.boundary=void 0;const gr=D,fr=B,ut=oe,li=ue,Bl=function(o,r,i,l){let c,f;const h=o.end,u=l.selector;if(typeof u=="string"?c=r.findOne(u):Array.isArray(u)?c=gr.ObjectExt.getByPath(i,u):c=(0,ut.findShapeNode)(i),!gr.Dom.isSVGGraphicsElement(c)){if(c===i||!gr.Dom.isSVGGraphicsElement(i))return h;c=i}const g=r.getShapeOfElement(c),s=r.getMatrixOfElement(c),e=r.getRootTranslatedMatrix(),t=r.getRootRotatedMatrix(),n=e.multiply(t).multiply(s),a=n.inverse(),d=li.Util.transformLine(o,a),m=d.start.clone(),p=r.getDataOfElement(c);if(l.insideout===!1){p.shapeBBox==null&&(p.shapeBBox=g.bbox());const O=p.shapeBBox;if(O!=null&&O.containsPoint(m))return h}l.extrapolate===!0&&d.setLength(1e6);let b;if(fr.Path.isPath(g)){const O=l.precision||2;p.segmentSubdivisions==null&&(p.segmentSubdivisions=g.getSegmentSubdivisions({precision:O})),b={precision:O,segmentSubdivisions:p.segmentSubdivisions},f=d.intersect(g,b)}else f=d.intersect(g);f?Array.isArray(f)&&(f=m.closest(f)):l.sticky===!0&&(fr.Rectangle.isRectangle(g)?f=g.getNearestPointToPoint(m):fr.Ellipse.isEllipse(g)?f=g.intersectsWithLineFromCenterToPoint(m):f=g.closestPoint(m,b));const y=f?li.Util.transformPoint(f,n):h;let _=l.offset||0;return l.stroked!==!1&&(typeof _=="object"?(_=Object.assign({},_),_.x==null&&(_.x=0),_.x+=(0,ut.getStrokeWidth)(c)/2):_+=(0,ut.getStrokeWidth)(c)/2),(0,ut.offset)(y,o.start,_)};dn.boundary=Bl;var pn={};Object.defineProperty(pn,"__esModule",{value:!0});pn.anchor=void 0;const Nl=oe;function Rl(o,r,i=0){const{start:l,end:c}=o;let f,h,u,g;switch(r){case"left":g="x",f=c,h=l,u=-1;break;case"right":g="x",f=l,h=c,u=1;break;case"top":g="y",f=c,h=l,u=-1;break;case"bottom":g="y",f=l,h=c,u=1;break;default:return}l[g]<c[g]?f[g]=h[g]:h[g]=f[g],Number.isFinite(i)&&(f[g]+=u*i,h[g]+=u*i)}const $l=function(o,r,i,l){const{alignOffset:c,align:f}=l;return f&&Rl(o,f,c),(0,Nl.offset)(o.end,o.start,l.offset)};pn.anchor=$l;(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(tt,o),i(fn,o),i(dn,o),i(pn,o)})(bs);(function(o){var r=w&&w.__createBinding||(Object.create?function(h,u,g,s){s===void 0&&(s=g);var e=Object.getOwnPropertyDescriptor(u,g);(!e||("get"in e?!u.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return u[g]}}),Object.defineProperty(h,s,e)}:function(h,u,g,s){s===void 0&&(s=g),h[s]=u[g]}),i=w&&w.__setModuleDefault||(Object.create?function(h,u){Object.defineProperty(h,"default",{enumerable:!0,value:u})}:function(h,u){h.default=u}),l=w&&w.__importStar||function(h){if(h&&h.__esModule)return h;var u={};if(h!=null)for(var g in h)g!=="default"&&Object.prototype.hasOwnProperty.call(h,g)&&r(u,h,g);return i(u,h),u};Object.defineProperty(o,"__esModule",{value:!0}),o.ConnectionPoint=void 0;const c=z,f=l(bs);(function(h){h.presets=f,h.registry=c.Registry.create({type:"connection point"}),h.registry.register(h.presets,!0)})(o.ConnectionPoint||(o.ConnectionPoint={}))})(ms);var ys={},vs={},mn={};Object.defineProperty(mn,"__esModule",{value:!0});mn.normal=void 0;const Vl=function(o){return[...o]};mn.normal=Vl;var bn={};Object.defineProperty(bn,"__esModule",{value:!0});bn.oneSide=void 0;const Ll=D,Il=function(o,r,i){const l=r.side||"bottom",c=Ll.NumberExt.normalizeSides(r.padding||40),f=i.sourceBBox,h=i.targetBBox,u=f.getCenter(),g=h.getCenter();let s,e,t;switch(l){case"top":t=-1,s="y",e="height";break;case"left":t=-1,s="x",e="width";break;case"right":t=1,s="x",e="width";break;case"bottom":default:t=1,s="y",e="height";break}return u[s]+=t*(f[e]/2+c[l]),g[s]+=t*(h[e]/2+c[l]),t*(u[s]-g[s])>0?g[s]=u[s]:u[s]=g[s],[u.toJSON(),...o,g.toJSON()]};bn.oneSide=Il;var nt={},Y={};Object.defineProperty(Y,"__esModule",{value:!0});Y.getTargetAnchor=Y.getSourceAnchor=Y.getTargetBBox=Y.getSourceBBox=Y.getPaddingBox=Y.getPointBBox=void 0;const zl=D,Fl=B;function Gl(o){return new Fl.Rectangle(o.x,o.y,0,0)}Y.getPointBBox=Gl;function Tr(o={}){const r=zl.NumberExt.normalizeSides(o.padding||20);return{x:-r.left,y:-r.top,width:r.left+r.right,height:r.top+r.bottom}}Y.getPaddingBox=Tr;function _s(o,r={}){return o.sourceBBox.clone().moveAndExpand(Tr(r))}Y.getSourceBBox=_s;function ws(o,r={}){return o.targetBBox.clone().moveAndExpand(Tr(r))}Y.getTargetBBox=ws;function kl(o,r={}){return o.sourceAnchor?o.sourceAnchor:_s(o,r).getCenter()}Y.getSourceAnchor=kl;function Hl(o,r={}){return o.targetAnchor?o.targetAnchor:ws(o,r).getCenter()}Y.getTargetAnchor=Hl;var Ul=w&&w.__createBinding||(Object.create?function(o,r,i,l){l===void 0&&(l=i);var c=Object.getOwnPropertyDescriptor(r,i);(!c||("get"in c?!r.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return r[i]}}),Object.defineProperty(o,l,c)}:function(o,r,i,l){l===void 0&&(l=i),o[l]=r[i]}),ql=w&&w.__setModuleDefault||(Object.create?function(o,r){Object.defineProperty(o,"default",{enumerable:!0,value:r})}:function(o,r){o.default=r}),Wl=w&&w.__importStar||function(o){if(o&&o.__esModule)return o;var r={};if(o!=null)for(var i in o)i!=="default"&&Object.prototype.hasOwnProperty.call(o,i)&&Ul(r,o,i);return ql(r,o),r};Object.defineProperty(nt,"__esModule",{value:!0});nt.orth=void 0;const Xl=D,J=B,he=Wl(Y),Jl=function(o,r,i){let l=he.getSourceBBox(i,r),c=he.getTargetBBox(i,r);const f=he.getSourceAnchor(i,r),h=he.getTargetAnchor(i,r);l=l.union(he.getPointBBox(f)),c=c.union(he.getPointBBox(h));const u=o.map(e=>J.Point.create(e));u.unshift(f),u.push(h);let g=null;const s=[];for(let e=0,t=u.length-1;e<t;e+=1){let n=null;const a=u[e],d=u[e+1],m=te.getBearing(a,d)!=null;if(e===0)e+1===t?l.intersectsWithRect(c.clone().inflate(1))?n=te.insideNode(a,d,l,c):m||(n=te.nodeToNode(a,d,l,c)):l.containsPoint(d)?n=te.insideNode(a,d,l,he.getPointBBox(d).moveAndExpand(he.getPaddingBox(r))):m||(n=te.nodeToVertex(a,d,l));else if(e+1===t){const p=m&&te.getBearing(d,a)===g;c.containsPoint(a)||p?n=te.insideNode(a,d,he.getPointBBox(a).moveAndExpand(he.getPaddingBox(r)),c,g):m||(n=te.vertexToNode(a,d,c,g))}else m||(n=te.vertexToVertex(a,d,g));n?(s.push(...n.points),g=n.direction):g=te.getBearing(a,d),e+1<t&&s.push(d)}return s};nt.orth=Jl;var te;(function(o){const r={N:"S",S:"N",E:"W",W:"E"},i={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function l(t,n,a){let d=new J.Point(t.x,n.y);return a.containsPoint(d)&&(d=new J.Point(n.x,t.y)),d}function c(t,n){return t[n==="W"||n==="E"?"width":"height"]}o.getBBoxSize=c;function f(t,n){return t.x===n.x?t.y>n.y?"N":"S":t.y===n.y?t.x>n.x?"W":"E":null}o.getBearing=f;function h(t,n,a){const d=new J.Point(t.x,n.y),m=new J.Point(n.x,t.y),p=f(t,d),b=f(t,m),y=a?r[a]:null,_=p===a||p!==y&&(b===y||b!==a)?d:m;return{points:[_],direction:f(_,n)}}o.vertexToVertex=h;function u(t,n,a){const d=l(t,n,a);return{points:[d],direction:f(d,n)}}o.nodeToVertex=u;function g(t,n,a,d){const m=[new J.Point(t.x,n.y),new J.Point(n.x,t.y)],p=m.filter(_=>!a.containsPoint(_)),b=p.filter(_=>f(_,t)!==d);let y;if(b.length>0)return y=b.filter(_=>f(t,_)===d).pop(),y=y||b[0],{points:[y],direction:f(y,n)};{y=Xl.ArrayExt.difference(m,p)[0];const _=J.Point.create(n).move(y,-c(a,d)/2);return{points:[l(_,t,a),_],direction:f(_,n)}}}o.vertexToNode=g;function s(t,n,a,d){let m=u(n,t,d);const p=m.points[0];if(a.containsPoint(p)){m=u(t,n,a);const b=m.points[0];if(d.containsPoint(b)){const y=J.Point.create(t).move(b,-c(a,f(t,b))/2),_=J.Point.create(n).move(p,-c(d,f(n,p))/2),O=new J.Line(y,_).getCenter(),x=u(t,O,a),C=h(O,n,x.direction);m.points=[x.points[0],C.points[0]],m.direction=C.direction}}return m}o.nodeToNode=s;function e(t,n,a,d,m){const p=a.union(d).inflate(1),b=p.getCenter(),y=b.distance(n)>b.distance(t),_=y?n:t,O=y?t:n;let x,C,M;m?(x=J.Point.fromPolar(p.width+p.height,i[m],_),x=p.getNearestPointToPoint(x).move(x,-1)):x=p.getNearestPointToPoint(_).move(_,1),C=l(x,O,p);let A;x.round().equals(C.round())?(C=J.Point.fromPolar(p.width+p.height,J.Angle.toRad(x.theta(_))+Math.PI/2,O),C=p.getNearestPointToPoint(C).move(O,1).round(),M=l(x,C,p),A=y?[C,M,x]:[x,M,C]):A=y?[C,x]:[x,C];const j=f(y?x:C,n);return{points:A,direction:j}}o.insideNode=e})(te||(te={}));var yn={},pe={};Object.defineProperty(pe,"__esModule",{value:!0});pe.resolveOptions=pe.resolve=pe.defaults=void 0;const Yl=D,dr=B,Kl=nt;pe.defaults={step:10,maxLoopCount:2e3,precision:1,maxDirectionChange:90,perpendicular:!0,excludeTerminals:[],excludeNodes:[],excludeShapes:[],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost(){return De(this.step,this)},directions(){const o=De(this.step,this),r=De(this.cost,this);return[{cost:r,offsetX:o,offsetY:0},{cost:r,offsetX:-o,offsetY:0},{cost:r,offsetX:0,offsetY:o},{cost:r,offsetX:0,offsetY:-o}]},penalties(){const o=De(this.step,this);return{0:0,45:o/2,90:o/2}},paddingBox(){const o=De(this.step,this);return{x:-o,y:-o,width:2*o,height:2*o}},fallbackRouter:Kl.orth,draggingRouter:null,snapToGrid:!0};function De(o,r){return typeof o=="function"?o.call(r):o}pe.resolve=De;function Zl(o){const r=Object.keys(o).reduce((i,l)=>{const c=i;return l==="fallbackRouter"||l==="draggingRouter"||l==="fallbackRoute"?c[l]=o[l]:c[l]=De(o[l],o),i},{});if(r.padding){const i=Yl.NumberExt.normalizeSides(r.padding);r.paddingBox={x:-i.left,y:-i.top,width:i.left+i.right,height:i.top+i.bottom}}return r.directions.forEach(i=>{const l=new dr.Point(0,0),c=new dr.Point(i.offsetX,i.offsetY);i.angle=dr.Angle.normalize(l.theta(c))}),r}pe.resolveOptions=Zl;var rt={},vn={},_n={};Object.defineProperty(_n,"__esModule",{value:!0});_n.SortedSet=void 0;const Ql=D,ci=1,ui=2;class ec{constructor(){this.items=[],this.hash={},this.values={}}add(r,i){this.hash[r]?this.items.splice(this.items.indexOf(r),1):this.hash[r]=ci,this.values[r]=i;const l=Ql.ArrayExt.sortedIndexBy(this.items,r,c=>this.values[c]);this.items.splice(l,0,r)}pop(){const r=this.items.shift();return r&&(this.hash[r]=ui),r}isOpen(r){return this.hash[r]===ci}isClose(r){return this.hash[r]===ui}isEmpty(){return this.items.length===0}}_n.SortedSet=ec;var wn={};Object.defineProperty(wn,"__esModule",{value:!0});wn.ObstacleMap=void 0;const hi=D,tc=B;class nc{constructor(r){this.options=r,this.mapGridSize=100,this.map={}}build(r,i){const l=this.options,c=l.excludeTerminals.reduce((s,e)=>{const t=i[e];if(t){const n=r.getCell(t.cell);n&&s.push(n)}return s},[]);let f=[];const h=r.getCell(i.getSourceCellId());h&&(f=hi.ArrayExt.union(f,h.getAncestors().map(s=>s.id)));const u=r.getCell(i.getTargetCellId());u&&(f=hi.ArrayExt.union(f,u.getAncestors().map(s=>s.id)));const g=this.mapGridSize;return r.getNodes().reduce((s,e)=>{const t=c.some(p=>p.id===e.id),n=e.shape?l.excludeShapes.includes(e.shape):!1,a=l.excludeNodes.some(p=>typeof p=="string"?e.id===p:p===e),d=f.includes(e.id),m=n||t||a||d;if(e.isVisible()&&!m){const p=e.getBBox().moveAndExpand(l.paddingBox),b=p.getOrigin().snapToGrid(g),y=p.getCorner().snapToGrid(g);for(let _=b.x;_<=y.x;_+=g)for(let O=b.y;O<=y.y;O+=g){const x=new tc.Point(_,O).toString();s[x]==null&&(s[x]=[]),s[x].push(p)}}return s},this.map),this}isAccessible(r){const i=r.clone().snapToGrid(this.mapGridSize).toString(),l=this.map[i];return l?l.every(c=>!c.containsPoint(r)):!0}}wn.ObstacleMap=nc;var N={};Object.defineProperty(N,"__esModule",{value:!0});N.reconstructRoute=N.getRectPoints=N.getCost=N.normalizePoint=N.getKey=N.align=N.round=N.getGrid=N.getGridOffsets=N.getDirectionChange=N.getDirectionAngle=N.getTargetEndpoint=N.getSourceEndpoint=N.getTargetBBox=N.getSourceBBox=void 0;const Me=B;function Ps(o,r){const i=o.sourceBBox.clone();return r&&r.paddingBox?i.moveAndExpand(r.paddingBox):i}N.getSourceBBox=Ps;function Os(o,r){const i=o.targetBBox.clone();return r&&r.paddingBox?i.moveAndExpand(r.paddingBox):i}N.getTargetBBox=Os;function rc(o,r){return o.sourceAnchor?o.sourceAnchor:Ps(o,r).getCenter()}N.getSourceEndpoint=rc;function ic(o,r){return o.targetAnchor?o.targetAnchor:Os(o,r).getCenter()}N.getTargetEndpoint=ic;function sc(o,r,i,l,c){const f=360/i,h=o.theta(oc(o,r,l,c)),u=Me.Angle.normalize(h+f/2);return f*Math.floor(u/f)}N.getDirectionAngle=sc;function oc(o,r,i,l){const c=l.step,f=r.x-o.x,h=r.y-o.y,u=f/i.x,g=h/i.y,s=u*c,e=g*c;return new Me.Point(o.x+s,o.y+e)}function ac(o,r){const i=Math.abs(o-r);return i>180?360-i:i}N.getDirectionChange=ac;function lc(o,r){const i=r.step;return r.directions.forEach(l=>{l.gridOffsetX=l.offsetX/i*o.x,l.gridOffsetY=l.offsetY/i*o.y}),r.directions}N.getGridOffsets=lc;function cc(o,r,i){return{source:r.clone(),x:gi(i.x-r.x,o),y:gi(i.y-r.y,o)}}N.getGrid=cc;function gi(o,r){if(!o)return r;const i=Math.abs(o),l=Math.round(i/r);if(!l)return i;const c=l*r,h=(i-c)/l;return r+h}function uc(o,r){const i=r.source,l=Me.GeometryUtil.snapToGrid(o.x-i.x,r.x)+i.x,c=Me.GeometryUtil.snapToGrid(o.y-i.y,r.y)+i.y;return new Me.Point(l,c)}function xs(o,r){return o.round(r)}N.round=xs;function mt(o,r,i){return xs(uc(o.clone(),r),i)}N.align=mt;function Pr(o){return o.toString()}N.getKey=Pr;function bt(o){return new Me.Point(o.x===0?0:Math.abs(o.x)/o.x,o.y===0?0:Math.abs(o.y)/o.y)}N.normalizePoint=bt;function hc(o,r){let i=1/0;for(let l=0,c=r.length;l<c;l+=1){const f=o.manhattanDistance(r[l]);f<i&&(i=f)}return i}N.getCost=hc;function gc(o,r,i,l,c){const f=c.precision,h=c.directionMap,u=o.diff(r.getCenter()),g=Object.keys(h).reduce((s,e)=>{if(i.includes(e)){const t=h[e],n=new Me.Point(o.x+t.x*(Math.abs(u.x)+r.width),o.y+t.y*(Math.abs(u.y)+r.height)),d=new Me.Line(o,n).intersect(r)||[];let m,p=null;for(let b=0;b<d.length;b+=1){const y=d[b],_=o.squaredDistance(y);(m==null||_>m)&&(m=_,p=y)}if(p){let b=mt(p,l,f);r.containsPoint(b)&&(b=mt(b.translate(t.x*l.x,t.y*l.y),l,f)),s.push(b)}}return s},[]);return r.containsPoint(o)||g.push(mt(o,l,f)),g}N.getRectPoints=gc;function fc(o,r,i,l,c){const f=[];let h=bt(c.diff(i)),u=Pr(i),g=o[u],s;for(;g;){s=r[u];const n=bt(s.diff(g));n.equals(h)||(f.unshift(s),h=n),u=Pr(g),g=o[u]}const e=r[u];return bt(e.diff(l)).equals(h)||f.unshift(e),f}N.reconstructRoute=fc;var dc=w&&w.__createBinding||(Object.create?function(o,r,i,l){l===void 0&&(l=i);var c=Object.getOwnPropertyDescriptor(r,i);(!c||("get"in c?!r.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return r[i]}}),Object.defineProperty(o,l,c)}:function(o,r,i,l){l===void 0&&(l=i),o[l]=r[i]}),pc=w&&w.__setModuleDefault||(Object.create?function(o,r){Object.defineProperty(o,"default",{enumerable:!0,value:r})}:function(o,r){o.default=r}),mc=w&&w.__importStar||function(o){if(o&&o.__esModule)return o;var r={};if(o!=null)for(var i in o)i!=="default"&&Object.prototype.hasOwnProperty.call(o,i)&&dc(r,o,i);return pc(r,o),r};Object.defineProperty(vn,"__esModule",{value:!0});vn.router=void 0;const Or=D,Ve=B,bc=_n,yc=wn,$=mc(N),vc=pe;function _c(o,r,i,l,c){const f=c.precision;let h,u;Ve.Rectangle.isRectangle(r)?h=$.round($.getSourceEndpoint(o,c).clone(),f):h=$.round(r.clone(),f),Ve.Rectangle.isRectangle(i)?u=$.round($.getTargetEndpoint(o,c).clone(),f):u=$.round(i.clone(),f);const g=$.getGrid(c.step,h,u),s=h,e=u;let t,n;if(Ve.Rectangle.isRectangle(r)?t=$.getRectPoints(s,r,c.startDirections,g,c):t=[s],Ve.Rectangle.isRectangle(i)?n=$.getRectPoints(u,i,c.endDirections,g,c):n=[e],t=t.filter(a=>l.isAccessible(a)),n=n.filter(a=>l.isAccessible(a)),t.length>0&&n.length>0){const a=new bc.SortedSet,d={},m={},p={};for(let v=0,P=t.length;v<P;v+=1){const E=t[v],S=$.getKey(E);a.add(S,$.getCost(E,n)),d[S]=E,p[S]=0}const b=c.previousDirectionAngle,y=b===void 0;let _,O;const x=$.getGridOffsets(g,c),C=x.length,M=n.reduce((v,P)=>{const E=$.getKey(P);return v.push(E),v},[]),A=Ve.Point.equalPoints(t,n);let j=c.maxLoopCount;for(;!a.isEmpty()&&j>0;){const v=a.pop(),P=d[v],E=m[v],S=p[v],T=P.equals(s),R=E==null;let L;if(R?y?T?L=null:L=$.getDirectionAngle(s,P,C,g,c):L=b:L=$.getDirectionAngle(E,P,C,g,c),!(R&&A)&&M.indexOf(v)>=0)return c.previousDirectionAngle=L,$.reconstructRoute(m,d,P,s,e);for(let ie=0;ie<C;ie+=1){_=x[ie];const Q=_.angle;if(O=$.getDirectionChange(L,Q),!(y&&T)&&O>c.maxDirectionChange)continue;const X=$.align(P.clone().translate(_.gridOffsetX||0,_.gridOffsetY||0),g,f),G=$.getKey(X);if(a.isClose(G)||!l.isAccessible(X))continue;if(M.indexOf(G)>=0&&!X.equals(e)){const to=$.getDirectionAngle(X,e,C,g,c);if($.getDirectionChange(Q,to)>c.maxDirectionChange)continue}const Qs=_.cost,eo=T?0:c.penalties[O],Kn=S+Qs+eo;(!a.isOpen(G)||Kn<p[G])&&(d[G]=X,m[G]=P,p[G]=Kn,a.add(G,Kn+$.getCost(X,n)))}j-=1}}return c.fallbackRoute?Or.FunctionExt.call(c.fallbackRoute,this,s,e,c):null}function wc(o,r=10){if(o.length<=1)return o;for(let i=0,l=o.length;i<l-1;i+=1){const c=o[i],f=o[i+1];if(c.x===f.x){const h=r*Math.round(c.x/r);c.x!==h&&(c.x=h,f.x=h)}else if(c.y===f.y){const h=r*Math.round(c.y/r);c.y!==h&&(c.y=h,f.y=h)}}return o}const Pc=function(o,r,i){const l=(0,vc.resolveOptions)(r),c=$.getSourceBBox(i,l),f=$.getTargetBBox(i,l),h=$.getSourceEndpoint(i,l),u=new yc.ObstacleMap(l).build(i.graph.model,i.cell),g=o.map(a=>Ve.Point.create(a)),s=[];let e=h,t,n;for(let a=0,d=g.length;a<=d;a+=1){let m=null;if(t=n||c,n=g[a],n==null){n=f;const b=i.cell;if((b.getSourceCellId()==null||b.getTargetCellId()==null)&&typeof l.draggingRouter=="function"){const _=t===c?h:t,O=n.getOrigin();m=Or.FunctionExt.call(l.draggingRouter,i,_,O,l)}}if(m==null&&(m=_c(i,t,n,u,l)),m===null)return console.warn("Unable to execute manhattan algorithm, use orth instead"),Or.FunctionExt.call(l.fallbackRouter,this,o,l,i);const p=m[0];p&&p.equals(e)&&m.shift(),e=m[m.length-1]||e,s.push(...m)}return l.snapToGrid?wc(s,i.graph.grid.getGridSize()):s};vn.router=Pc;Object.defineProperty(rt,"__esModule",{value:!0});rt.manhattan=void 0;const Oc=D,xc=vn,Cc=pe,Mc=function(o,r,i){return Oc.FunctionExt.call(xc.router,this,o,Object.assign(Object.assign({},Cc.defaults),r),i)};rt.manhattan=Mc;Object.defineProperty(yn,"__esModule",{value:!0});yn.metro=void 0;const Ec=D,qe=B,fi=pe,jc=rt,Sc={maxDirectionChange:45,directions(){const o=(0,fi.resolve)(this.step,this),r=(0,fi.resolve)(this.cost,this),i=Math.ceil(Math.sqrt(o*o<<1));return[{cost:r,offsetX:o,offsetY:0},{cost:i,offsetX:o,offsetY:o},{cost:r,offsetX:0,offsetY:o},{cost:i,offsetX:-o,offsetY:o},{cost:r,offsetX:-o,offsetY:0},{cost:i,offsetX:-o,offsetY:-o},{cost:r,offsetX:0,offsetY:-o},{cost:i,offsetX:o,offsetY:-o}]},fallbackRoute(o,r,i){const l=o.theta(r),c=[];let f={x:r.x,y:o.y},h={x:o.x,y:r.y};if(l%180>90){const _=f;f=h,h=_}const u=l%90<45?f:h,g=new qe.Line(o,u),s=90*Math.ceil(l/90),e=qe.Point.fromPolar(g.squaredLength(),qe.Angle.toRad(s+135),u),t=new qe.Line(r,e),n=g.intersectsWithLine(t),a=n||r,d=n?a:o,m=360/i.directions.length,p=d.theta(r),b=qe.Angle.normalize(p+m/2),y=m*Math.floor(b/m);return i.previousDirectionAngle=y,a&&c.push(a.round()),c.push(r),c}},Ac=function(o,r,i){return Ec.FunctionExt.call(jc.manhattan,this,o,Object.assign(Object.assign({},Sc),r),i)};yn.metro=Ac;var Pn={};Object.defineProperty(Pn,"__esModule",{value:!0});Pn.er=void 0;const Dc=function(o,r,i){const l=r.offset||32,c=r.min==null?16:r.min;let f=0,h=r.direction;const u=i.sourceBBox,g=i.targetBBox,s=u.getCenter(),e=g.getCenter();if(typeof l=="number"&&(f=l),h==null){let b=g.left-u.right,y=g.top-u.bottom;b>=0&&y>=0?h=b>=y?"L":"T":b<=0&&y>=0?(b=u.left-g.right,b>=0?h=b>=y?"R":"T":h="T"):b>=0&&y<=0?(y=u.top-g.bottom,y>=0?h=b>=y?"L":"B":h="L"):(b=u.left-g.right,y=u.top-g.bottom,b>=0&&y>=0?h=b>=y?"R":"B":b<=0&&y>=0?h="B":b>=0&&y<=0?h="R":h=Math.abs(b)>Math.abs(y)?"R":"B")}h==="H"?h=e.x-s.x>=0?"L":"R":h==="V"&&(h=e.y-s.y>=0?"T":"B"),l==="center"&&(h==="L"?f=(g.left-u.right)/2:h==="R"?f=(u.left-g.right)/2:h==="T"?f=(g.top-u.bottom)/2:h==="B"&&(f=(u.top-g.bottom)/2));let t,n,a;const d=h==="L"||h==="R";if(d){if(e.y===s.y)return[...o];a=h==="L"?1:-1,t="x",n="width"}else{if(e.x===s.x)return[...o];a=h==="T"?1:-1,t="y",n="height"}const m=s.clone(),p=e.clone();if(m[t]+=a*(u[n]/2+f),p[t]-=a*(g[n]/2+f),d){const b=m.x,y=p.x,_=u.width/2+c,O=g.width/2+c;e.x>s.x?y<=b&&(m.x=Math.max(y,s.x+_),p.x=Math.min(b,e.x-O)):y>=b&&(m.x=Math.min(y,s.x-_),p.x=Math.max(b,e.x+O))}else{const b=m.y,y=p.y,_=u.height/2+c,O=g.height/2+c;e.y>s.y?y<=b&&(m.y=Math.max(y,s.y+_),p.y=Math.min(b,e.y-O)):y>=b&&(m.y=Math.min(y,s.y-_),p.y=Math.max(b,e.y+O))}return[m.toJSON(),...o,p.toJSON()]};Pn.er=Dc;var On={};Object.defineProperty(On,"__esModule",{value:!0});On.loop=void 0;const se=B;function Re(o,r){if(r!=null&&r!==!1){const i=typeof r=="boolean"?0:r;if(i>0){const l=se.Point.create(o[1]).move(o[2],i),c=se.Point.create(o[1]).move(o[0],i);return[l.toJSON(),...o,c.toJSON()]}{const l=o[1];return[Object.assign({},l),...o,Object.assign({},l)]}}return o}const Tc=function(o,r,i){const l=r.width||50,f=(r.height||80)/2,h=r.angle||"auto",u=i.sourceAnchor,g=i.targetAnchor,s=i.sourceBBox,e=i.targetBBox;if(u.equals(g)){const t=b=>{const y=se.Angle.toRad(b),_=Math.sin(y),O=Math.cos(y),x=new se.Point(u.x+O*l,u.y+_*l),C=new se.Point(x.x-O*f,x.y-_*f),M=C.clone().rotate(-90,x),A=C.clone().rotate(90,x);return[M.toJSON(),x.toJSON(),A.toJSON()]},n=b=>{const y=u.clone().move(b,-1),_=new se.Line(y,b);return!s.containsPoint(b)&&!s.intersectsWithLine(_)},a=[0,90,180,270,45,135,225,315];if(typeof h=="number")return Re(t(h),r.merge);const d=s.getCenter();if(d.equals(u))return Re(t(0),r.merge);const m=d.angleBetween(u,d.clone().translate(1,0));let p=t(m);if(n(p[1]))return Re(p,r.merge);for(let b=1,y=a.length;b<y;b+=1)if(p=t(m+a[b]),n(p[1]))return Re(p,r.merge);return Re(p,r.merge)}{const t=new se.Line(u,g);let n=t.parallel(-l),a=n.getCenter(),d=n.start.clone().move(n.end,f),m=n.end.clone().move(n.start,f);const p=t.parallel(-1),b=new se.Line(p.start,a),y=new se.Line(p.end,a);if((s.containsPoint(a)||e.containsPoint(a)||s.intersectsWithLine(b)||s.intersectsWithLine(y)||e.intersectsWithLine(b)||e.intersectsWithLine(y))&&(n=t.parallel(l),a=n.getCenter(),d=n.start.clone().move(n.end,f),m=n.end.clone().move(n.start,f)),r.merge){const _=new se.Line(u,g),O=new se.Line(a,_.center).setLength(Number.MAX_SAFE_INTEGER),x=s.intersectsWithLine(O),C=e.intersectsWithLine(O),M=x?Array.isArray(x)?x:[x]:[];C&&(Array.isArray(C)?M.push(...C):M.push(C));const A=_.center.closest(M);A?(i.sourceAnchor=A.clone(),i.targetAnchor=A.clone()):(i.sourceAnchor=_.center.clone(),i.targetAnchor=_.center.clone())}return Re([d.toJSON(),a.toJSON(),m.toJSON()],r.merge)}};On.loop=Tc;(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(mn,o),i(bn,o),i(nt,o),i(yn,o),i(rt,o),i(Pn,o),i(On,o)})(vs);(function(o){var r=w&&w.__createBinding||(Object.create?function(h,u,g,s){s===void 0&&(s=g);var e=Object.getOwnPropertyDescriptor(u,g);(!e||("get"in e?!u.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return u[g]}}),Object.defineProperty(h,s,e)}:function(h,u,g,s){s===void 0&&(s=g),h[s]=u[g]}),i=w&&w.__setModuleDefault||(Object.create?function(h,u){Object.defineProperty(h,"default",{enumerable:!0,value:u})}:function(h,u){h.default=u}),l=w&&w.__importStar||function(h){if(h&&h.__esModule)return h;var u={};if(h!=null)for(var g in h)g!=="default"&&Object.prototype.hasOwnProperty.call(h,g)&&r(u,h,g);return i(u,h),u};Object.defineProperty(o,"__esModule",{value:!0}),o.Router=void 0;const c=z,f=l(vs);(function(h){h.presets=f,h.registry=c.Registry.create({type:"router"}),h.registry.register(h.presets,!0)})(o.Router||(o.Router={}))})(ys);var Cs={},Ms={},xn={};Object.defineProperty(xn,"__esModule",{value:!0});xn.normal=void 0;const di=B,Bc=function(o,r,i,l={}){const c=[o,...i,r],f=new di.Polyline(c),h=new di.Path(f);return l.raw?h:h.serialize()};xn.normal=Bc;var Cn={};Object.defineProperty(Cn,"__esModule",{value:!0});Cn.loop=void 0;const Ae=B,Nc=function(o,r,i,l={}){const c=i.length===3?0:1,f=Ae.Point.create(i[0+c]),h=Ae.Point.create(i[2+c]),u=Ae.Point.create(i[1+c]);if(!Ae.Point.equals(o,r)){const s=new Ae.Point((o.x+r.x)/2,(o.y+r.y)/2),e=s.angleBetween(Ae.Point.create(o).rotate(90,s),u);e>1&&(f.rotate(180-e,s),h.rotate(180-e,s),u.rotate(180-e,s))}const g=`
     M ${o.x} ${o.y}
     Q ${f.x} ${f.y} ${u.x} ${u.y}
     Q ${h.x} ${h.y} ${r.x} ${r.y}
  `;return l.raw?Ae.Path.parse(g):g};Cn.loop=Nc;var Mn={};Object.defineProperty(Mn,"__esModule",{value:!0});Mn.rounded=void 0;const we=B,Rc=function(o,r,i,l={}){const c=new we.Path;c.appendSegment(we.Path.createSegment("M",o));const f=1/3,h=2/3,u=l.radius||10;let g,s;for(let e=0,t=i.length;e<t;e+=1){const n=we.Point.create(i[e]),a=i[e-1]||o,d=i[e+1]||r;g=s||n.distance(a)/2,s=n.distance(d)/2;const m=-Math.min(u,g),p=-Math.min(u,s),b=n.clone().move(a,m).round(),y=n.clone().move(d,p).round(),_=new we.Point(f*b.x+h*n.x,h*n.y+f*b.y),O=new we.Point(f*y.x+h*n.x,h*n.y+f*y.y);c.appendSegment(we.Path.createSegment("L",b)),c.appendSegment(we.Path.createSegment("C",_,O,y))}return c.appendSegment(we.Path.createSegment("L",r)),l.raw?c:c.serialize()};Mn.rounded=Rc;var En={};Object.defineProperty(En,"__esModule",{value:!0});En.smooth=void 0;const $e=B,$c=function(o,r,i,l={}){let c,f=l.direction;if(i&&i.length!==0){const h=[o,...i,r],u=$e.Curve.throughPoints(h);c=new $e.Path(u)}else if(c=new $e.Path,c.appendSegment($e.Path.createSegment("M",o)),f||(f=Math.abs(o.x-r.x)>=Math.abs(o.y-r.y)?"H":"V"),f==="H"){const h=(o.x+r.x)/2;c.appendSegment($e.Path.createSegment("C",h,o.y,h,r.y,r.x,r.y))}else{const h=(o.y+r.y)/2;c.appendSegment($e.Path.createSegment("C",o.x,h,r.x,h,r.x,r.y))}return l.raw?c:c.serialize()};En.smooth=$c;var jn={};Object.defineProperty(jn,"__esModule",{value:!0});jn.jumpover=void 0;const V=B,pi=1,ht=1/3,gt=2/3;function Vc(o){let r=o.graph._jumpOverUpdateList;if(r==null&&(r=o.graph._jumpOverUpdateList=[],o.graph.on("cell:mouseup",()=>{const i=o.graph._jumpOverUpdateList;setTimeout(()=>{for(let l=0;l<i.length;l+=1)i[l].update()})}),o.graph.on("model:reseted",()=>{r=o.graph._jumpOverUpdateList=[]})),r.indexOf(o)<0){r.push(o);const i=()=>r.splice(r.indexOf(o),1);o.cell.once("change:connector",i),o.cell.once("removed",i)}}function pr(o,r,i=[]){const l=[o,...i,r],c=[];return l.forEach((f,h)=>{const u=l[h+1];u!=null&&c.push(new V.Line(f,u))}),c}function Lc(o,r){const i=[];return r.forEach(l=>{const c=o.intersectsWithLine(l);c&&i.push(c)}),i}function mi(o,r){return new V.Line(o,r).squaredLength()}function Ic(o,r,i){return r.reduce((l,c,f)=>{if(yt.includes(c))return l;const h=l.pop()||o,u=V.Point.create(c).move(h.start,-i);let g=V.Point.create(c).move(h.start,+i);const s=r[f+1];if(s!=null){const n=g.distance(s);n<=i&&(g=s.move(h.start,n),yt.push(s))}else if(u.distance(h.end)<i*2+pi)return l.push(h),l;if(g.distance(h.start)<i*2+pi)return l.push(h),l;const t=new V.Line(u,g);return Ye.push(t),l.push(new V.Line(h.start,u),t,new V.Line(g,h.end)),l},[])}function bi(o,r,i,l){const c=new V.Path;let f;return f=V.Path.createSegment("M",o[0].start),c.appendSegment(f),o.forEach((h,u)=>{if(Ye.includes(h)){let g,s,e,t;if(i==="arc"){g=-90,s=h.start.diff(h.end),(s.x<0||s.x===0&&s.y<0)&&(g+=180);const a=h.getCenter(),d=new V.Line(a,h.end).rotate(g,a);let m;m=new V.Line(h.start,a),e=m.pointAt(2/3).rotate(g,h.start),t=d.pointAt(1/3).rotate(-g,d.end),f=V.Path.createSegment("C",e,t,d.end),c.appendSegment(f),m=new V.Line(a,h.end),e=d.pointAt(1/3).rotate(g,d.end),t=m.pointAt(1/3).rotate(-g,h.end),f=V.Path.createSegment("C",e,t,h.end),c.appendSegment(f)}else if(i==="gap")f=V.Path.createSegment("M",h.end),c.appendSegment(f);else if(i==="cubic"){g=h.start.theta(h.end);const n=r*.6;let a=r*1.35;s=h.start.diff(h.end),(s.x<0||s.x===0&&s.y<0)&&(a*=-1),e=new V.Point(h.start.x+n,h.start.y+a).rotate(g,h.start),t=new V.Point(h.end.x-n,h.end.y+a).rotate(g,h.end),f=V.Path.createSegment("C",e,t,h.end),c.appendSegment(f)}}else{const g=o[u+1];l===0||!g||Ye.includes(g)?(f=V.Path.createSegment("L",h.end),c.appendSegment(f)):zc(l,c,h.end,h.start,g.end)}}),c}function zc(o,r,i,l,c){const f=i.distance(l)/2,h=i.distance(c)/2,u=-Math.min(o,f),g=-Math.min(o,h),s=i.clone().move(l,u).round(),e=i.clone().move(c,g).round(),t=new V.Point(ht*s.x+gt*i.x,gt*i.y+ht*s.y),n=new V.Point(ht*e.x+gt*i.x,gt*i.y+ht*e.y);let a;a=V.Path.createSegment("L",s),r.appendSegment(a),a=V.Path.createSegment("C",t,n,e),r.appendSegment(a)}let Ye,yt;const Fc=function(o,r,i,l={}){Ye=[],yt=[],Vc(this);const c=l.size||5,f=l.type||"arc",h=l.radius||0,u=l.ignoreConnectors||["smooth"],g=this.graph,e=g.model.getEdges();if(e.length===1)return bi(pr(o,r,i),c,f,h);const t=this.cell,n=e.indexOf(t),a=g.options.connecting.connector||{},d=e.filter((O,x)=>{const C=O.getConnector()||a;return u.includes(C.name)?!1:x>n?C.name!=="jumpover":!0}),m=d.map(O=>g.findViewByCell(O)),p=pr(o,r,i),b=m.map(O=>O==null?[]:O===this?p:pr(O.sourcePoint,O.targetPoint,O.routePoints)),y=[];p.forEach(O=>{const x=d.reduce((C,M,A)=>{if(M!==t){const j=Lc(O,b[A]);C.push(...j)}return C},[]).sort((C,M)=>mi(O.start,C)-mi(O.start,M));x.length>0?y.push(...Ic(O,x,c)):y.push(O)});const _=bi(y,c,f,h);return Ye=[],yt=[],l.raw?_:_.serialize()};jn.jumpover=Fc;(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(xn,o),i(Cn,o),i(Mn,o),i(En,o),i(jn,o)})(Ms);(function(o){var r=w&&w.__createBinding||(Object.create?function(h,u,g,s){s===void 0&&(s=g);var e=Object.getOwnPropertyDescriptor(u,g);(!e||("get"in e?!u.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return u[g]}}),Object.defineProperty(h,s,e)}:function(h,u,g,s){s===void 0&&(s=g),h[s]=u[g]}),i=w&&w.__setModuleDefault||(Object.create?function(h,u){Object.defineProperty(h,"default",{enumerable:!0,value:u})}:function(h,u){h.default=u}),l=w&&w.__importStar||function(h){if(h&&h.__esModule)return h;var u={};if(h!=null)for(var g in h)g!=="default"&&Object.prototype.hasOwnProperty.call(h,g)&&r(u,h,g);return i(u,h),u};Object.defineProperty(o,"__esModule",{value:!0}),o.Connector=void 0;const c=z,f=l(Ms);(function(h){h.presets=f,h.registry=c.Registry.create({type:"connector"}),h.registry.register(h.presets,!0)})(o.Connector||(o.Connector={}))})(Cs);(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(Bi,o),i(Ri,o),i(Vi,o),i(Er,o),i(Xi,o),i(Yi,o),i(Qi,o),i(cs(),o),i(jr,o),i(us,o),i(fs,o),i(ms,o),i(ys,o),i(Cs,o),i(z,o)})(ae);var Sn={},Gc=w&&w.__decorate||function(o,r,i,l){var c=arguments.length,f=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,i):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,r,i,l);else for(var u=o.length-1;u>=0;u--)(h=o[u])&&(f=(c<3?h(f):c>3?h(r,i,f):h(r,i))||f);return c>3&&f&&Object.defineProperty(r,i,f),f};Object.defineProperty(Sn,"__esModule",{value:!0});Sn.Store=void 0;const F=D;class Es extends F.Basecoat{constructor(r={}){super(),this.pending=!1,this.changing=!1,this.data={},this.mutate(F.ObjectExt.cloneDeep(r)),this.changed={}}mutate(r,i={}){const l=i.unset===!0,c=i.silent===!0,f=[],h=this.changing;this.changing=!0,h||(this.previous=F.ObjectExt.cloneDeep(this.data),this.changed={});const u=this.data,g=this.previous,s=this.changed;if(Object.keys(r).forEach(e=>{const t=e,n=r[t];F.ObjectExt.isEqual(u[t],n)||f.push(t),F.ObjectExt.isEqual(g[t],n)?delete s[t]:s[t]=n,l?delete u[t]:u[t]=n}),!c&&f.length>0&&(this.pending=!0,this.pendingOptions=i,f.forEach(e=>{this.emit("change:*",{key:e,options:i,store:this,current:u[e],previous:g[e]})})),h)return this;if(!c)for(;this.pending;)this.pending=!1,this.emit("changed",{current:u,previous:g,store:this,options:this.pendingOptions});return this.pending=!1,this.changing=!1,this.pendingOptions=null,this}get(r,i){if(r==null)return this.data;const l=this.data[r];return l==null?i:l}getPrevious(r){if(this.previous){const i=this.previous[r];return i==null?void 0:i}}set(r,i,l){return r!=null&&(typeof r=="object"?this.mutate(r,i):this.mutate({[r]:i},l)),this}remove(r,i){const c={};let f;if(typeof r=="string")c[r]=void 0,f=i;else if(Array.isArray(r))r.forEach(h=>c[h]=void 0),f=i;else{for(const h in this.data)c[h]=void 0;f=r}return this.mutate(c,Object.assign(Object.assign({},f),{unset:!0})),this}getByPath(r){return F.ObjectExt.getByPath(this.data,r,"/")}setByPath(r,i,l={}){const c="/",f=Array.isArray(r)?[...r]:r.split(c),h=Array.isArray(r)?r.join(c):r,u=f[0],g=f.length;if(l.propertyPath=h,l.propertyValue=i,l.propertyPathArray=f,g===1)this.set(u,i,l);else{const s={};let e=s,t=u;for(let d=1;d<g;d+=1){const m=f[d],p=Number.isFinite(Number(m));e=e[t]=p?[]:{},t=m}F.ObjectExt.setByPath(s,f,i,c);const n=F.ObjectExt.cloneDeep(this.data);l.rewrite&&F.ObjectExt.unsetByPath(n,r,c);const a=F.ObjectExt.merge(n,s);this.set(u,a[u],l)}return this}removeByPath(r,i){const l=Array.isArray(r)?r:r.split("/"),c=l[0];if(l.length===1)this.remove(c,i);else{const f=l.slice(1),h=F.ObjectExt.cloneDeep(this.get(c));h&&F.ObjectExt.unsetByPath(h,f),this.set(c,h,i)}return this}hasChanged(r){return r==null?Object.keys(this.changed).length>0:r in this.changed}getChanges(r){if(r==null)return this.hasChanged()?F.ObjectExt.cloneDeep(this.changed):null;const i=this.changing?this.previous:this.data,l={};let c;for(const f in r){const h=r[f];F.ObjectExt.isEqual(i[f],h)||(l[f]=h,c=!0)}return c?F.ObjectExt.cloneDeep(l):null}toJSON(){return F.ObjectExt.cloneDeep(this.data)}clone(){const r=this.constructor;return new r(this.data)}dispose(){this.off(),this.data={},this.previous={},this.changed={},this.pending=!1,this.changing=!1,this.pendingOptions=null,this.trigger("disposed",{store:this})}}Gc([F.Basecoat.dispose()],Es.prototype,"dispose",null);Sn.Store=Es;var js={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.Animation=void 0;const r=D;class i{constructor(c){this.cell=c,this.ids={},this.cache={}}get(){return Object.keys(this.ids)}start(c,f,h={},u="/"){const g=this.cell.getPropByPath(c),s=r.ObjectExt.defaults(h,i.defaultOptions),e=this.getTiming(s.timing),t=this.getInterp(s.interp,g,f);let n=0;const a=Array.isArray(c)?c.join(u):c,d=Array.isArray(c)?c:c.split(u),m=()=>{const p=new Date().getTime();n===0&&(n=p);let y=(p-n)/s.duration;y<1?this.ids[a]=requestAnimationFrame(m):y=1;const _=t(e(y));this.cell.setPropByPath(d,_),h.progress&&h.progress(Object.assign({progress:y,currentValue:_},this.getArgs(a))),y===1&&(this.cell.notify("transition:complete",this.getArgs(a)),h.complete&&h.complete(this.getArgs(a)),this.cell.notify("transition:finish",this.getArgs(a)),h.finish&&h.finish(this.getArgs(a)),this.clean(a))};return setTimeout(()=>{this.stop(c,void 0,u),this.cache[a]={startValue:g,targetValue:f,options:s},this.ids[a]=requestAnimationFrame(m),this.cell.notify("transition:start",this.getArgs(a)),h.start&&h.start(this.getArgs(a))},h.delay),this.stop.bind(this,c,u,h)}stop(c,f={},h="/"){const u=Array.isArray(c)?c:c.split(h);return Object.keys(this.ids).filter(g=>r.ObjectExt.isEqual(u,g.split(h).slice(0,u.length))).forEach(g=>{cancelAnimationFrame(this.ids[g]);const s=this.cache[g],e=this.getArgs(g),t=Object.assign(Object.assign({},s.options),f),n=t.jumpedToEnd;n&&s.targetValue!=null&&(this.cell.setPropByPath(g,s.targetValue),this.cell.notify("transition:end",Object.assign({},e)),this.cell.notify("transition:complete",Object.assign({},e)),t.complete&&t.complete(Object.assign({},e)));const a=Object.assign({jumpedToEnd:n},e);this.cell.notify("transition:stop",Object.assign({},a)),t.stop&&t.stop(Object.assign({},a)),this.cell.notify("transition:finish",Object.assign({},e)),t.finish&&t.finish(Object.assign({},e)),this.clean(g)}),this}clean(c){delete this.ids[c],delete this.cache[c]}getTiming(c){return typeof c=="string"?r.Timing[c]:c}getInterp(c,f,h){return c?c(f,h):typeof h=="number"?r.Interp.number(f,h):typeof h=="string"?h[0]==="#"?r.Interp.color(f,h):r.Interp.unit(f,h):r.Interp.object(f,h)}getArgs(c){const f=this.cache[c];return{path:c,startValue:f.startValue,targetValue:f.targetValue,cell:this.cell}}}o.Animation=i,function(l){l.defaultOptions={delay:10,duration:100,timing:"linear"}}(i=o.Animation||(o.Animation={}))})(js);(function(o){var r=w&&w.__decorate||function(s,e,t,n){var a=arguments.length,d=a<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(s,e,t,n);else for(var p=s.length-1;p>=0;p--)(m=s[p])&&(d=(a<3?m(d):a>3?m(e,t,d):m(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d},i=w&&w.__rest||function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(t[n[a]]=s[n[a]]);return t};Object.defineProperty(o,"__esModule",{value:!0}),o.Cell=void 0;const l=D,c=B,f=ae,h=Sn,u=js;class g extends l.Basecoat{static config(e){const{markup:t,propHooks:n,attrHooks:a}=e,d=i(e,["markup","propHooks","attrHooks"]);t!=null&&(this.markup=t),n&&(this.propHooks=this.propHooks.slice(),Array.isArray(n)?this.propHooks.push(...n):typeof n=="function"?this.propHooks.push(n):Object.values(n).forEach(m=>{typeof m=="function"&&this.propHooks.push(m)})),a&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),a)),this.defaults=l.ObjectExt.merge({},this.defaults,d)}static getMarkup(){return this.markup}static getDefaults(e){return e?this.defaults:l.ObjectExt.cloneDeep(this.defaults)}static getAttrHooks(){return this.attrHooks}static applyPropHooks(e,t){return this.propHooks.reduce((n,a)=>a?l.FunctionExt.call(a,e,n):n,t)}get[Symbol.toStringTag](){return g.toStringTag}constructor(e={}){super();const n=this.constructor.getDefaults(!0),a=l.ObjectExt.merge({},this.preprocess(n),this.preprocess(e));this.id=a.id||l.StringExt.uuid(),this.store=new h.Store(a),this.animation=new u.Animation(this),this.setup(),this.init(),this.postprocess(e)}init(){}get model(){return this._model}set model(e){this._model!==e&&(this._model=e)}preprocess(e,t){const n=e.id,d=this.constructor.applyPropHooks(this,e);return n==null&&t!==!0&&(d.id=l.StringExt.uuid()),d}postprocess(e){}setup(){this.store.on("change:*",e=>{const{key:t,current:n,previous:a,options:d}=e;this.notify("change:*",{key:t,options:d,current:n,previous:a,cell:this}),this.notify(`change:${t}`,{options:d,current:n,previous:a,cell:this});const m=t;(m==="source"||m==="target")&&this.notify("change:terminal",{type:m,current:n,previous:a,options:d,cell:this})}),this.store.on("changed",({options:e})=>this.notify("changed",{options:e,cell:this}))}notify(e,t){this.trigger(e,t);const n=this.model;return n&&(n.notify(`cell:${e}`,t),this.isNode()?n.notify(`node:${e}`,Object.assign(Object.assign({},t),{node:this})):this.isEdge()&&n.notify(`edge:${e}`,Object.assign(Object.assign({},t),{edge:this}))),this}isNode(){return!1}isEdge(){return!1}isSameStore(e){return this.store===e.store}get view(){return this.store.get("view")}get shape(){return this.store.get("shape","")}getProp(e,t){return e==null?this.store.get():this.store.get(e,t)}setProp(e,t,n){if(typeof e=="string")this.store.set(e,t,n);else{const a=this.preprocess(e,!0);this.store.set(l.ObjectExt.merge({},this.getProp(),a),t),this.postprocess(e)}return this}removeProp(e,t){return typeof e=="string"||Array.isArray(e)?this.store.removeByPath(e,t):this.store.remove(t),this}hasChanged(e){return e==null?this.store.hasChanged():this.store.hasChanged(e)}getPropByPath(e){return this.store.getByPath(e)}setPropByPath(e,t,n={}){return this.model&&(e==="children"?this._children=t?t.map(a=>this.model.getCell(a)).filter(a=>a!=null):null:e==="parent"&&(this._parent=t?this.model.getCell(t):null)),this.store.setByPath(e,t,n),this}removePropByPath(e,t={}){const n=Array.isArray(e)?e:e.split("/");return n[0]==="attrs"&&(t.dirty=!0),this.store.removeByPath(n,t),this}prop(e,t,n){return e==null?this.getProp():typeof e=="string"||Array.isArray(e)?arguments.length===1?this.getPropByPath(e):t==null?this.removePropByPath(e,n||{}):this.setPropByPath(e,t,n||{}):this.setProp(e,t||{})}previous(e){return this.store.getPrevious(e)}get zIndex(){return this.getZIndex()}set zIndex(e){e==null?this.removeZIndex():this.setZIndex(e)}getZIndex(){return this.store.get("zIndex")}setZIndex(e,t={}){return this.store.set("zIndex",e,t),this}removeZIndex(e={}){return this.store.remove("zIndex",e),this}toFront(e={}){const t=this.model;if(t){let n=t.getMaxZIndex(),a;e.deep?(a=this.getDescendants({deep:!0,breadthFirst:!0}),a.unshift(this)):a=[this],n=n-a.length+1;const d=t.total();let m=t.indexOf(this)!==d-a.length;m||(m=a.some((p,b)=>p.getZIndex()!==n+b)),m&&this.batchUpdate("to-front",()=>{n+=a.length,a.forEach((p,b)=>{p.setZIndex(n+b,e)})})}return this}toBack(e={}){const t=this.model;if(t){let n=t.getMinZIndex(),a;e.deep?(a=this.getDescendants({deep:!0,breadthFirst:!0}),a.unshift(this)):a=[this];let d=t.indexOf(this)!==0;d||(d=a.some((m,p)=>m.getZIndex()!==n+p)),d&&this.batchUpdate("to-back",()=>{n-=a.length,a.forEach((m,p)=>{m.setZIndex(n+p,e)})})}return this}get markup(){return this.getMarkup()}set markup(e){e==null?this.removeMarkup():this.setMarkup(e)}getMarkup(){let e=this.store.get("markup");return e==null&&(e=this.constructor.getMarkup()),e}setMarkup(e,t={}){return this.store.set("markup",e,t),this}removeMarkup(e={}){return this.store.remove("markup",e),this}get attrs(){return this.getAttrs()}set attrs(e){e==null?this.removeAttrs():this.setAttrs(e)}getAttrs(){const e=this.store.get("attrs");return e?Object.assign({},e):{}}setAttrs(e,t={}){if(e==null)this.removeAttrs(t);else{const n=a=>this.store.set("attrs",a,t);if(t.overwrite===!0)n(e);else{const a=this.getAttrs();t.deep===!1?n(Object.assign(Object.assign({},a),e)):n(l.ObjectExt.merge({},a,e))}}return this}replaceAttrs(e,t={}){return this.setAttrs(e,Object.assign(Object.assign({},t),{overwrite:!0}))}updateAttrs(e,t={}){return this.setAttrs(e,Object.assign(Object.assign({},t),{deep:!1}))}removeAttrs(e={}){return this.store.remove("attrs",e),this}getAttrDefinition(e){if(!e)return null;const n=this.constructor.getAttrHooks()||{};let a=n[e]||f.Attr.registry.get(e);if(!a){const d=l.StringExt.camelCase(e);a=n[d]||f.Attr.registry.get(d)}return a||null}getAttrByPath(e){return e==null||e===""?this.getAttrs():this.getPropByPath(this.prefixAttrPath(e))}setAttrByPath(e,t,n={}){return this.setPropByPath(this.prefixAttrPath(e),t,n),this}removeAttrByPath(e,t={}){return this.removePropByPath(this.prefixAttrPath(e),t),this}prefixAttrPath(e){return Array.isArray(e)?["attrs"].concat(e):`attrs/${e}`}attr(e,t,n){return e==null?this.getAttrByPath():typeof e=="string"||Array.isArray(e)?arguments.length===1?this.getAttrByPath(e):t==null?this.removeAttrByPath(e,n||{}):this.setAttrByPath(e,t,n||{}):this.setAttrs(e,t||{})}get visible(){return this.isVisible()}set visible(e){this.setVisible(e)}setVisible(e,t={}){return this.store.set("visible",e,t),this}isVisible(){return this.store.get("visible")!==!1}show(e={}){return this.isVisible()||this.setVisible(!0,e),this}hide(e={}){return this.isVisible()&&this.setVisible(!1,e),this}toggleVisible(e,t={}){const n=typeof e=="boolean"?e:!this.isVisible(),a=typeof e=="boolean"?t:e;return n?this.show(a):this.hide(a),this}get data(){return this.getData()}set data(e){this.setData(e)}getData(){return this.store.get("data")}setData(e,t={}){if(e==null)this.removeData(t);else{const n=a=>this.store.set("data",a,t);if(t.overwrite===!0)n(e);else{const a=this.getData();t.deep===!1?n(typeof e=="object"?Object.assign(Object.assign({},a),e):e):n(l.ObjectExt.merge({},a,e))}}return this}replaceData(e,t={}){return this.setData(e,Object.assign(Object.assign({},t),{overwrite:!0}))}updateData(e,t={}){return this.setData(e,Object.assign(Object.assign({},t),{deep:!1}))}removeData(e={}){return this.store.remove("data",e),this}get parent(){return this.getParent()}get children(){return this.getChildren()}getParentId(){return this.store.get("parent")}getParent(){const e=this.getParentId();if(e&&this.model){const t=this.model.getCell(e);return this._parent=t,t}return null}getChildren(){const e=this.store.get("children");if(e&&e.length&&this.model){const t=e.map(n=>{var a;return(a=this.model)===null||a===void 0?void 0:a.getCell(n)}).filter(n=>n!=null);return this._children=t,[...t]}return null}hasParent(){return this.parent!=null}isParentOf(e){return e!=null&&e.getParent()===this}isChildOf(e){return e!=null&&this.getParent()===e}eachChild(e,t){return this.children&&this.children.forEach(e,t),this}filterChild(e,t){return this.children?this.children.filter(e,t):[]}getChildCount(){return this.children==null?0:this.children.length}getChildIndex(e){return this.children==null?-1:this.children.indexOf(e)}getChildAt(e){return this.children!=null&&e>=0?this.children[e]:null}getAncestors(e={}){const t=[];let n=this.getParent();for(;n;)t.push(n),n=e.deep!==!1?n.getParent():null;return t}getDescendants(e={}){if(e.deep!==!1){if(e.breadthFirst){const t=[],n=this.getChildren()||[];for(;n.length>0;){const a=n.shift(),d=a.getChildren();t.push(a),d&&n.push(...d)}return t}{const t=this.getChildren()||[];return t.forEach(n=>{t.push(...n.getDescendants(e))}),t}}return this.getChildren()||[]}isDescendantOf(e,t={}){if(e==null)return!1;if(t.deep!==!1){let n=this.getParent();for(;n;){if(n===e)return!0;n=n.getParent()}return!1}return this.isChildOf(e)}isAncestorOf(e,t={}){return e==null?!1:e.isDescendantOf(this,t)}contains(e){return this.isAncestorOf(e)}getCommonAncestor(...e){return g.getCommonAncestor(this,...e)}setParent(e,t={}){return this._parent=e,e?this.store.set("parent",e.id,t):this.store.remove("parent",t),this}setChildren(e,t={}){return this._children=e,e!=null?this.store.set("children",e.map(n=>n.id),t):this.store.remove("children",t),this}unembed(e,t={}){const n=this.children;if(n!=null&&e!=null){const a=this.getChildIndex(e);a!==-1&&(n.splice(a,1),e.setParent(null,t),this.setChildren(n,t))}return this}embed(e,t={}){return e.addTo(this,t),this}addTo(e,t={}){return g.isCell(e)?e.addChild(this,t):e.addCell(this,t),this}insertTo(e,t,n={}){return e.insertChild(this,t,n),this}addChild(e,t={}){return this.insertChild(e,void 0,t)}insertChild(e,t,n={}){if(e!=null&&e!==this){const a=e.getParent(),d=this!==a;let m=t;if(m==null&&(m=this.getChildCount(),d||(m-=1)),a){const b=a.getChildren();if(b){const y=b.indexOf(e);y>=0&&(e.setParent(null,n),b.splice(y,1),a.setChildren(b,n))}}let p=this.children;if(p==null?(p=[],p.push(e)):p.splice(m,0,e),e.setParent(this,n),this.setChildren(p,n),d&&this.model){const b=this.model.getIncomingEdges(this),y=this.model.getOutgoingEdges(this);b&&b.forEach(_=>_.updateParent(n)),y&&y.forEach(_=>_.updateParent(n))}this.model&&this.model.addCell(e,n)}return this}removeFromParent(e={}){const t=this.getParent();if(t!=null){const n=t.getChildIndex(this);t.removeChildAt(n,e)}return this}removeChild(e,t={}){const n=this.getChildIndex(e);return this.removeChildAt(n,t)}removeChildAt(e,t={}){const n=this.getChildAt(e);return this.children!=null&&n!=null&&(this.unembed(n,t),n.remove(t)),n}remove(e={}){return this.batchUpdate("remove",()=>{const t=this.getParent();t&&t.removeChild(this,e),e.deep!==!1&&this.eachChild(n=>n.remove(e)),this.model&&this.model.removeCell(this,e)}),this}transition(e,t,n={},a="/"){return this.animation.start(e,t,n,a)}stopTransition(e,t,n="/"){return this.animation.stop(e,t,n),this}getTransitions(){return this.animation.get()}translate(e,t,n){return this}scale(e,t,n,a){return this}addTools(e,t,n){const a=Array.isArray(e)?e:[e],d=typeof t=="string"?t:null,m=typeof t=="object"?t:typeof n=="object"?n:{};if(m.reset)return this.setTools({name:d,items:a,local:m.local},m);let p=l.ObjectExt.cloneDeep(this.getTools());if(p==null||d==null||p.name===d)return p==null&&(p={}),p.items||(p.items=[]),p.name=d,p.items=[...p.items,...a],this.setTools(Object.assign({},p),m)}setTools(e,t={}){return e==null?this.removeTools():this.store.set("tools",g.normalizeTools(e),t),this}getTools(){return this.store.get("tools")}removeTools(e={}){return this.store.remove("tools",e),this}hasTools(e){const t=this.getTools();return t==null?!1:e==null?!0:t.name===e}hasTool(e){const t=this.getTools();return t==null?!1:t.items.some(n=>typeof n=="string"?n===e:n.name===e)}removeTool(e,t={}){const n=l.ObjectExt.cloneDeep(this.getTools());if(n){let a=!1;const d=n.items.slice(),m=p=>{d.splice(p,1),a=!0};if(typeof e=="number")m(e);else for(let p=d.length-1;p>=0;p-=1){const b=d[p];(typeof b=="string"?b===e:b.name===e)&&m(p)}a&&(n.items=d,this.setTools(n,t))}return this}getBBox(e){return new c.Rectangle}getConnectionPoint(e,t){return new c.Point}toJSON(e={}){const t=Object.assign({},this.store.get()),n=Object.prototype.toString,a=this.isNode()?"node":this.isEdge()?"edge":"cell";if(!t.shape){const M=this.constructor;throw new Error(`Unable to serialize ${a} missing "shape" prop, check the ${a} "${M.name||n.call(M)}"`)}const d=this.constructor,m=e.diff===!0,p=t.attrs||{},b=d.getDefaults(!0),y=m?this.preprocess(b,!0):b,_=y.attrs||{},O={};Object.entries(t).forEach(([M,A])=>{if(A!=null&&!Array.isArray(A)&&typeof A=="object"&&!l.ObjectExt.isPlainObject(A))throw new Error(`Can only serialize ${a} with plain-object props, but got a "${n.call(A)}" type of key "${M}" on ${a} "${this.id}"`);if(M!=="attrs"&&M!=="shape"&&m){const j=y[M];l.ObjectExt.isEqual(A,j)&&delete t[M]}}),Object.keys(p).forEach(M=>{const A=p[M],j=_[M];Object.keys(A).forEach(v=>{const P=A[v],E=j?j[v]:null;P!=null&&typeof P=="object"&&!Array.isArray(P)?Object.keys(P).forEach(S=>{const T=P[S];if(j==null||E==null||!l.ObjectExt.isObject(E)||!l.ObjectExt.isEqual(E[S],T)){O[M]==null&&(O[M]={}),O[M][v]==null&&(O[M][v]={});const R=O[M][v];R[S]=T}}):(j==null||!l.ObjectExt.isEqual(E,P))&&(O[M]==null&&(O[M]={}),O[M][v]=P)})});const x=Object.assign(Object.assign({},t),{attrs:l.ObjectExt.isEmpty(O)?void 0:O});x.attrs==null&&delete x.attrs;const C=x;return C.angle===0&&delete C.angle,l.ObjectExt.cloneDeep(C)}clone(e={}){if(!e.deep){const n=Object.assign({},this.store.get());e.keepId||delete n.id,delete n.parent,delete n.children;const a=this.constructor;return new a(n)}return g.deepClone(this)[this.id]}findView(e){return e.findViewByCell(this)}startBatch(e,t={},n=this.model){return this.notify("batch:start",{name:e,data:t,cell:this}),n&&n.startBatch(e,Object.assign(Object.assign({},t),{cell:this})),this}stopBatch(e,t={},n=this.model){return n&&n.stopBatch(e,Object.assign(Object.assign({},t),{cell:this})),this.notify("batch:stop",{name:e,data:t,cell:this}),this}batchUpdate(e,t,n){const a=this.model;this.startBatch(e,n,a);const d=t();return this.stopBatch(e,n,a),d}dispose(){this.removeFromParent(),this.store.dispose()}}g.defaults={},g.attrHooks={},g.propHooks=[],r([l.Basecoat.dispose()],g.prototype,"dispose",null),o.Cell=g,function(s){function e(t){return typeof t=="string"?{items:[t]}:Array.isArray(t)?{items:t}:t.items?t:{items:[t]}}s.normalizeTools=e}(g=o.Cell||(o.Cell={})),function(s){s.toStringTag=`X6.${s.name}`;function e(t){if(t==null)return!1;if(t instanceof s)return!0;const n=t[Symbol.toStringTag],a=t;return(n==null||n===s.toStringTag)&&typeof a.isNode=="function"&&typeof a.isEdge=="function"&&typeof a.prop=="function"&&typeof a.attr=="function"}s.isCell=e}(g=o.Cell||(o.Cell={})),function(s){function e(...d){const m=d.filter(b=>b!=null).map(b=>b.getAncestors()).sort((b,y)=>b.length-y.length);return m.shift().find(b=>m.every(y=>y.includes(b)))||null}s.getCommonAncestor=e;function t(d,m={}){let p=null;for(let b=0,y=d.length;b<y;b+=1){const _=d[b];let O=_.getBBox(m);if(O){if(_.isNode()){const x=_.getAngle();x!=null&&x!==0&&(O=O.bbox(x))}p=p==null?O:p.union(O)}}return p}s.getCellsBBox=t;function n(d){const m=[d,...d.getDescendants({deep:!0})];return s.cloneCells(m)}s.deepClone=n;function a(d){const m=l.ArrayExt.uniq(d),p=m.reduce((b,y)=>(b[y.id]=y.clone(),b),{});return m.forEach(b=>{const y=p[b.id];if(y.isEdge()){const x=y.getSourceCellId(),C=y.getTargetCellId();x&&p[x]&&y.setSource(Object.assign(Object.assign({},y.getSource()),{cell:p[x].id})),C&&p[C]&&y.setTarget(Object.assign(Object.assign({},y.getTarget()),{cell:p[C].id}))}const _=b.getParent();_&&p[_.id]&&y.setParent(p[_.id]);const O=b.getChildren();if(O&&O.length){const x=O.reduce((C,M)=>(p[M.id]&&C.push(p[M.id]),C),[]);x.length>0&&y.setChildren(x)}}),p}s.cloneCells=a}(g=o.Cell||(o.Cell={})),function(s){s.config({propHooks(e){var{tools:t}=e,n=i(e,["tools"]);return t&&(n.tools=s.normalizeTools(t)),n}})}(g=o.Cell||(o.Cell={}))})(ke);var An={},Br={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.ShareRegistry=void 0,function(r){let i,l;function c(u,g){return g?i!=null&&i.exist(u):l!=null&&l.exist(u)}r.exist=c;function f(u){i=u}r.setEdgeRegistry=f;function h(u){l=u}r.setNodeRegistry=h}(o.ShareRegistry||(o.ShareRegistry={}))})(Br);var Dn={};Object.defineProperty(Dn,"__esModule",{value:!0});Dn.PortManager=void 0;const ft=D,kc=B,We=ae;class Hc{constructor(r){this.ports=[],this.groups={},this.init(ft.ObjectExt.cloneDeep(r))}getPorts(){return this.ports}getGroup(r){return r!=null?this.groups[r]:null}getPortsByGroup(r){return this.ports.filter(i=>i.group===r||i.group==null&&r==null)}getPortsLayoutByGroup(r,i){const l=this.getPortsByGroup(r),c=r?this.getGroup(r):null,f=c?c.position:null,h=f?f.name:null;let u;if(h!=null){const t=We.PortLayout.registry.get(h);if(t==null)return We.PortLayout.registry.onNotFound(h);u=t}else u=We.PortLayout.presets.left;const g=l.map(t=>t&&t.position&&t.position.args||{}),s=f&&f.args||{};return u(g,i,s).map((t,n)=>{const a=l[n];return{portLayout:t,portId:a.id,portSize:a.size,portAttrs:a.attrs,labelSize:a.label.size,labelLayout:this.getPortLabelLayout(a,kc.Point.create(t.position),i)}})}init(r){const{groups:i,items:l}=r;i!=null&&Object.keys(i).forEach(c=>{this.groups[c]=this.parseGroup(i[c])}),Array.isArray(l)&&l.forEach(c=>{this.ports.push(this.parsePort(c))})}parseGroup(r){return Object.assign(Object.assign({},r),{label:this.getLabel(r,!0),position:this.getPortPosition(r.position,!0)})}parsePort(r){const i=Object.assign({},r),l=this.getGroup(r.group)||{};return i.markup=i.markup||l.markup,i.attrs=ft.ObjectExt.merge({},l.attrs,i.attrs),i.position=this.createPosition(l,i),i.label=ft.ObjectExt.merge({},l.label,this.getLabel(i)),i.zIndex=this.getZIndex(l,i),i.size=Object.assign(Object.assign({},l.size),i.size),i}getZIndex(r,i){return typeof i.zIndex=="number"?i.zIndex:typeof r.zIndex=="number"||r.zIndex==="auto"?r.zIndex:"auto"}createPosition(r,i){return ft.ObjectExt.merge({name:"left",args:{}},r.position,{args:i.args})}getPortPosition(r,i=!1){if(r==null){if(i)return{name:"left",args:{}}}else{if(typeof r=="string")return{name:r,args:{}};if(Array.isArray(r))return{name:"absolute",args:{x:r[0],y:r[1]}};if(typeof r=="object")return r}return{args:{}}}getPortLabelPosition(r,i=!1){if(r==null){if(i)return{name:"left",args:{}}}else{if(typeof r=="string")return{name:r,args:{}};if(typeof r=="object")return r}return{args:{}}}getLabel(r,i=!1){const l=r.label||{};return l.position=this.getPortLabelPosition(l.position,i),l}getPortLabelLayout(r,i,l){const c=r.label.position.name||"left",f=r.label.position.args||{},h=We.PortLabelLayout.registry.get(c)||We.PortLabelLayout.presets.left;return h?h(i,l,f):null}}Dn.PortManager=Hc;(function(o){var r=w&&w.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,a=Object.getOwnPropertySymbols(e);d<a.length;d++)t.indexOf(a[d])<0&&Object.prototype.propertyIsEnumerable.call(e,a[d])&&(n[a[d]]=e[a[d]]);return n};Object.defineProperty(o,"__esModule",{value:!0}),o.Node=void 0;const i=B,l=D,c=z,f=Be,h=ke,u=Br,g=Dn;class s extends h.Cell{get[Symbol.toStringTag](){return s.toStringTag}constructor(t={}){super(t),this.initPorts()}preprocess(t,n){const{x:a,y:d,width:m,height:p}=t,b=r(t,["x","y","width","height"]);if(a!=null||d!=null){const y=b.position;b.position=Object.assign(Object.assign({},y),{x:a!=null?a:y?y.x:0,y:d!=null?d:y?y.y:0})}if(m!=null||p!=null){const y=b.size;b.size=Object.assign(Object.assign({},y),{width:m!=null?m:y?y.width:0,height:p!=null?p:y?y.height:0})}return super.preprocess(b,n)}isNode(){return!0}size(t,n,a){return t===void 0?this.getSize():typeof t=="number"?this.setSize(t,n,a):this.setSize(t,n)}getSize(){const t=this.store.get("size");return t?Object.assign({},t):{width:1,height:1}}setSize(t,n,a){return typeof t=="object"?this.resize(t.width,t.height,n):this.resize(t,n,a),this}resize(t,n,a={}){this.startBatch("resize",a);const d=a.direction;if(d){const m=this.getSize();switch(d){case"left":case"right":n=m.height;break;case"top":case"bottom":t=m.width;break}let b={right:0,"top-right":0,top:1,"top-left":1,left:2,"bottom-left":2,bottom:3,"bottom-right":3}[d];const y=i.Angle.normalize(this.getAngle()||0);a.absolute&&(b+=Math.floor((y+45)/90),b%=4);const _=this.getBBox();let O;b===0?O=_.getBottomLeft():b===1?O=_.getCorner():b===2?O=_.getTopRight():O=_.getOrigin();const x=O.clone().rotate(-y,_.getCenter()),C=Math.sqrt(t*t+n*n)/2;let M=b*Math.PI/2;M+=Math.atan(b%2===0?n/t:t/n),M-=i.Angle.toRad(y);const j=i.Point.fromPolar(C,M,x).clone().translate(t/-2,n/-2);this.store.set("size",{width:t,height:n},a),this.setPosition(j.x,j.y,a)}else this.store.set("size",{width:t,height:n},a);return this.stopBatch("resize",a),this}scale(t,n,a,d={}){const m=this.getBBox().scale(t,n,a==null?void 0:a);return this.startBatch("scale",d),this.setPosition(m.x,m.y,d),this.resize(m.width,m.height,d),this.stopBatch("scale"),this}position(t,n,a){return typeof t=="number"?this.setPosition(t,n,a):this.getPosition(t)}getPosition(t={}){if(t.relative){const a=this.getParent();if(a!=null&&a.isNode()){const d=this.getPosition(),m=a.getPosition();return{x:d.x-m.x,y:d.y-m.y}}}const n=this.store.get("position");return n?Object.assign({},n):{x:0,y:0}}setPosition(t,n,a={}){let d,m,p;if(typeof t=="object"?(d=t.x,m=t.y,p=n||{}):(d=t,m=n,p=a||{}),p.relative){const b=this.getParent();if(b!=null&&b.isNode()){const y=b.getPosition();d+=y.x,m+=y.y}}if(p.deep){const b=this.getPosition();this.translate(d-b.x,m-b.y,p)}else this.store.set("position",{x:d,y:m},p);return this}translate(t=0,n=0,a={}){if(t===0&&n===0)return this;a.translateBy=a.translateBy||this.id;const d=this.getPosition();if(a.restrict!=null&&a.translateBy===this.id){const p=this.getBBox({deep:!0}),b=a.restrict,y=d.x-p.x,_=d.y-p.y,O=Math.max(b.x+y,Math.min(b.x+b.width+y-p.width,d.x+t)),x=Math.max(b.y+_,Math.min(b.y+b.height+_-p.height,d.y+n));t=O-d.x,n=x-d.y}const m={x:d.x+t,y:d.y+n};return a.tx=t,a.ty=n,a.transition?(typeof a.transition!="object"&&(a.transition={}),this.transition("position",m,Object.assign(Object.assign({},a.transition),{interp:l.Interp.object})),this.eachChild(p=>{var b;((b=a.exclude)===null||b===void 0?void 0:b.includes(p))||p.translate(t,n,a)})):(this.startBatch("translate",a),this.store.set("position",m,a),this.eachChild(p=>{var b;((b=a.exclude)===null||b===void 0?void 0:b.includes(p))||p.translate(t,n,a)}),this.stopBatch("translate",a)),this}angle(t,n){return t==null?this.getAngle():this.rotate(t,n)}getAngle(){return this.store.get("angle",0)}rotate(t,n={}){const a=this.getAngle();if(n.center){const d=this.getSize(),m=this.getPosition(),p=this.getBBox().getCenter();p.rotate(a-t,n.center);const b=p.x-d.width/2-m.x,y=p.y-d.height/2-m.y;this.startBatch("rotate",{angle:t,options:n}),this.setPosition(m.x+b,m.y+y,n),this.rotate(t,Object.assign(Object.assign({},n),{center:null})),this.stopBatch("rotate")}else this.store.set("angle",n.absolute?t:(a+t)%360,n);return this}getBBox(t={}){if(t.deep){const n=this.getDescendants({deep:!0,breadthFirst:!0});return n.push(this),h.Cell.getCellsBBox(n)}return i.Rectangle.fromPositionAndSize(this.getPosition(),this.getSize())}getConnectionPoint(t,n){const a=this.getBBox(),d=a.getCenter(),m=t.getTerminal(n);if(m==null)return d;const p=m.port;if(!p||!this.hasPort(p))return d;const b=this.getPort(p);if(!b||!b.group)return d;const _=this.getPortsPosition(b.group)[p].position,O=i.Point.create(_).translate(a.getOrigin()),x=this.getAngle();return x&&O.rotate(-x,d),O}fit(t={}){const a=(this.getChildren()||[]).filter(_=>_.isNode());if(a.length===0)return this;this.startBatch("fit-embeds",t),t.deep&&a.forEach(_=>_.fit(t));let{x:d,y:m,width:p,height:b}=h.Cell.getCellsBBox(a);const y=l.NumberExt.normalizeSides(t.padding);return d-=y.left,m-=y.top,p+=y.left+y.right,b+=y.bottom+y.top,this.store.set({position:{x:d,y:m},size:{width:p,height:b}},t),this.stopBatch("fit-embeds"),this}get portContainerMarkup(){return this.getPortContainerMarkup()}set portContainerMarkup(t){this.setPortContainerMarkup(t)}getDefaultPortContainerMarkup(){return this.store.get("defaultPortContainerMarkup")||f.Markup.getPortContainerMarkup()}getPortContainerMarkup(){return this.store.get("portContainerMarkup")||this.getDefaultPortContainerMarkup()}setPortContainerMarkup(t,n={}){return this.store.set("portContainerMarkup",f.Markup.clone(t),n),this}get portMarkup(){return this.getPortMarkup()}set portMarkup(t){this.setPortMarkup(t)}getDefaultPortMarkup(){return this.store.get("defaultPortMarkup")||f.Markup.getPortMarkup()}getPortMarkup(){return this.store.get("portMarkup")||this.getDefaultPortMarkup()}setPortMarkup(t,n={}){return this.store.set("portMarkup",f.Markup.clone(t),n),this}get portLabelMarkup(){return this.getPortLabelMarkup()}set portLabelMarkup(t){this.setPortLabelMarkup(t)}getDefaultPortLabelMarkup(){return this.store.get("defaultPortLabelMarkup")||f.Markup.getPortLabelMarkup()}getPortLabelMarkup(){return this.store.get("portLabelMarkup")||this.getDefaultPortLabelMarkup()}setPortLabelMarkup(t,n={}){return this.store.set("portLabelMarkup",f.Markup.clone(t),n),this}get ports(){const t=this.store.get("ports",{items:[]});return t.items==null&&(t.items=[]),t}getPorts(){return l.ObjectExt.cloneDeep(this.ports.items)}getPortsByGroup(t){return this.getPorts().filter(n=>n.group===t)}getPort(t){return l.ObjectExt.cloneDeep(this.ports.items.find(n=>n.id&&n.id===t))}getPortAt(t){return this.ports.items[t]||null}hasPorts(){return this.ports.items.length>0}hasPort(t){return this.getPortIndex(t)!==-1}getPortIndex(t){const n=typeof t=="string"?t:t.id;return n!=null?this.ports.items.findIndex(a=>a.id===n):-1}getPortsPosition(t){const n=this.getSize();return this.port.getPortsLayoutByGroup(t,new i.Rectangle(0,0,n.width,n.height)).reduce((d,m)=>{const p=m.portLayout;return d[m.portId]={position:Object.assign({},p.position),angle:p.angle||0},d},{})}getPortProp(t,n){return this.getPropByPath(this.prefixPortPath(t,n))}setPortProp(t,n,a,d){if(typeof n=="string"||Array.isArray(n)){const b=this.prefixPortPath(t,n),y=a;return this.setPropByPath(b,y,d)}const m=this.prefixPortPath(t),p=n;return this.setPropByPath(m,p,a)}removePortProp(t,n,a){return typeof n=="string"||Array.isArray(n)?this.removePropByPath(this.prefixPortPath(t,n),a):this.removePropByPath(this.prefixPortPath(t),n)}portProp(t,n,a,d){return n==null?this.getPortProp(t):typeof n=="string"||Array.isArray(n)?arguments.length===2?this.getPortProp(t,n):a==null?this.removePortProp(t,n,d):this.setPortProp(t,n,a,d):this.setPortProp(t,n,a)}prefixPortPath(t,n){const a=this.getPortIndex(t);if(a===-1)throw new Error(`Unable to find port with id: "${t}"`);return n==null||n===""?["ports","items",`${a}`]:Array.isArray(n)?["ports","items",`${a}`,...n]:`ports/items/${a}/${n}`}addPort(t,n){const a=[...this.ports.items];return a.push(t),this.setPropByPath("ports/items",a,n),this}addPorts(t,n){return this.setPropByPath("ports/items",[...this.ports.items,...t],n),this}insertPort(t,n,a){const d=[...this.ports.items];return d.splice(t,0,n),this.setPropByPath("ports/items",d,a),this}removePort(t,n={}){return this.removePortAt(this.getPortIndex(t),n)}removePortAt(t,n={}){if(t>=0){const a=[...this.ports.items];a.splice(t,1),n.rewrite=!0,this.setPropByPath("ports/items",a,n)}return this}removePorts(t,n){let a;if(Array.isArray(t)){if(a=n||{},t.length){a.rewrite=!0;const m=[...this.ports.items].filter(p=>!t.some(b=>{const y=typeof b=="string"?b:b.id;return p.id===y}));this.setPropByPath("ports/items",m,a)}}else a=t||{},a.rewrite=!0,this.setPropByPath("ports/items",[],a);return this}getParsedPorts(){return this.port.getPorts()}getParsedGroups(){return this.port.groups}getPortsLayoutByGroup(t,n){return this.port.getPortsLayoutByGroup(t,n)}initPorts(){this.updatePortData(),this.on("change:ports",()=>{this.processRemovedPort(),this.updatePortData()})}processRemovedPort(){const t=this.ports,n={};t.items.forEach(p=>{p.id&&(n[p.id]=!0)});const a={};(this.store.getPrevious("ports")||{items:[]}).items.forEach(p=>{p.id&&!n[p.id]&&(a[p.id]=!0)});const m=this.model;m&&!l.ObjectExt.isEmpty(a)&&(m.getConnectedEdges(this,{incoming:!0}).forEach(y=>{const _=y.getTargetPortId();_&&a[_]&&y.remove()}),m.getConnectedEdges(this,{outgoing:!0}).forEach(y=>{const _=y.getSourcePortId();_&&a[_]&&y.remove()}))}validatePorts(){const t={},n=[];return this.ports.items.forEach(a=>{typeof a!="object"&&n.push(`Invalid port ${a}.`),a.id==null&&(a.id=this.generatePortId()),t[a.id]&&n.push("Duplicitied port id."),t[a.id]=!0}),n}generatePortId(){return l.StringExt.uuid()}updatePortData(){const t=this.validatePorts();if(t.length>0)throw this.store.set("ports",this.store.getPrevious("ports")),new Error(t.join(" "));const n=this.port?this.port.getPorts():null;this.port=new g.PortManager(this.ports);const a=this.port.getPorts(),d=n?a.filter(p=>n.find(b=>b.id===p.id)?null:p):[...a],m=n?n.filter(p=>a.find(b=>b.id===p.id)?null:p):[];d.length>0&&this.notify("ports:added",{added:d,cell:this,node:this}),m.length>0&&this.notify("ports:removed",{removed:m,cell:this,node:this})}}o.Node=s,s.defaults={angle:0,position:{x:0,y:0},size:{width:1,height:1}},function(e){e.toStringTag=`X6.${e.name}`;function t(n){if(n==null)return!1;if(n instanceof e)return!0;const a=n[Symbol.toStringTag],d=n;return(a==null||a===e.toStringTag)&&typeof d.isNode=="function"&&typeof d.isEdge=="function"&&typeof d.prop=="function"&&typeof d.attr=="function"&&typeof d.size=="function"&&typeof d.position=="function"}e.isNode=t}(s=o.Node||(o.Node={})),function(e){e.config({propHooks(t){var{ports:n}=t,a=r(t,["ports"]);return n&&(a.ports=Array.isArray(n)?{items:n}:n),a}})}(s=o.Node||(o.Node={})),function(e){e.registry=c.Registry.create({type:"node",process(t,n){if(u.ShareRegistry.exist(t,!0))throw new Error(`Node with name '${t}' was registered by anthor Edge`);if(typeof n=="function")return n.config({shape:t}),n;let a=e;const{inherit:d}=n,m=r(n,["inherit"]);if(d)if(typeof d=="string"){const b=this.get(d);b==null?this.onNotFound(d,"inherited"):a=b}else a=d;m.constructorName==null&&(m.constructorName=t);const p=a.define.call(a,m);return p.config({shape:t}),p}}),u.ShareRegistry.setNodeRegistry(e.registry)}(s=o.Node||(o.Node={})),function(e){let t=0;function n(m){return m?l.StringExt.pascalCase(m):(t+=1,`CustomNode${t}`)}function a(m){const{constructorName:p,overwrite:b}=m,y=r(m,["constructorName","overwrite"]),_=l.ObjectExt.createClass(n(p||y.shape),this);return _.config(y),y.shape&&e.registry.register(y.shape,_,b),_}e.define=a;function d(m){const p=m.shape||"rect",b=e.registry.get(p);return b?new b(m):e.registry.onNotFound(p)}e.create=d}(s=o.Node||(o.Node={}))})(An);var it={};(function(o){var r=w&&w.__rest||function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(t[n[a]]=s[n[a]]);return t};Object.defineProperty(o,"__esModule",{value:!0}),o.Edge=void 0;const i=D,l=B,c=z,f=Be,h=Br,u=ke;class g extends u.Cell{get[Symbol.toStringTag](){return g.toStringTag}constructor(e={}){super(e)}preprocess(e,t){const{source:n,sourceCell:a,sourcePort:d,sourcePoint:m,target:p,targetCell:b,targetPort:y,targetPoint:_}=e,x=r(e,["source","sourceCell","sourcePort","sourcePoint","target","targetCell","targetPort","targetPoint"]),C=M=>typeof M=="string"||typeof M=="number";if(n!=null)if(u.Cell.isCell(n))x.source={cell:n.id};else if(C(n))x.source={cell:n};else if(l.Point.isPoint(n))x.source=n.toJSON();else if(Array.isArray(n))x.source={x:n[0],y:n[1]};else{const M=n.cell;u.Cell.isCell(M)?x.source=Object.assign(Object.assign({},n),{cell:M.id}):x.source=n}if(a!=null||d!=null){let M=x.source;if(a!=null){const A=C(a)?a:a.id;M?M.cell=A:M=x.source={cell:A}}d!=null&&M&&(M.port=d)}else m!=null&&(x.source=l.Point.create(m).toJSON());if(p!=null)if(u.Cell.isCell(p))x.target={cell:p.id};else if(C(p))x.target={cell:p};else if(l.Point.isPoint(p))x.target=p.toJSON();else if(Array.isArray(p))x.target={x:p[0],y:p[1]};else{const M=p.cell;u.Cell.isCell(M)?x.target=Object.assign(Object.assign({},p),{cell:M.id}):x.target=p}if(b!=null||y!=null){let M=x.target;if(b!=null){const A=C(b)?b:b.id;M?M.cell=A:M=x.target={cell:A}}y!=null&&M&&(M.port=y)}else _!=null&&(x.target=l.Point.create(_).toJSON());return super.preprocess(x,t)}setup(){super.setup(),this.on("change:labels",e=>this.onLabelsChanged(e)),this.on("change:vertices",e=>this.onVertexsChanged(e))}isEdge(){return!0}disconnect(e={}){return this.store.set({source:{x:0,y:0},target:{x:0,y:0}},e),this}get source(){return this.getSource()}set source(e){this.setSource(e)}getSource(){return this.getTerminal("source")}getSourceCellId(){return this.source.cell}getSourcePortId(){return this.source.port}setSource(e,t,n={}){return this.setTerminal("source",e,t,n)}get target(){return this.getTarget()}set target(e){this.setTarget(e)}getTarget(){return this.getTerminal("target")}getTargetCellId(){return this.target.cell}getTargetPortId(){return this.target.port}setTarget(e,t,n={}){return this.setTerminal("target",e,t,n)}getTerminal(e){return Object.assign({},this.store.get(e))}setTerminal(e,t,n,a={}){if(u.Cell.isCell(t))return this.store.set(e,i.ObjectExt.merge({},n,{cell:t.id}),a),this;const d=t;return l.Point.isPoint(t)||d.x!=null&&d.y!=null?(this.store.set(e,i.ObjectExt.merge({},n,{x:d.x,y:d.y}),a),this):(this.store.set(e,i.ObjectExt.cloneDeep(t),a),this)}getSourcePoint(){return this.getTerminalPoint("source")}getTargetPoint(){return this.getTerminalPoint("target")}getTerminalPoint(e){const t=this[e];if(l.Point.isPointLike(t))return l.Point.create(t);const n=this.getTerminalCell(e);return n?n.getConnectionPoint(this,e):new l.Point}getSourceCell(){return this.getTerminalCell("source")}getTargetCell(){return this.getTerminalCell("target")}getTerminalCell(e){if(this.model){const t=e==="source"?this.getSourceCellId():this.getTargetCellId();if(t)return this.model.getCell(t)}return null}getSourceNode(){return this.getTerminalNode("source")}getTargetNode(){return this.getTerminalNode("target")}getTerminalNode(e){let t=this;const n={};for(;t&&t.isEdge();){if(n[t.id])return null;n[t.id]=!0,t=t.getTerminalCell(e)}return t&&t.isNode()?t:null}get router(){return this.getRouter()}set router(e){e==null?this.removeRouter():this.setRouter(e)}getRouter(){return this.store.get("router")}setRouter(e,t,n){return typeof e=="object"?this.store.set("router",e,t):this.store.set("router",{name:e,args:t},n),this}removeRouter(e={}){return this.store.remove("router",e),this}get connector(){return this.getConnector()}set connector(e){e==null?this.removeConnector():this.setConnector(e)}getConnector(){return this.store.get("connector")}setConnector(e,t,n){return typeof e=="object"?this.store.set("connector",e,t):this.store.set("connector",{name:e,args:t},n),this}removeConnector(e={}){return this.store.remove("connector",e)}getDefaultLabel(){const e=this.constructor,t=this.store.get("defaultLabel")||e.defaultLabel||{};return i.ObjectExt.cloneDeep(t)}get labels(){return this.getLabels()}set labels(e){this.setLabels(e)}getLabels(){return[...this.store.get("labels",[])].map(e=>this.parseLabel(e))}setLabels(e,t={}){return this.store.set("labels",Array.isArray(e)?e:[e],t),this}insertLabel(e,t,n={}){const a=this.getLabels(),d=a.length;let m=t!=null&&Number.isFinite(t)?t:d;return m<0&&(m=d+m+1),a.splice(m,0,this.parseLabel(e)),this.setLabels(a,n)}appendLabel(e,t={}){return this.insertLabel(e,-1,t)}getLabelAt(e){const t=this.getLabels();return e!=null&&Number.isFinite(e)?this.parseLabel(t[e]):null}setLabelAt(e,t,n={}){if(e!=null&&Number.isFinite(e)){const a=this.getLabels();a[e]=this.parseLabel(t),this.setLabels(a,n)}return this}removeLabelAt(e,t={}){const n=this.getLabels(),a=e!=null&&Number.isFinite(e)?e:-1,d=n.splice(a,1);return this.setLabels(n,t),d.length?d[0]:null}parseLabel(e){return typeof e=="string"?this.constructor.parseStringLabel(e):e}onLabelsChanged({previous:e,current:t}){const n=e&&t?t.filter(d=>e.find(m=>d===m||i.ObjectExt.isEqual(d,m))?null:d):t?[...t]:[],a=e&&t?e.filter(d=>t.find(m=>d===m||i.ObjectExt.isEqual(d,m))?null:d):e?[...e]:[];n.length>0&&this.notify("labels:added",{added:n,cell:this,edge:this}),a.length>0&&this.notify("labels:removed",{removed:a,cell:this,edge:this})}get vertices(){return this.getVertices()}set vertices(e){this.setVertices(e)}getVertices(){return[...this.store.get("vertices",[])]}setVertices(e,t={}){const n=Array.isArray(e)?e:[e];return this.store.set("vertices",n.map(a=>l.Point.toJSON(a)),t),this}insertVertex(e,t,n={}){const a=this.getVertices(),d=a.length;let m=t!=null&&Number.isFinite(t)?t:d;return m<0&&(m=d+m+1),a.splice(m,0,l.Point.toJSON(e)),this.setVertices(a,n)}appendVertex(e,t={}){return this.insertVertex(e,-1,t)}getVertexAt(e){return e!=null&&Number.isFinite(e)?this.getVertices()[e]:null}setVertexAt(e,t,n={}){if(e!=null&&Number.isFinite(e)){const a=this.getVertices();a[e]=t,this.setVertices(a,n)}return this}removeVertexAt(e,t={}){const n=this.getVertices(),a=e!=null&&Number.isFinite(e)?e:-1;return n.splice(a,1),this.setVertices(n,t)}onVertexsChanged({previous:e,current:t}){const n=e&&t?t.filter(d=>e.find(m=>l.Point.equals(d,m))?null:d):t?[...t]:[],a=e&&t?e.filter(d=>t.find(m=>l.Point.equals(d,m))?null:d):e?[...e]:[];n.length>0&&this.notify("vertexs:added",{added:n,cell:this,edge:this}),a.length>0&&this.notify("vertexs:removed",{removed:a,cell:this,edge:this})}getDefaultMarkup(){return this.store.get("defaultMarkup")||f.Markup.getEdgeMarkup()}getMarkup(){return super.getMarkup()||this.getDefaultMarkup()}translate(e,t,n={}){return n.translateBy=n.translateBy||this.id,n.tx=e,n.ty=t,this.applyToPoints(a=>({x:(a.x||0)+e,y:(a.y||0)+t}),n)}scale(e,t,n,a={}){return this.applyToPoints(d=>l.Point.create(d).scale(e,t,n).toJSON(),a)}applyToPoints(e,t={}){const n={},a=this.getSource(),d=this.getTarget();l.Point.isPointLike(a)&&(n.source=e(a)),l.Point.isPointLike(d)&&(n.target=e(d));const m=this.getVertices();return m.length>0&&(n.vertices=m.map(e)),this.store.set(n,t),this}getBBox(){return this.getPolyline().bbox()}getConnectionPoint(){return this.getPolyline().pointAt(.5)}getPolyline(){const e=[this.getSourcePoint(),...this.getVertices().map(t=>l.Point.create(t)),this.getTargetPoint()];return new l.Polyline(e)}updateParent(e){let t=null;const n=this.getSourceCell(),a=this.getTargetCell(),d=this.getParent();return n&&a&&(n===a||n.isDescendantOf(a)?t=a:a.isDescendantOf(n)?t=n:t=u.Cell.getCommonAncestor(n,a)),d&&t&&t.id!==d.id&&d.unembed(this,e),t&&(!d||d.id!==t.id)&&t.embed(this,e),t}hasLoop(e={}){const t=this.getSource(),n=this.getTarget(),a=t.cell,d=n.cell;if(!a||!d)return!1;let m=a===d;if(!m&&e.deep&&this._model){const p=this.getSourceCell(),b=this.getTargetCell();p&&b&&(m=p.isAncestorOf(b,e)||b.isAncestorOf(p,e))}return m}getFragmentAncestor(){const e=[this,this.getSourceNode(),this.getTargetNode()].filter(t=>t!=null);return this.getCommonAncestor(...e)}isFragmentDescendantOf(e){const t=this.getFragmentAncestor();return!!t&&(t.id===e.id||t.isDescendantOf(e))}}o.Edge=g,g.defaults={},function(s){function e(t,n){const a=t,d=n;return a.cell===d.cell?a.port===d.port||a.port==null&&d.port==null:!1}s.equalTerminals=e}(g=o.Edge||(o.Edge={})),function(s){s.defaultLabel={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{text:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"label",fill:"#fff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}};function e(t){return{attrs:{label:{text:t}}}}s.parseStringLabel=e}(g=o.Edge||(o.Edge={})),function(s){s.toStringTag=`X6.${s.name}`;function e(t){if(t==null)return!1;if(t instanceof s)return!0;const n=t[Symbol.toStringTag],a=t;return(n==null||n===s.toStringTag)&&typeof a.isNode=="function"&&typeof a.isEdge=="function"&&typeof a.prop=="function"&&typeof a.attr=="function"&&typeof a.disconnect=="function"&&typeof a.getSource=="function"&&typeof a.getTarget=="function"}s.isEdge=e}(g=o.Edge||(o.Edge={})),function(s){s.registry=c.Registry.create({type:"edge",process(e,t){if(h.ShareRegistry.exist(e,!1))throw new Error(`Edge with name '${e}' was registered by anthor Node`);if(typeof t=="function")return t.config({shape:e}),t;let n=s;const{inherit:a="edge"}=t,d=r(t,["inherit"]);if(typeof a=="string"){const p=this.get(a||"edge");p==null&&a?this.onNotFound(a,"inherited"):n=p}else n=a;d.constructorName==null&&(d.constructorName=e);const m=n.define.call(n,d);return m.config({shape:e}),m}}),h.ShareRegistry.setEdgeRegistry(s.registry)}(g=o.Edge||(o.Edge={})),function(s){let e=0;function t(d){return d?i.StringExt.pascalCase(d):(e+=1,`CustomEdge${e}`)}function n(d){const{constructorName:m,overwrite:p}=d,b=r(d,["constructorName","overwrite"]),y=i.ObjectExt.createClass(t(m||b.shape),this);return y.config(b),b.shape&&s.registry.register(b.shape,y,p),y}s.define=n;function a(d){const m=d.shape||"edge",p=s.registry.get(m);return p?new p(d):s.registry.onNotFound(m)}s.create=a}(g=o.Edge||(o.Edge={})),function(s){const e="basic.edge";s.config({shape:e,propHooks(t){const{label:n,vertices:a}=t,d=r(t,["label","vertices"]);if(n){d.labels==null&&(d.labels=[]);const m=typeof n=="string"?s.parseStringLabel(n):n;d.labels.push(m)}return a&&Array.isArray(a)&&(d.vertices=a.map(m=>l.Point.create(m).toJSON())),d}}),s.registry.register(e,s)}(g=o.Edge||(o.Edge={}))})(it);var Ss={},st={},Uc=w&&w.__decorate||function(o,r,i,l){var c=arguments.length,f=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,i):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,r,i,l);else for(var u=o.length-1;u>=0;u--)(h=o[u])&&(f=(c<3?h(f):c>3?h(r,i,f):h(r,i))||f);return c>3&&f&&Object.defineProperty(r,i,f),f};Object.defineProperty(st,"__esModule",{value:!0});st.Collection=void 0;const yi=D;class xr extends yi.Basecoat{constructor(r,i={}){super(),this.length=0,this.comparator=i.comparator||"zIndex",this.clean(),r&&this.reset(r,{silent:!0})}toJSON(){return this.cells.map(r=>r.toJSON())}add(r,i,l){let c,f;typeof i=="number"?(c=i,f=Object.assign({merge:!1},l)):(c=this.length,f=Object.assign({merge:!1},i)),c>this.length&&(c=this.length),c<0&&(c+=this.length+1);const h=Array.isArray(r)?r:[r],u=this.comparator&&typeof i!="number"&&f.sort!==!1,g=this.comparator||null;let s=!1;const e=[],t=[];return h.forEach(n=>{const a=this.get(n);a?f.merge&&!n.isSameStore(a)&&(a.setProp(n.getProp(),l),t.push(a),u&&!s&&(g==null||typeof g=="function"?s=a.hasChanged():typeof g=="string"?s=a.hasChanged(g):s=g.some(d=>a.hasChanged(d)))):(e.push(n),this.reference(n))}),e.length&&(u&&(s=!0),this.cells.splice(c,0,...e),this.length=this.cells.length),s&&this.sort({silent:!0}),f.silent||(e.forEach((n,a)=>{const d={cell:n,index:c+a,options:f};this.trigger("added",d),f.dryrun||n.notify("added",Object.assign({},d))}),s&&this.trigger("sorted"),(e.length||t.length)&&this.trigger("updated",{added:e,merged:t,removed:[],options:f})),this}remove(r,i={}){const l=Array.isArray(r)?r:[r],c=this.removeCells(l,i);return!i.silent&&c.length>0&&this.trigger("updated",{options:i,removed:c,added:[],merged:[]}),Array.isArray(r)?c:c[0]}removeCells(r,i){const l=[];for(let c=0;c<r.length;c+=1){const f=this.get(r[c]);if(f==null)continue;const h=this.cells.indexOf(f);this.cells.splice(h,1),this.length-=1,delete this.map[f.id],l.push(f),this.unreference(f),i.dryrun||f.remove(),i.silent||(this.trigger("removed",{cell:f,index:h,options:i}),i.dryrun||f.notify("removed",{cell:f,index:h,options:i}))}return l}reset(r,i={}){const l=this.cells.slice();if(l.forEach(c=>this.unreference(c)),this.clean(),this.add(r,Object.assign({silent:!0},i)),!i.silent){const c=this.cells.slice();this.trigger("reseted",{options:i,previous:l,current:c});const f=[],h=[];c.forEach(u=>{l.some(s=>s.id===u.id)||f.push(u)}),l.forEach(u=>{c.some(s=>s.id===u.id)||h.push(u)}),this.trigger("updated",{options:i,added:f,removed:h,merged:[]})}return this}push(r,i){return this.add(r,this.length,i)}pop(r){const i=this.at(this.length-1);return this.remove(i,r)}unshift(r,i){return this.add(r,0,i)}shift(r){const i=this.at(0);return this.remove(i,r)}get(r){if(r==null)return null;const i=typeof r=="string"||typeof r=="number"?r:r.id;return this.map[i]||null}has(r){return this.get(r)!=null}at(r){return r<0&&(r+=this.length),this.cells[r]||null}first(){return this.at(0)}last(){return this.at(-1)}indexOf(r){return this.cells.indexOf(r)}toArray(){return this.cells.slice()}sort(r={}){return this.comparator!=null&&(this.cells=yi.ArrayExt.sortBy(this.cells,this.comparator),r.silent||this.trigger("sorted")),this}clone(){const r=this.constructor;return new r(this.cells.slice(),{comparator:this.comparator})}reference(r){this.map[r.id]=r,r.on("*",this.notifyCellEvent,this)}unreference(r){r.off("*",this.notifyCellEvent,this),delete this.map[r.id]}notifyCellEvent(r,i){const l=i.cell;this.trigger(`cell:${r}`,i),l&&(l.isNode()?this.trigger(`node:${r}`,Object.assign(Object.assign({},i),{node:l})):l.isEdge()&&this.trigger(`edge:${r}`,Object.assign(Object.assign({},i),{edge:l})))}clean(){this.length=0,this.cells=[],this.map={}}dispose(){this.reset([])}}Uc([xr.dispose()],xr.prototype,"dispose",null);st.Collection=xr;(function(o){var r=w&&w.__decorate||function(s,e,t,n){var a=arguments.length,d=a<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(s,e,t,n);else for(var p=s.length-1;p>=0;p--)(m=s[p])&&(d=(a<3?m(d):a>3?m(e,t,d):m(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d};Object.defineProperty(o,"__esModule",{value:!0}),o.Model=void 0;const i=D,l=B,c=ke,f=it,h=An,u=st;class g extends i.Basecoat{get[Symbol.toStringTag](){return g.toStringTag}constructor(e=[]){super(),this.batches={},this.addings=new WeakMap,this.nodes={},this.edges={},this.outgoings={},this.incomings={},this.collection=new u.Collection(e),this.setup()}notify(e,t){this.trigger(e,t);const n=this.graph;return n&&(e==="sorted"||e==="reseted"||e==="updated"?n.trigger(`model:${e}`,t):n.trigger(e,t)),this}setup(){const e=this.collection;e.on("sorted",()=>this.notify("sorted",null)),e.on("updated",t=>this.notify("updated",t)),e.on("cell:change:zIndex",()=>this.sortOnChangeZ()),e.on("added",({cell:t})=>{this.onCellAdded(t)}),e.on("removed",t=>{const n=t.cell;this.onCellRemoved(n,t.options),this.notify("cell:removed",t),n.isNode()?this.notify("node:removed",Object.assign(Object.assign({},t),{node:n})):n.isEdge()&&this.notify("edge:removed",Object.assign(Object.assign({},t),{edge:n}))}),e.on("reseted",t=>{this.onReset(t.current),this.notify("reseted",t)}),e.on("edge:change:source",({edge:t})=>this.onEdgeTerminalChanged(t,"source")),e.on("edge:change:target",({edge:t})=>{this.onEdgeTerminalChanged(t,"target")})}sortOnChangeZ(){this.collection.sort()}onCellAdded(e){const t=e.id;e.isEdge()?(e.updateParent(),this.edges[t]=!0,this.onEdgeTerminalChanged(e,"source"),this.onEdgeTerminalChanged(e,"target")):this.nodes[t]=!0}onCellRemoved(e,t){const n=e.id;if(e.isEdge()){delete this.edges[n];const a=e.getSource(),d=e.getTarget();if(a&&a.cell){const m=this.outgoings[a.cell],p=m?m.indexOf(n):-1;p>=0&&(m.splice(p,1),m.length===0&&delete this.outgoings[a.cell])}if(d&&d.cell){const m=this.incomings[d.cell],p=m?m.indexOf(n):-1;p>=0&&(m.splice(p,1),m.length===0&&delete this.incomings[d.cell])}}else delete this.nodes[n];t.clear||(t.disconnectEdges?this.disconnectConnectedEdges(e,t):this.removeConnectedEdges(e,t)),e.model===this&&(e.model=null)}onReset(e){this.nodes={},this.edges={},this.outgoings={},this.incomings={},e.forEach(t=>this.onCellAdded(t))}onEdgeTerminalChanged(e,t){const n=t==="source"?this.outgoings:this.incomings,a=e.previous(t);if(a&&a.cell){const m=c.Cell.isCell(a.cell)?a.cell.id:a.cell,p=n[m],b=p?p.indexOf(e.id):-1;b>=0&&(p.splice(b,1),p.length===0&&delete n[m])}const d=e.getTerminal(t);if(d&&d.cell){const m=c.Cell.isCell(d.cell)?d.cell.id:d.cell,p=n[m]||[];p.indexOf(e.id)===-1&&p.push(e.id),n[m]=p}}prepareCell(e,t){return!e.model&&(!t||!t.dryrun)&&(e.model=this),e.zIndex==null&&e.setZIndex(this.getMaxZIndex()+1,{silent:!0}),e}resetCells(e,t={}){return e.map(n=>this.prepareCell(n,Object.assign(Object.assign({},t),{dryrun:!0}))),this.collection.reset(e,t),e.map(n=>this.prepareCell(n,{options:t})),this}clear(e={}){const t=this.getCells();if(t.length===0)return this;const n=Object.assign(Object.assign({},e),{clear:!0});return this.batchUpdate("clear",()=>{const a=t.sort((d,m)=>{const p=d.isEdge()?1:2,b=m.isEdge()?1:2;return p-b});for(;a.length>0;){const d=a.shift();d&&d.remove(n)}},n),this}addNode(e,t={}){const n=h.Node.isNode(e)?e:this.createNode(e);return this.addCell(n,t),n}updateNode(e,t={}){const n=this.createNode(e),a=n.getProp();return n.dispose(),this.updateCell(a,t)}createNode(e){return h.Node.create(e)}addEdge(e,t={}){const n=f.Edge.isEdge(e)?e:this.createEdge(e);return this.addCell(n,t),n}createEdge(e){return f.Edge.create(e)}updateEdge(e,t={}){const n=this.createEdge(e),a=n.getProp();return n.dispose(),this.updateCell(a,t)}addCell(e,t={}){return Array.isArray(e)?this.addCells(e,t):(!this.collection.has(e)&&!this.addings.has(e)&&(this.addings.set(e,!0),this.collection.add(this.prepareCell(e,t),t),e.eachChild(n=>this.addCell(n,t)),this.addings.delete(e)),this)}addCells(e,t={}){const n=e.length;if(n===0)return this;const a=Object.assign(Object.assign({},t),{position:n-1,maxPosition:n-1});return this.startBatch("add",Object.assign(Object.assign({},a),{cells:e})),e.forEach(d=>{this.addCell(d,a),a.position-=1}),this.stopBatch("add",Object.assign(Object.assign({},a),{cells:e})),this}updateCell(e,t={}){const n=e.id&&this.getCell(e.id);return n?this.batchUpdate("update",()=>(Object.entries(e).forEach(([a,d])=>n.setProp(a,d,t)),!0),e):!1}removeCell(e,t={}){const n=typeof e=="string"?this.getCell(e):e;return n&&this.has(n)?this.collection.remove(n,t):null}updateCellId(e,t){if(e.id===t)return;this.startBatch("update",{id:t}),e.prop("id",t);const n=e.clone({keepId:!0});return this.addCell(n),this.getConnectedEdges(e).forEach(d=>{const m=d.getSourceCell(),p=d.getTargetCell();m===e&&d.setSource(Object.assign(Object.assign({},d.getSource()),{cell:t})),p===e&&d.setTarget(Object.assign(Object.assign({},d.getTarget()),{cell:t}))}),this.removeCell(e),this.stopBatch("update",{id:t}),n}removeCells(e,t={}){return e.length?this.batchUpdate("remove",()=>e.map(n=>this.removeCell(n,t))):[]}removeConnectedEdges(e,t={}){const n=this.getConnectedEdges(e);return n.forEach(a=>{a.remove(t)}),n}disconnectConnectedEdges(e,t={}){const n=typeof e=="string"?e:e.id;this.getConnectedEdges(e).forEach(a=>{const d=a.getSourceCellId(),m=a.getTargetCellId();d===n&&a.setSource({x:0,y:0},t),m===n&&a.setTarget({x:0,y:0},t)})}has(e){return this.collection.has(e)}total(){return this.collection.length}indexOf(e){return this.collection.indexOf(e)}getCell(e){return this.collection.get(e)}getCells(){return this.collection.toArray()}getFirstCell(){return this.collection.first()}getLastCell(){return this.collection.last()}getMinZIndex(){const e=this.collection.first();return e&&e.getZIndex()||0}getMaxZIndex(){const e=this.collection.last();return e&&e.getZIndex()||0}getCellsFromCache(e){return e?Object.keys(e).map(t=>this.getCell(t)).filter(t=>t!=null):[]}getNodes(){return this.getCellsFromCache(this.nodes)}getEdges(){return this.getCellsFromCache(this.edges)}getOutgoingEdges(e){const t=typeof e=="string"?e:e.id,n=this.outgoings[t];return n?n.map(a=>this.getCell(a)).filter(a=>a&&a.isEdge()):null}getIncomingEdges(e){const t=typeof e=="string"?e:e.id,n=this.incomings[t];return n?n.map(a=>this.getCell(a)).filter(a=>a&&a.isEdge()):null}getConnectedEdges(e,t={}){const n=[],a=typeof e=="string"?this.getCell(e):e;if(a==null)return n;const d={},m=t.indirect;let p=t.incoming,b=t.outgoing;p==null&&b==null&&(p=b=!0);const y=(_,O)=>{const x=O?this.getOutgoingEdges(_):this.getIncomingEdges(_);if(x!=null&&x.forEach(C=>{d[C.id]||(n.push(C),d[C.id]=!0,m&&(p&&y(C,!1),b&&y(C,!0)))}),m&&_.isEdge()){const C=O?_.getTargetCell():_.getSourceCell();C&&C.isEdge()&&(d[C.id]||(n.push(C),y(C,O)))}};if(b&&y(a,!0),p&&y(a,!1),t.deep){const _=a.getDescendants({deep:!0}),O={};_.forEach(C=>{C.isNode()&&(O[C.id]=!0)});const x=(C,M)=>{const A=M?this.getOutgoingEdges(C.id):this.getIncomingEdges(C.id);A!=null&&A.forEach(j=>{if(!d[j.id]){const v=j.getSourceCell(),P=j.getTargetCell();if(!t.enclosed&&v&&O[v.id]&&P&&O[P.id])return;n.push(j),d[j.id]=!0}})};_.forEach(C=>{C.isEdge()||(b&&x(C,!0),p&&x(C,!1))})}return n}isBoundary(e,t){const n=typeof e=="string"?this.getCell(e):e,a=t?this.getIncomingEdges(n):this.getOutgoingEdges(n);return a==null||a.length===0}getBoundaryNodes(e){const t=[];return Object.keys(this.nodes).forEach(n=>{if(this.isBoundary(n,e)){const a=this.getCell(n);a&&t.push(a)}}),t}getRoots(){return this.getBoundaryNodes(!0)}getLeafs(){return this.getBoundaryNodes(!1)}isRoot(e){return this.isBoundary(e,!0)}isLeaf(e){return this.isBoundary(e,!1)}getNeighbors(e,t={}){let n=t.incoming,a=t.outgoing;n==null&&a==null&&(n=a=!0);const m=this.getConnectedEdges(e,t).reduce((p,b)=>{const y=b.hasLoop(t),_=b.getSourceCell(),O=b.getTargetCell();return n&&_&&_.isNode()&&!p[_.id]&&(y||_!==e&&(!t.deep||!_.isDescendantOf(e)))&&(p[_.id]=_),a&&O&&O.isNode()&&!p[O.id]&&(y||O!==e&&(!t.deep||!O.isDescendantOf(e)))&&(p[O.id]=O),p},{});if(e.isEdge()){if(n){const p=e.getSourceCell();p&&p.isNode()&&!m[p.id]&&(m[p.id]=p)}if(a){const p=e.getTargetCell();p&&p.isNode()&&!m[p.id]&&(m[p.id]=p)}}return Object.keys(m).map(p=>m[p])}isNeighbor(e,t,n={}){let a=n.incoming,d=n.outgoing;return a==null&&d==null&&(a=d=!0),this.getConnectedEdges(e,n).some(m=>{const p=m.getSourceCell(),b=m.getTargetCell();return!!(a&&p&&p.id===t.id||d&&b&&b.id===t.id)})}getSuccessors(e,t={}){const n=[];return this.search(e,(a,d)=>{a!==e&&this.matchDistance(d,t.distance)&&n.push(a)},Object.assign(Object.assign({},t),{outgoing:!0})),n}isSuccessor(e,t,n={}){let a=!1;return this.search(e,(d,m)=>{if(d===t&&d!==e&&this.matchDistance(m,n.distance))return a=!0,!1},Object.assign(Object.assign({},n),{outgoing:!0})),a}getPredecessors(e,t={}){const n=[];return this.search(e,(a,d)=>{a!==e&&this.matchDistance(d,t.distance)&&n.push(a)},Object.assign(Object.assign({},t),{incoming:!0})),n}isPredecessor(e,t,n={}){let a=!1;return this.search(e,(d,m)=>{if(d===t&&d!==e&&this.matchDistance(m,n.distance))return a=!0,!1},Object.assign(Object.assign({},n),{incoming:!0})),a}matchDistance(e,t){return t==null?!0:typeof t=="function"?t(e):Array.isArray(t)&&t.includes(e)?!0:e===t}getCommonAncestor(...e){const t=[];return e.forEach(n=>{n&&(Array.isArray(n)?t.push(...n):t.push(n))}),c.Cell.getCommonAncestor(...t)}getSubGraph(e,t={}){const n=[],a={},d=[],m=[],p=b=>{a[b.id]||(n.push(b),a[b.id]=b,b.isEdge()&&m.push(b),b.isNode()&&d.push(b))};return e.forEach(b=>{p(b),t.deep&&b.getDescendants({deep:!0}).forEach(_=>p(_))}),m.forEach(b=>{const y=b.getSourceCell(),_=b.getTargetCell();y&&!a[y.id]&&(n.push(y),a[y.id]=y,y.isNode()&&d.push(y)),_&&!a[_.id]&&(n.push(_),a[_.id]=_,_.isNode()&&d.push(_))}),d.forEach(b=>{this.getConnectedEdges(b,t).forEach(_=>{const O=_.getSourceCell(),x=_.getTargetCell();!a[_.id]&&O&&a[O.id]&&x&&a[x.id]&&(n.push(_),a[_.id]=_)})}),n}cloneSubGraph(e,t={}){const n=this.getSubGraph(e,t);return this.cloneCells(n)}cloneCells(e){return c.Cell.cloneCells(e)}getNodesFromPoint(e,t){const n=typeof e=="number"?{x:e,y:t||0}:e;return this.getNodes().filter(a=>a.getBBox().containsPoint(n))}getNodesInArea(e,t,n,a,d){const m=typeof e=="number"?new l.Rectangle(e,t,n,a):l.Rectangle.create(e),p=typeof e=="number"?d:t,b=p&&p.strict;return this.getNodes().filter(y=>{const _=y.getBBox();return b?m.containsRect(_):m.isIntersectWithRect(_)})}getEdgesInArea(e,t,n,a,d){const m=typeof e=="number"?new l.Rectangle(e,t,n,a):l.Rectangle.create(e),p=typeof e=="number"?d:t,b=p&&p.strict;return this.getEdges().filter(y=>{const _=y.getBBox();return _.width===0?_.inflate(1,0):_.height===0&&_.inflate(0,1),b?m.containsRect(_):m.isIntersectWithRect(_)})}getNodesUnderNode(e,t={}){const n=e.getBBox();return(t.by==null||t.by==="bbox"?this.getNodesInArea(n):this.getNodesFromPoint(n[t.by])).filter(d=>e.id!==d.id&&!d.isDescendantOf(e))}getAllCellsBBox(){return this.getCellsBBox(this.getCells())}getCellsBBox(e,t={}){return c.Cell.getCellsBBox(e,t)}search(e,t,n={}){n.breadthFirst?this.breadthFirstSearch(e,t,n):this.depthFirstSearch(e,t,n)}breadthFirstSearch(e,t,n={}){const a=[],d={},m={};for(a.push(e),m[e.id]=0;a.length>0;){const p=a.shift();if(p==null||d[p.id]||(d[p.id]=!0,i.FunctionExt.call(t,this,p,m[p.id])===!1))continue;this.getNeighbors(p,n).forEach(y=>{m[y.id]=m[p.id]+1,a.push(y)})}}depthFirstSearch(e,t,n={}){const a=[],d={},m={};for(a.push(e),m[e.id]=0;a.length>0;){const p=a.pop();if(p==null||d[p.id]||(d[p.id]=!0,i.FunctionExt.call(t,this,p,m[p.id])===!1))continue;const b=this.getNeighbors(p,n),y=a.length;b.forEach(_=>{m[_.id]=m[p.id]+1,a.splice(y,0,_)})}}getShortestPath(e,t,n={}){const a={};this.getEdges().forEach(y=>{const _=y.getSourceCellId(),O=y.getTargetCellId();_&&O&&(a[_]||(a[_]=[]),a[O]||(a[O]=[]),a[_].push(O),n.directed||a[O].push(_))});const d=typeof e=="string"?e:e.id,m=i.Dijkstra.run(a,d,n.weight),p=[];let b=typeof t=="string"?t:t.id;for(m[b]&&p.push(b);b=m[b];)p.unshift(b);return p}translate(e,t,n){return this.getCells().filter(a=>!a.hasParent()).forEach(a=>a.translate(e,t,n)),this}resize(e,t,n){return this.resizeCells(e,t,this.getCells(),n)}resizeCells(e,t,n,a={}){const d=this.getCellsBBox(n);if(d){const m=Math.max(e/d.width,0),p=Math.max(t/d.height,0),b=d.getOrigin();n.forEach(y=>y.scale(m,p,b,a))}return this}toJSON(e={}){return g.toJSON(this.getCells(),e)}parseJSON(e){return g.fromJSON(e)}fromJSON(e,t={}){const n=this.parseJSON(e);return this.resetCells(n,t),this}startBatch(e,t={}){return this.batches[e]=(this.batches[e]||0)+1,this.notify("batch:start",{name:e,data:t}),this}stopBatch(e,t={}){return this.batches[e]=(this.batches[e]||0)-1,this.notify("batch:stop",{name:e,data:t}),this}batchUpdate(e,t,n={}){this.startBatch(e,n);const a=t();return this.stopBatch(e,n),a}hasActiveBatch(e=Object.keys(this.batches)){return(Array.isArray(e)?e:[e]).some(n=>this.batches[n]>0)}dispose(){this.collection.dispose()}}r([g.dispose()],g.prototype,"dispose",null),o.Model=g,function(s){s.toStringTag=`X6.${s.name}`;function e(t){if(t==null)return!1;if(t instanceof s)return!0;const n=t[Symbol.toStringTag],a=t;return(n==null||n===s.toStringTag)&&typeof a.addNode=="function"&&typeof a.addEdge=="function"&&a.collection!=null}s.isModel=e}(g=o.Model||(o.Model={})),function(s){function e(n,a={}){return{cells:n.map(d=>d.toJSON(a))}}s.toJSON=e;function t(n){const a=[];return Array.isArray(n)?a.push(...n):(n.cells&&a.push(...n.cells),n.nodes&&n.nodes.forEach(d=>{d.shape==null&&(d.shape="rect"),a.push(d)}),n.edges&&n.edges.forEach(d=>{d.shape==null&&(d.shape="edge"),a.push(d)})),a.map(d=>{const m=d.shape;if(m){if(h.Node.registry.exist(m))return h.Node.create(d);if(f.Edge.registry.exist(m))return f.Edge.create(d)}throw new Error("The `shape` should be specified when creating a node/edge instance")})}s.fromJSON=t}(g=o.Model||(o.Model={}))})(Ss);(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(ke,o),i(An,o),i(it,o),i(Ss,o),i(st,o)})(Ge);(function(o){var r=w&&w.__rest||function(f,h){var u={};for(var g in f)Object.prototype.hasOwnProperty.call(f,g)&&h.indexOf(g)<0&&(u[g]=f[g]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,g=Object.getOwnPropertySymbols(f);s<g.length;s++)h.indexOf(g[s])<0&&Object.prototype.propertyIsEnumerable.call(f,g[s])&&(u[g[s]]=f[g[s]]);return u};Object.defineProperty(o,"__esModule",{value:!0}),o.Base=void 0;const i=D,l=Ge;class c extends l.Node{get label(){return this.getLabel()}set label(h){this.setLabel(h)}getLabel(){return this.getAttrByPath("text/text")}setLabel(h,u){return h==null?this.removeLabel():this.setAttrByPath("text/text",h,u),this}removeLabel(){return this.removeAttrByPath("text/text"),this}}o.Base=c,function(f){f.bodyAttr={fill:"#ffffff",stroke:"#333333",strokeWidth:2},f.labelAttr={fontSize:14,fill:"#000000",refX:.5,refY:.5,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"Arial, helvetica, sans-serif"},f.config({attrs:{text:Object.assign({},f.labelAttr)},propHooks(h){const{label:u}=h,g=r(h,["label"]);return u&&i.ObjectExt.setByPath(g,"attrs/text/text",u),g},visible:!0})}(c=o.Base||(o.Base={}))})(Ze);var qc=w&&w.__rest||function(o,r){var i={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.indexOf(l)<0&&(i[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(o);c<l.length;c++)r.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(o,l[c])&&(i[l[c]]=o[l[c]]);return i};Object.defineProperty(Z,"__esModule",{value:!0});Z.createShape=Z.getImageUrlHook=Z.getMarkup=void 0;const Wc=D,vi=Ze;function As(o,r="body"){return[{tagName:o,selector:r},{tagName:"text",selector:"label"}]}Z.getMarkup=As;function Xc(o="xlink:href"){return i=>{const{imageUrl:l,imageWidth:c,imageHeight:f}=i,h=qc(i,["imageUrl","imageWidth","imageHeight"]);if(l!=null||c!=null||f!=null){const u=()=>{if(h.attrs){const g=h.attrs.image;l!=null&&(g[o]=l),c!=null&&(g.width=c),f!=null&&(g.height=f),h.attrs.image=g}};h.attrs?(h.attrs.image==null&&(h.attrs.image={}),u()):(h.attrs={image:{}},u())}return h}}Z.getImageUrlHook=Xc;function Jc(o,r,i={}){const l={constructorName:o,markup:As(o,i.selector),attrs:{[o]:Object.assign({},vi.Base.bodyAttr)}};return(i.parent||vi.Base).define(Wc.ObjectExt.merge(l,r,{shape:o}))}Z.createShape=Jc;Object.defineProperty(Je,"__esModule",{value:!0});Je.Rect=void 0;const Yc=Z;Je.Rect=(0,Yc.createShape)("rect",{attrs:{body:{refWidth:"100%",refHeight:"100%"}}});var Ke={};Object.defineProperty(Ke,"__esModule",{value:!0});Ke.Edge=void 0;const Kc=it;Ke.Edge=Kc.Edge.define({shape:"edge",markup:[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}],attrs:{lines:{connection:!0,strokeLinejoin:"round"},wrap:{strokeWidth:10},line:{stroke:"#333",strokeWidth:2,targetMarker:"classic"}}});var Tn={};Object.defineProperty(Tn,"__esModule",{value:!0});Tn.Ellipse=void 0;const Zc=Z;Tn.Ellipse=(0,Zc.createShape)("ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}});var Bn={},Nr={};(function(o){var r=w&&w.__rest||function(h,u){var g={};for(var s in h)Object.prototype.hasOwnProperty.call(h,s)&&u.indexOf(s)<0&&(g[s]=h[s]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var e=0,s=Object.getOwnPropertySymbols(h);e<s.length;e++)u.indexOf(s[e])<0&&Object.prototype.propertyIsEnumerable.call(h,s[e])&&(g[s[e]]=h[s[e]]);return g};Object.defineProperty(o,"__esModule",{value:!0}),o.Poly=void 0;const i=B,l=D,c=Ze;class f extends c.Base{get points(){return this.getPoints()}set points(u){this.setPoints(u)}getPoints(){return this.getAttrByPath("body/refPoints")}setPoints(u,g){return u==null?this.removePoints():this.setAttrByPath("body/refPoints",f.pointsToString(u),g),this}removePoints(){return this.removeAttrByPath("body/refPoints"),this}}o.Poly=f,function(h){function u(g){return typeof g=="string"?g:g.map(s=>Array.isArray(s)?s.join(","):i.Point.isPointLike(s)?`${s.x}, ${s.y}`:"").join(" ")}h.pointsToString=u,h.config({propHooks(g){const{points:s}=g,e=r(g,["points"]);if(s){const t=u(s);t&&l.ObjectExt.setByPath(e,"attrs/body/refPoints",t)}return e}})}(f=o.Poly||(o.Poly={}))})(Nr);Object.defineProperty(Bn,"__esModule",{value:!0});Bn.Polygon=void 0;const Qc=Nr,eu=Z;Bn.Polygon=(0,eu.createShape)("polygon",{},{parent:Qc.Poly});var Nn={};Object.defineProperty(Nn,"__esModule",{value:!0});Nn.Polyline=void 0;const tu=Nr,nu=Z;Nn.Polyline=(0,nu.createShape)("polyline",{},{parent:tu.Poly});var Rn={},ru=w&&w.__rest||function(o,r){var i={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.indexOf(l)<0&&(i[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(o);c<l.length;c++)r.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(o,l[c])&&(i[l[c]]=o[l[c]]);return i};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.Path=void 0;const iu=D,su=Ze;Rn.Path=su.Base.define({shape:"path",markup:[{tagName:"rect",selector:"bg"},{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}],attrs:{bg:{refWidth:"100%",refHeight:"100%",fill:"none",stroke:"none",pointerEvents:"all"},body:{fill:"none",stroke:"#000",strokeWidth:2}},propHooks(o){const{path:r}=o,i=ru(o,["path"]);return r&&iu.ObjectExt.setByPath(i,"attrs/body/refD",r),i}});var $n={},ou=w&&w.__rest||function(o,r){var i={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.indexOf(l)<0&&(i[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(o);c<l.length;c++)r.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(o,l[c])&&(i[l[c]]=o[l[c]]);return i};Object.defineProperty($n,"__esModule",{value:!0});$n.TextBlock=void 0;const dt=D,au=ae,_i=Ze;$n.TextBlock=_i.Base.define({shape:"text-block",markup:[{tagName:"rect",selector:"body"},dt.Platform.SUPPORT_FOREIGNOBJECT?{tagName:"foreignObject",selector:"foreignObject",children:[{tagName:"div",ns:dt.Dom.ns.xhtml,selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attrs:{textAnchor:"middle"}}],attrs:{body:Object.assign(Object.assign({},_i.Base.bodyAttr),{refWidth:"100%",refHeight:"100%"}),foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}},propHooks(o){const{text:r}=o,i=ou(o,["text"]);return r&&dt.ObjectExt.setByPath(i,"attrs/label/text",r),i},attrHooks:{text:{set(o,{cell:r,view:i,refBBox:l,elem:c,attrs:f}){if(c instanceof HTMLElement)c.textContent=o;else{const h=f.style||{},u={text:o,width:-5,height:"100%"},g=Object.assign({textVerticalAnchor:"middle"},h),s=au.Attr.presets.textWrap;return dt.FunctionExt.call(s.set,this,u,{cell:r,view:i,elem:c,refBBox:l,attrs:g}),{fill:h.color||null}}},position(o,{refBBox:r,elem:i}){if(i instanceof SVGElement)return r.getCenter()}}}});var Vn={};Object.defineProperty(Vn,"__esModule",{value:!0});Vn.Image=void 0;const wi=Z;Vn.Image=(0,wi.createShape)("image",{attrs:{image:{refWidth:"100%",refHeight:"100%"}},propHooks:(0,wi.getImageUrlHook)()},{selector:"image"});var Ln={};Object.defineProperty(Ln,"__esModule",{value:!0});Ln.Circle=void 0;const lu=Z;Ln.Circle=(0,lu.createShape)("circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%"}}});var mr={},Ne={},Ds={},In={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.NodeView=void 0;const r=D,i=B,l=ce,c=ke,f=sn(),h=Be;class u extends f.CellView{constructor(){super(...arguments),this.portsCache={}}get[Symbol.toStringTag](){return u.toStringTag}getContainerClassName(){const s=[super.getContainerClassName(),this.prefixClassName("node")];return this.can("nodeMovable")||s.push(this.prefixClassName("node-immovable")),s.join(" ")}updateClassName(s){const e=s.target;if(e.hasAttribute("magnet")){const t=this.prefixClassName("port-unconnectable");this.can("magnetConnectable")?r.Dom.removeClass(e,t):r.Dom.addClass(e,t)}else{const t=this.prefixClassName("node-immovable");this.can("nodeMovable")?this.removeClass(t):this.addClass(t)}}isNodeView(){return!0}confirmUpdate(s,e={}){let t=s;return this.hasAction(t,"ports")&&(this.removePorts(),this.cleanPortsCache()),this.hasAction(t,"render")?(this.render(),t=this.removeAction(t,["render","update","resize","translate","rotate","ports","tools"])):(t=this.handleAction(t,"resize",()=>this.resize(),"update"),t=this.handleAction(t,"update",()=>this.update(),l.Config.useCSSSelector?"ports":null),t=this.handleAction(t,"translate",()=>this.translate()),t=this.handleAction(t,"rotate",()=>this.rotate()),t=this.handleAction(t,"ports",()=>this.renderPorts()),t=this.handleAction(t,"tools",()=>{this.getFlag("tools")===s?this.renderTools():this.updateTools(e)})),t}update(s){this.cleanCache(),l.Config.useCSSSelector&&this.removePorts();const e=this.cell,t=e.getSize(),n=e.getAttrs();this.updateAttrs(this.container,n,{attrs:s===n?null:s,rootBBox:new i.Rectangle(0,0,t.width,t.height),selectors:this.selectors}),l.Config.useCSSSelector&&this.renderPorts()}renderMarkup(){const s=this.cell.markup;if(s){if(typeof s=="string")throw new TypeError("Not support string markup.");return this.renderJSONMarkup(s)}throw new TypeError("Invalid node markup.")}renderJSONMarkup(s){const e=this.parseJSONMarkup(s,this.container);this.selectors=e.selectors,this.container.appendChild(e.fragment)}render(){return this.empty(),this.renderMarkup(),this.resize(),this.updateTransform(),l.Config.useCSSSelector||this.renderPorts(),this.renderTools(),this}resize(){this.cell.getAngle()&&this.rotate(),this.update()}translate(){this.updateTransform()}rotate(){this.updateTransform()}getTranslationString(){const s=this.cell.getPosition();return`translate(${s.x},${s.y})`}getRotationString(){const s=this.cell.getAngle();if(s){const e=this.cell.getSize();return`rotate(${s},${e.width/2},${e.height/2})`}}updateTransform(){let s=this.getTranslationString();const e=this.getRotationString();e&&(s+=` ${e}`),this.container.setAttribute("transform",s)}findPortElem(s,e){const t=s?this.portsCache[s]:null;if(!t)return null;const n=t.portContentElement,a=t.portContentSelectors||{};return this.findOne(e,n,a)}cleanPortsCache(){this.portsCache={}}removePorts(){Object.values(this.portsCache).forEach(s=>{r.Dom.remove(s.portElement)})}renderPorts(){const s=this.container,e=[];s.childNodes.forEach(d=>{e.push(d)});const t=this.cell.getParsedPorts(),n=r.ArrayExt.groupBy(t,"zIndex"),a="auto";n[a]&&n[a].forEach(d=>{const m=this.getPortElement(d);s.append(m),e.push(m)}),Object.keys(n).forEach(d=>{if(d!==a){const m=parseInt(d,10);this.appendPorts(n[d],m,e)}}),this.updatePorts()}appendPorts(s,e,t){const n=s.map(a=>this.getPortElement(a));t[e]||e<0?r.Dom.before(t[Math.max(e,0)],n):r.Dom.append(this.container,n)}getPortElement(s){const e=this.portsCache[s.id];return e?e.portElement:this.createPortElement(s)}createPortElement(s){let e=h.Markup.renderMarkup(this.cell.getPortContainerMarkup());const t=e.elem;if(t==null)throw new Error("Invalid port container markup.");e=h.Markup.renderMarkup(this.getPortMarkup(s));const n=e.elem,a=e.selectors;if(n==null)throw new Error("Invalid port markup.");this.setAttrs({port:s.id,"port-group":s.group},n);let d="x6-port";s.group&&(d+=` x6-port-${s.group}`),r.Dom.addClass(t,d),r.Dom.addClass(t,"x6-port"),r.Dom.addClass(n,"x6-port-body"),t.appendChild(n);let m=a,p,b;if(this.existPortLabel(s)){if(e=h.Markup.renderMarkup(this.getPortLabelMarkup(s.label)),p=e.elem,b=e.selectors,p==null)throw new Error("Invalid port label markup.");if(a&&b){for(const _ in b)if(a[_]&&_!==this.rootSelector)throw new Error("Selectors within port must be unique.");m=Object.assign(Object.assign({},a),b)}r.Dom.addClass(p,"x6-port-label"),t.appendChild(p)}return this.portsCache[s.id]={portElement:t,portSelectors:m,portLabelElement:p,portLabelSelectors:b,portContentElement:n,portContentSelectors:a},this.graph.options.onPortRendered&&this.graph.options.onPortRendered({port:s,node:this.cell,container:t,selectors:m,labelContainer:p,labelSelectors:b,contentContainer:n,contentSelectors:a}),t}updatePorts(){const s=this.cell.getParsedGroups(),e=Object.keys(s);e.length===0?this.updatePortGroup():e.forEach(t=>this.updatePortGroup(t))}updatePortGroup(s){const e=i.Rectangle.fromSize(this.cell.getSize()),t=this.cell.getPortsLayoutByGroup(s,e);for(let n=0,a=t.length;n<a;n+=1){const d=t[n],m=d.portId,p=this.portsCache[m]||{},b=d.portLayout;if(this.applyPortTransform(p.portElement,b),d.portAttrs!=null){const _={selectors:p.portSelectors||{}};d.portSize&&(_.rootBBox=i.Rectangle.fromSize(d.portSize)),this.updateAttrs(p.portElement,d.portAttrs,_)}const y=d.labelLayout;if(y&&p.portLabelElement&&(this.applyPortTransform(p.portLabelElement,y,-(b.angle||0)),y.attrs)){const _={selectors:p.portLabelSelectors||{}};d.labelSize&&(_.rootBBox=i.Rectangle.fromSize(d.labelSize)),this.updateAttrs(p.portLabelElement,y.attrs,_)}}}applyPortTransform(s,e,t=0){const n=e.angle,a=e.position,d=r.Dom.createSVGMatrix().rotate(t).translate(a.x||0,a.y||0).rotate(n||0);r.Dom.transform(s,d,{absolute:!0})}getPortMarkup(s){return s.markup||this.cell.portMarkup}getPortLabelMarkup(s){return s.markup||this.cell.portLabelMarkup}existPortLabel(s){return s.attrs&&s.attrs.text}getEventArgs(s,e,t){const n=this,a=n.cell,d=a;return e==null||t==null?{e:s,view:n,node:a,cell:d}:{e:s,x:e,y:t,view:n,node:a,cell:d}}getPortEventArgs(s,e,t){const n=this,a=n.cell,d=a;return t?{e:s,x:t.x,y:t.y,view:n,node:a,cell:d,port:e}:{e:s,view:n,node:a,cell:d,port:e}}notifyMouseDown(s,e,t){super.onMouseDown(s,e,t),this.notify("node:mousedown",this.getEventArgs(s,e,t))}notifyMouseMove(s,e,t){super.onMouseMove(s,e,t),this.notify("node:mousemove",this.getEventArgs(s,e,t))}notifyMouseUp(s,e,t){super.onMouseUp(s,e,t),this.notify("node:mouseup",this.getEventArgs(s,e,t))}notifyPortEvent(s,e,t){const n=this.findAttr("port",e.target);if(n){const a=e.type;s==="node:port:mouseenter"?e.type="mouseenter":s==="node:port:mouseleave"&&(e.type="mouseleave"),this.notify(s,this.getPortEventArgs(e,n,t)),e.type=a}}onClick(s,e,t){super.onClick(s,e,t),this.notify("node:click",this.getEventArgs(s,e,t)),this.notifyPortEvent("node:port:click",s,{x:e,y:t})}onDblClick(s,e,t){super.onDblClick(s,e,t),this.notify("node:dblclick",this.getEventArgs(s,e,t)),this.notifyPortEvent("node:port:dblclick",s,{x:e,y:t})}onContextMenu(s,e,t){super.onContextMenu(s,e,t),this.notify("node:contextmenu",this.getEventArgs(s,e,t)),this.notifyPortEvent("node:port:contextmenu",s,{x:e,y:t})}onMouseDown(s,e,t){this.isPropagationStopped(s)||(this.notifyMouseDown(s,e,t),this.notifyPortEvent("node:port:mousedown",s,{x:e,y:t}),this.startNodeDragging(s,e,t))}onMouseMove(s,e,t){const n=this.getEventData(s),a=n.action;if(a==="magnet")this.dragMagnet(s,e,t);else{if(a==="move"){const m=n.targetView||this;m.dragNode(s,e,t),m.notify("node:moving",{e:s,x:e,y:t,view:m,cell:m.cell,node:m.cell})}this.notifyMouseMove(s,e,t),this.notifyPortEvent("node:port:mousemove",s,{x:e,y:t})}this.setEventData(s,n)}onMouseUp(s,e,t){const n=this.getEventData(s),a=n.action;a==="magnet"?this.stopMagnetDragging(s,e,t):(this.notifyMouseUp(s,e,t),this.notifyPortEvent("node:port:mouseup",s,{x:e,y:t}),a==="move"&&(n.targetView||this).stopNodeDragging(s,e,t));const d=n.targetMagnet;d&&this.onMagnetClick(s,d,e,t),this.checkMouseleave(s)}onMouseOver(s){super.onMouseOver(s),this.notify("node:mouseover",this.getEventArgs(s)),this.notifyPortEvent("node:port:mouseenter",s),this.notifyPortEvent("node:port:mouseover",s)}onMouseOut(s){super.onMouseOut(s),this.notify("node:mouseout",this.getEventArgs(s)),this.notifyPortEvent("node:port:mouseleave",s),this.notifyPortEvent("node:port:mouseout",s)}onMouseEnter(s){this.updateClassName(s),super.onMouseEnter(s),this.notify("node:mouseenter",this.getEventArgs(s))}onMouseLeave(s){super.onMouseLeave(s),this.notify("node:mouseleave",this.getEventArgs(s))}onMouseWheel(s,e,t,n){super.onMouseWheel(s,e,t,n),this.notify("node:mousewheel",Object.assign({delta:n},this.getEventArgs(s,e,t)))}onMagnetClick(s,e,t,n){const a=this.graph;a.view.getMouseMovedCount(s)>a.options.clickThreshold||this.notify("node:magnet:click",Object.assign({magnet:e},this.getEventArgs(s,t,n)))}onMagnetDblClick(s,e,t,n){this.notify("node:magnet:dblclick",Object.assign({magnet:e},this.getEventArgs(s,t,n)))}onMagnetContextMenu(s,e,t,n){this.notify("node:magnet:contextmenu",Object.assign({magnet:e},this.getEventArgs(s,t,n)))}onMagnetMouseDown(s,e,t,n){this.startMagnetDragging(s,t,n)}onCustomEvent(s,e,t,n){this.notify("node:customevent",Object.assign({name:e},this.getEventArgs(s,t,n))),super.onCustomEvent(s,e,t,n)}prepareEmbedding(s){const e=this.graph,n=this.getEventData(s).cell||this.cell,a=e.findViewByCell(n),d=e.snapToGrid(s.clientX,s.clientY);this.notify("node:embed",{e:s,node:n,view:a,cell:n,x:d.x,y:d.y,currentParent:n.getParent()})}processEmbedding(s,e){const t=e.cell||this.cell,n=e.graph||this.graph,a=n.options.embedding,d=a.findParent;let m=typeof d=="function"?r.FunctionExt.call(d,n,{view:this,node:this.cell}).filter(O=>c.Cell.isCell(O)&&this.cell.id!==O.id&&!O.isDescendantOf(this.cell)):n.model.getNodesUnderNode(t,{by:d});if(a.frontOnly&&m.length>0){const O=r.ArrayExt.groupBy(m,"zIndex"),x=r.ArrayExt.max(Object.keys(O).map(C=>parseInt(C,10)));x&&(m=O[x])}m=m.filter(O=>O.visible);let p=null;const b=e.candidateEmbedView,y=a.validate;for(let O=m.length-1;O>=0;O-=1){const x=m[O];if(b&&b.cell.id===x.id){p=b;break}else{const C=x.findView(n);if(y&&r.FunctionExt.call(y,n,{child:this.cell,parent:C.cell,childView:this,parentView:C})){p=C;break}}}this.clearEmbedding(e),p&&p.highlight(null,{type:"embedding"}),e.candidateEmbedView=p;const _=n.snapToGrid(s.clientX,s.clientY);this.notify("node:embedding",{e:s,cell:t,node:t,view:n.findViewByCell(t),x:_.x,y:_.y,currentParent:t.getParent(),candidateParent:p?p.cell:null})}clearEmbedding(s){const e=s.candidateEmbedView;e&&(e.unhighlight(null,{type:"embedding"}),s.candidateEmbedView=null)}finalizeEmbedding(s,e){this.graph.startBatch("embedding");const t=e.cell||this.cell,n=e.graph||this.graph,a=n.findViewByCell(t),d=t.getParent(),m=e.candidateEmbedView;if(m?(m.unhighlight(null,{type:"embedding"}),e.candidateEmbedView=null,(d==null||d.id!==m.cell.id)&&m.cell.insertChild(t,void 0,{ui:!0})):d&&d.unembed(t,{ui:!0}),n.model.getConnectedEdges(t,{deep:!0}).forEach(p=>{p.updateParent({ui:!0})}),a&&m){const p=n.snapToGrid(s.clientX,s.clientY);a.notify("node:embedded",{e:s,cell:t,x:p.x,y:p.y,node:t,view:n.findViewByCell(t),previousParent:d,currentParent:t.getParent()})}this.graph.stopBatch("embedding")}getDelegatedView(){let s=this.cell,e=this;for(;e&&!s.isEdge();){if(!s.hasParent()||e.can("stopDelegateOnDragging"))return e;s=s.getParent(),e=this.graph.findViewByCell(s)}return null}validateMagnet(s,e,t){if(e.getAttribute("magnet")!=="passive"){const n=this.graph.options.connecting.validateMagnet;return n?r.FunctionExt.call(n,this.graph,{e:t,magnet:e,view:s,cell:s.cell}):!0}return!1}startMagnetDragging(s,e,t){if(!this.can("magnetConnectable"))return;s.stopPropagation();const n=s.currentTarget,a=this.graph;this.setEventData(s,{targetMagnet:n}),this.validateMagnet(this,n,s)?(a.options.magnetThreshold<=0&&this.startConnectting(s,n,e,t),this.setEventData(s,{action:"magnet"}),this.stopPropagation(s)):this.onMouseDown(s,e,t),a.view.delegateDragEvents(s,this)}startConnectting(s,e,t,n){this.graph.model.startBatch("add-edge");const a=this.createEdgeFromMagnet(e,t,n);a.setEventData(s,a.prepareArrowheadDragging("target",{x:t,y:n,isNewEdge:!0,fallbackAction:"remove"})),this.setEventData(s,{edgeView:a}),a.notifyMouseDown(s,t,n)}getDefaultEdge(s,e){let t;const n=this.graph.options.connecting.createEdge;return n&&(t=r.FunctionExt.call(n,this.graph,{sourceMagnet:e,sourceView:s,sourceCell:s.cell})),t}createEdgeFromMagnet(s,e,t){const n=this.graph,a=n.model,d=this.getDefaultEdge(this,s);return d.setSource(Object.assign(Object.assign({},d.getSource()),this.getEdgeTerminal(s,e,t,d,"source"))),d.setTarget(Object.assign(Object.assign({},d.getTarget()),{x:e,y:t})),d.addTo(a,{async:!1,ui:!0}),d.findView(n)}dragMagnet(s,e,t){const n=this.getEventData(s),a=n.edgeView;if(a)a.onMouseMove(s,e,t),this.autoScrollGraph(s.clientX,s.clientY);else{const d=this.graph,m=d.options.magnetThreshold,p=this.getEventTarget(s),b=n.targetMagnet;if(m==="onleave"){if(b===p||b.contains(p))return}else if(d.view.getMouseMovedCount(s)<=m)return;this.startConnectting(s,b,e,t)}}stopMagnetDragging(s,e,t){const a=this.eventData(s).edgeView;a&&(a.onMouseUp(s,e,t),this.graph.model.stopBatch("add-edge"))}notifyUnhandledMouseDown(s,e,t){this.notify("node:unhandled:mousedown",{e:s,x:e,y:t,view:this,cell:this.cell,node:this.cell})}notifyNodeMove(s,e,t,n,a){let d=[a];const m=this.graph.getPlugin("selection");if(m&&m.isSelectionMovable()){const p=m.getSelectedCells();p.includes(a)&&(d=p.filter(b=>b.isNode()))}d.forEach(p=>{this.notify(s,{e,x:t,y:n,cell:p,node:p,view:p.findView(this.graph)})})}getRestrictArea(s){const e=this.graph.options.translating.restrict,t=typeof e=="function"?r.FunctionExt.call(e,this.graph,s):e;return typeof t=="number"?this.graph.transform.getGraphArea().inflate(t):t===!0?this.graph.transform.getGraphArea():t||null}startNodeDragging(s,e,t){const n=this.getDelegatedView();if(n==null||!n.can("nodeMovable"))return this.notifyUnhandledMouseDown(s,e,t);this.setEventData(s,{targetView:n,action:"move"});const a=i.Point.create(n.cell.getPosition());n.setEventData(s,{moving:!1,offset:a.diff(e,t),restrict:this.getRestrictArea(n)})}dragNode(s,e,t){const n=this.cell,a=this.graph,d=a.getGridSize(),m=this.getEventData(s),p=m.offset,b=m.restrict;m.moving||(m.moving=!0,this.addClass("node-moving"),this.notifyNodeMove("node:move",s,e,t,this.cell)),this.autoScrollGraph(s.clientX,s.clientY);const y=i.GeometryUtil.snapToGrid(e+p.x,d),_=i.GeometryUtil.snapToGrid(t+p.y,d);n.setPosition(y,_,{restrict:b,deep:!0,ui:!0}),a.options.embedding.enabled&&(m.embedding||(this.prepareEmbedding(s),m.embedding=!0),this.processEmbedding(s,m))}stopNodeDragging(s,e,t){const n=this.getEventData(s);n.embedding&&this.finalizeEmbedding(s,n),n.moving&&(this.removeClass("node-moving"),this.notifyNodeMove("node:moved",s,e,t,this.cell)),n.moving=!1,n.embedding=!1}autoScrollGraph(s,e){const t=this.graph.getPlugin("scroller");t&&t.autoScroll(s,e)}}o.NodeView=u,function(g){g.toStringTag=`X6.${g.name}`;function s(e){if(e==null)return!1;if(e instanceof g)return!0;const t=e[Symbol.toStringTag],n=e;return(t==null||t===g.toStringTag)&&typeof n.isNodeView=="function"&&typeof n.isEdgeView=="function"&&typeof n.confirmUpdate=="function"&&typeof n.update=="function"&&typeof n.findPortElem=="function"&&typeof n.resize=="function"&&typeof n.rotate=="function"&&typeof n.translate=="function"}g.isNodeView=s}(u=o.NodeView||(o.NodeView={})),u.config({isSvgElement:!0,priority:0,bootstrap:["render"],actions:{view:["render"],markup:["render"],attrs:["update"],size:["resize","ports","tools"],angle:["rotate","tools"],position:["translate","tools"],ports:["ports"],tools:["tools"]}}),u.registry.register("node",u,!0)})(In);(function(o){var r=w&&w.__rest||function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(t[n[a]]=s[n[a]]);return t};Object.defineProperty(o,"__esModule",{value:!0}),o.EdgeView=void 0;const i=B,l=D,c=ae,f=it,h=sn(),u=In;class g extends h.CellView{constructor(){super(...arguments),this.POINT_ROUNDING=2,this.labelDestroyFn={}}get[Symbol.toStringTag](){return g.toStringTag}getContainerClassName(){return[super.getContainerClassName(),this.prefixClassName("edge")].join(" ")}get sourceBBox(){const e=this.sourceView;if(!e){const n=this.cell.getSource();return new i.Rectangle(n.x,n.y)}const t=this.sourceMagnet;return e.isEdgeElement(t)?new i.Rectangle(this.sourceAnchor.x,this.sourceAnchor.y):e.getBBoxOfElement(t||e.container)}get targetBBox(){const e=this.targetView;if(!e){const n=this.cell.getTarget();return new i.Rectangle(n.x,n.y)}const t=this.targetMagnet;return e.isEdgeElement(t)?new i.Rectangle(this.targetAnchor.x,this.targetAnchor.y):e.getBBoxOfElement(t||e.container)}isEdgeView(){return!0}confirmUpdate(e,t={}){let n=e;if(this.hasAction(n,"source")){if(!this.updateTerminalProperties("source"))return n;n=this.removeAction(n,"source")}if(this.hasAction(n,"target")){if(!this.updateTerminalProperties("target"))return n;n=this.removeAction(n,"target")}return this.hasAction(n,"render")?(this.render(),n=this.removeAction(n,["render","update","labels","tools"]),n):(n=this.handleAction(n,"update",()=>this.update(t)),n=this.handleAction(n,"labels",()=>this.onLabelsChange(t)),n=this.handleAction(n,"tools",()=>this.renderTools()),n)}render(){return this.empty(),this.renderMarkup(),this.labelContainer=null,this.renderLabels(),this.update(),this.renderTools(),this}renderMarkup(){const e=this.cell.markup;if(e){if(typeof e=="string")throw new TypeError("Not support string markup.");return this.renderJSONMarkup(e)}throw new TypeError("Invalid edge markup.")}renderJSONMarkup(e){const t=this.parseJSONMarkup(e,this.container);this.selectors=t.selectors,this.container.append(t.fragment)}customizeLabels(){if(this.labelContainer){const e=this.cell,t=e.labels;for(let n=0,a=t.length;n<a;n+=1){const d=t[n],m=this.labelCache[n],p=this.labelSelectors[n],b=this.graph.options.onEdgeLabelRendered;if(b){const y=b({edge:e,label:d,container:m,selectors:p});y&&(this.labelDestroyFn[n]=y)}}}}destroyCustomizeLabels(){const e=this.cell.labels;if(this.labelCache&&this.labelSelectors&&this.labelDestroyFn)for(let t=0,n=e.length;t<n;t+=1){const a=this.labelDestroyFn[t],d=this.labelCache[t],m=this.labelSelectors[t];a&&d&&m&&a({edge:this.cell,label:e[t],container:d,selectors:m})}this.labelDestroyFn={}}renderLabels(){const e=this.cell,t=e.getLabels(),n=t.length;let a=this.labelContainer;if(this.labelCache={},this.labelSelectors={},n<=0)return a&&a.parentNode&&a.parentNode.removeChild(a),this;a?this.empty(a):(a=l.Dom.createSvgElement("g"),this.addClass(this.prefixClassName("edge-labels"),a),this.labelContainer=a);for(let d=0,m=t.length;d<m;d+=1){const p=t[d],b=this.normalizeLabelMarkup(this.parseLabelMarkup(p.markup));let y,_;if(b)y=b.node,_=b.selectors;else{const x=e.getDefaultLabel(),C=this.normalizeLabelMarkup(this.parseLabelMarkup(x.markup));y=C.node,_=C.selectors}y.setAttribute("data-index",`${d}`),a.appendChild(y);const O=this.rootSelector;if(_[O])throw new Error("Ambiguous label root selector.");_[O]=y,this.labelCache[d]=y,this.labelSelectors[d]=_}return a.parentNode==null&&this.container.appendChild(a),this.updateLabels(),this.customizeLabels(),this}onLabelsChange(e={}){this.destroyCustomizeLabels(),this.shouldRerenderLabels(e)?this.renderLabels():this.updateLabels(),this.updateLabelPositions()}shouldRerenderLabels(e={}){const t=this.cell.previous("labels");if(t==null)return!0;if("propertyPathArray"in e&&"propertyValue"in e){const n=e.propertyPathArray||[],a=n.length;if(a>1){const d=n[1];if(t[d]){if(a===2)return typeof e.propertyValue=="object"&&l.ObjectExt.has(e.propertyValue,"markup");if(n[2]!=="markup")return!1}}}return!0}parseLabelMarkup(e){return e?typeof e=="string"?this.parseLabelStringMarkup(e):this.parseJSONMarkup(e):null}parseLabelStringMarkup(e){const t=l.Vector.createVectors(e),n=document.createDocumentFragment();for(let a=0,d=t.length;a<d;a+=1){const m=t[a].node;n.appendChild(m)}return{fragment:n,selectors:{}}}normalizeLabelMarkup(e){if(e==null)return;const t=e.fragment;if(!(t instanceof DocumentFragment)||!t.hasChildNodes())throw new Error("Invalid label markup.");let n;const a=t.childNodes;return a.length>1||a[0].nodeName.toUpperCase()!=="G"?n=l.Vector.create("g").append(t):n=l.Vector.create(a[0]),n.addClass(this.prefixClassName("edge-label")),{node:n.node,selectors:e.selectors}}updateLabels(){if(this.labelContainer){const e=this.cell,t=e.labels,n=this.can("edgeLabelMovable"),a=e.getDefaultLabel();for(let d=0,m=t.length;d<m;d+=1){const p=this.labelCache[d],b=this.labelSelectors[d];p.setAttribute("cursor",n?"move":"default");const y=t[d],_=l.ObjectExt.merge({},a.attrs,y.attrs);this.updateAttrs(p,_,{selectors:b,rootBBox:y.size?i.Rectangle.fromSize(y.size):void 0})}}}renderTools(){const e=this.cell.getTools();return this.addTools(e),this}update(e={}){this.cleanCache(),this.updateConnection(e);const t=this.cell.getAttrs(),n=r(t,["text"]);return n!=null&&this.updateAttrs(this.container,n,{selectors:this.selectors}),this.updateLabelPositions(),this.updateTools(e),this}removeRedundantLinearVertices(e={}){const t=this.cell,n=t.getVertices(),a=[this.sourceAnchor,...n,this.targetAnchor],d=a.length,m=new i.Polyline(a);m.simplify({threshold:.01});const p=m.points.map(y=>y.toJSON()),b=p.length;return d===b?0:(t.setVertices(p.slice(1,b-1),e),d-b)}getTerminalView(e){switch(e){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error(`Unknown terminal type '${e}'`)}}getTerminalAnchor(e){switch(e){case"source":return i.Point.create(this.sourceAnchor);case"target":return i.Point.create(this.targetAnchor);default:throw new Error(`Unknown terminal type '${e}'`)}}getTerminalConnectionPoint(e){switch(e){case"source":return i.Point.create(this.sourcePoint);case"target":return i.Point.create(this.targetPoint);default:throw new Error(`Unknown terminal type '${e}'`)}}getTerminalMagnet(e,t={}){switch(e){case"source":{if(t.raw)return this.sourceMagnet;const n=this.sourceView;return n?this.sourceMagnet||n.container:null}case"target":{if(t.raw)return this.targetMagnet;const n=this.targetView;return n?this.targetMagnet||n.container:null}default:throw new Error(`Unknown terminal type '${e}'`)}}updateConnection(e={}){const t=this.cell;if(e.translateBy&&t.isFragmentDescendantOf(e.translateBy)){const n=e.tx||0,a=e.ty||0;this.routePoints=new i.Polyline(this.routePoints).translate(n,a).points,this.translateConnectionPoints(n,a),this.path.translate(n,a)}else{const n=t.getVertices(),a=this.findAnchors(n);this.sourceAnchor=a.source,this.targetAnchor=a.target,this.routePoints=this.findRoutePoints(n);const d=this.findConnectionPoints(this.routePoints,this.sourceAnchor,this.targetAnchor);this.sourcePoint=d.source,this.targetPoint=d.target;const m=this.findMarkerPoints(this.routePoints,this.sourcePoint,this.targetPoint);this.path=this.findPath(this.routePoints,m.source||this.sourcePoint,m.target||this.targetPoint)}this.cleanCache()}findAnchors(e){const t=this.cell,n=t.source,a=t.target,d=e[0],m=e[e.length-1];return a.priority&&!n.priority?this.findAnchorsOrdered("target",m,"source",d):this.findAnchorsOrdered("source",d,"target",m)}findAnchorsOrdered(e,t,n,a){let d,m;const p=this.cell,b=p[e],y=p[n],_=this.getTerminalView(e),O=this.getTerminalView(n),x=this.getTerminalMagnet(e),C=this.getTerminalMagnet(n);if(_){let M;t?M=i.Point.create(t):O?M=C:M=i.Point.create(y),d=this.getAnchor(b.anchor,_,x,M,e)}else d=i.Point.create(b);if(O){const M=i.Point.create(a||d);m=this.getAnchor(y.anchor,O,C,M,n)}else m=i.Point.isPointLike(y)?i.Point.create(y):new i.Point;return{[e]:d,[n]:m}}getAnchor(e,t,n,a,d){const m=t.isEdgeElement(n),p=this.graph.options.connecting;let b=typeof e=="string"?{name:e}:e;if(!b){const O=m?(d==="source"?p.sourceEdgeAnchor:p.targetEdgeAnchor)||p.edgeAnchor:(d==="source"?p.sourceAnchor:p.targetAnchor)||p.anchor;b=typeof O=="string"?{name:O}:O}if(!b)throw new Error("Anchor should be specified.");let y;const _=b.name;if(m){const O=c.EdgeAnchor.registry.get(_);if(typeof O!="function")return c.EdgeAnchor.registry.onNotFound(_);y=l.FunctionExt.call(O,this,t,n,a,b.args||{},d)}else{const O=c.NodeAnchor.registry.get(_);if(typeof O!="function")return c.NodeAnchor.registry.onNotFound(_);y=l.FunctionExt.call(O,this,t,n,a,b.args||{},d)}return y?y.round(this.POINT_ROUNDING):new i.Point}findRoutePoints(e=[]){const t=this.graph.options.connecting.router||c.Router.presets.normal,n=this.cell.getRouter()||t;let a;if(typeof n=="function")a=l.FunctionExt.call(n,this,e,{},this);else{const d=typeof n=="string"?n:n.name,m=typeof n=="string"?{}:n.args||{},p=d?c.Router.registry.get(d):c.Router.presets.normal;if(typeof p!="function")return c.Router.registry.onNotFound(d);a=l.FunctionExt.call(p,this,e,m,this)}return a==null?e.map(d=>i.Point.create(d)):a.map(d=>i.Point.create(d))}findConnectionPoints(e,t,n){const a=this.cell,d=this.graph.options.connecting,m=a.getSource(),p=a.getTarget(),b=this.sourceView,y=this.targetView,_=e[0],O=e[e.length-1];let x;if(b&&!b.isEdgeElement(this.sourceMagnet)){const M=this.sourceMagnet||b.container,A=_||n,j=new i.Line(A,t),v=m.connectionPoint||d.sourceConnectionPoint||d.connectionPoint;x=this.getConnectionPoint(v,b,M,j,"source")}else x=t;let C;if(y&&!y.isEdgeElement(this.targetMagnet)){const M=this.targetMagnet||y.container,A=p.connectionPoint||d.targetConnectionPoint||d.connectionPoint,j=O||t,v=new i.Line(j,n);C=this.getConnectionPoint(A,y,M,v,"target")}else C=n;return{source:x,target:C}}getConnectionPoint(e,t,n,a,d){const m=a.end;if(e==null)return m;const p=typeof e=="string"?e:e.name,b=typeof e=="string"?{}:e.args,y=c.ConnectionPoint.registry.get(p);if(typeof y!="function")return c.ConnectionPoint.registry.onNotFound(p);const _=l.FunctionExt.call(y,this,a,t,n,b||{},d);return _?_.round(this.POINT_ROUNDING):m}findMarkerPoints(e,t,n){const a=O=>{const x=this.cell.getAttrs(),C=Object.keys(x);for(let M=0,A=C.length;M<A;M+=1){const j=x[C[M]];if(j[`${O}Marker`]||j[`${O}-marker`]){const v=j.strokeWidth||j["stroke-width"];if(v)return parseFloat(v);break}}return null},d=e[0],m=e[e.length-1];let p,b;const y=a("source");y&&(p=t.clone().move(d||n,-y));const _=a("target");return _&&(b=n.clone().move(m||t,-_)),this.sourceMarkerPoint=p||t.clone(),this.targetMarkerPoint=b||n.clone(),{source:p,target:b}}findPath(e,t,n){const a=this.cell.getConnector()||this.graph.options.connecting.connector;let d,m,p;if(typeof a=="string"?d=a:(d=a.name,m=a.args),d){const y=c.Connector.registry.get(d);if(typeof y!="function")return c.Connector.registry.onNotFound(d);p=y}else p=c.Connector.presets.normal;const b=l.FunctionExt.call(p,this,t,n,e,Object.assign(Object.assign({},m),{raw:!0}),this);return typeof b=="string"?i.Path.parse(b):b}translateConnectionPoints(e,t){this.sourcePoint.translate(e,t),this.targetPoint.translate(e,t),this.sourceAnchor.translate(e,t),this.targetAnchor.translate(e,t),this.sourceMarkerPoint.translate(e,t),this.targetMarkerPoint.translate(e,t)}updateLabelPositions(){if(this.labelContainer==null)return this;if(!this.path)return this;const t=this.cell,n=t.getLabels();if(n.length===0)return this;const a=t.getDefaultLabel(),d=this.normalizeLabelPosition(a.position);for(let m=0,p=n.length;m<p;m+=1){const b=n[m],y=this.labelCache[m];if(!y)continue;const _=this.normalizeLabelPosition(b.position),O=l.ObjectExt.merge({},d,_),x=this.getLabelTransformationMatrix(O);y.setAttribute("transform",l.Dom.matrixToTransformString(x))}return this}updateTerminalProperties(e){const t=this.cell,n=this.graph,a=t[e],d=a&&a.cell,m=`${e}View`;if(!d)return this[m]=null,this.updateTerminalMagnet(e),!0;const p=n.getCellById(d);if(!p)throw new Error(`Edge's ${e} node with id "${d}" not exists`);const b=p.findView(n);return b?(this[m]=b,this.updateTerminalMagnet(e),!0):!1}updateTerminalMagnet(e){const t=`${e}Magnet`,n=this.getTerminalView(e);if(n){let a=n.getMagnetFromEdgeTerminal(this.cell[e]);a===n.container&&(a=null),this[t]=a}else this[t]=null}getLabelPositionAngle(e){const t=this.cell.getLabelAt(e);return t&&t.position&&typeof t.position=="object"&&t.position.angle||0}getLabelPositionArgs(e){const t=this.cell.getLabelAt(e);if(t&&t.position&&typeof t.position=="object")return t.position.options}getDefaultLabelPositionArgs(){const e=this.cell.getDefaultLabel();if(e&&e.position&&typeof e.position=="object")return e.position.options}mergeLabelPositionArgs(e,t){return e===null?null:e===void 0?t===null?null:t:l.ObjectExt.merge({},t,e)}getConnection(){return this.path!=null?this.path.clone():null}getConnectionPathData(){if(this.path==null)return"";const e=this.cache.pathCache;return l.ObjectExt.has(e,"data")||(e.data=this.path.serialize()),e.data||""}getConnectionSubdivisions(){if(this.path==null)return null;const e=this.cache.pathCache;return l.ObjectExt.has(e,"segmentSubdivisions")||(e.segmentSubdivisions=this.path.getSegmentSubdivisions()),e.segmentSubdivisions}getConnectionLength(){if(this.path==null)return 0;const e=this.cache.pathCache;return l.ObjectExt.has(e,"length")||(e.length=this.path.length({segmentSubdivisions:this.getConnectionSubdivisions()})),e.length}getPointAtLength(e){return this.path==null?null:this.path.pointAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getPointAtRatio(e){return this.path==null?null:(l.NumberExt.isPercentage(e)&&(e=parseFloat(e)/100),this.path.pointAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()}))}getTangentAtLength(e){return this.path==null?null:this.path.tangentAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getTangentAtRatio(e){return this.path==null?null:this.path.tangentAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPoint(e){return this.path==null?null:this.path.closestPoint(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointLength(e){return this.path==null?null:this.path.closestPointLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointRatio(e){return this.path==null?null:this.path.closestPointNormalizedLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}getLabelPosition(e,t,n,a){const d={distance:0};let m=0,p;typeof n=="number"?(m=n,p=a):p=n,p!=null&&(d.options=p);const b=p&&p.absoluteOffset,y=!(p&&p.absoluteDistance),_=p&&p.absoluteDistance&&p.reverseDistance,O=this.path,x={segmentSubdivisions:this.getConnectionSubdivisions()},C=new i.Point(e,t),M=O.closestPointT(C,x),A=this.getConnectionLength()||0;let j=O.lengthAtT(M,x);y&&(j=A>0?j/A:0),_&&(j=-1*(A-j)||1),d.distance=j;let v;b||(v=O.tangentAtT(M));let P;if(v)P=v.pointOffset(C);else{const E=O.pointAtT(M),S=C.diff(E);P={x:S.x,y:S.y}}return d.offset=P,d.angle=m,d}normalizeLabelPosition(e){return typeof e=="number"?{distance:e}:e}getLabelTransformationMatrix(e){const t=this.normalizeLabelPosition(e),n=t.options||{},a=t.angle||0,d=t.distance,m=d>0&&d<=1;let p=0;const b={x:0,y:0},y=t.offset;y&&(typeof y=="number"?p=y:(y.x!=null&&(b.x=y.x),y.y!=null&&(b.y=y.y)));const _=b.x!==0||b.y!==0||p===0,O=n.keepGradient,x=n.ensureLegibility,C=this.path,M={segmentSubdivisions:this.getConnectionSubdivisions()},A=m?d*this.getConnectionLength():d,j=C.tangentAtLength(A,M);let v,P=a;if(j){if(_)v=j.start,v.translate(b);else{const E=j.clone();E.rotate(-90,j.start),E.setLength(p),v=E.end}O&&(P=j.angle()+a,x&&(P=i.Angle.normalize((P+90)%180-90)))}else v=C.start,_&&v.translate(b);return l.Dom.createSVGMatrix().translate(v.x,v.y).rotate(P)}getVertexIndex(e,t){const a=this.cell.getVertices(),d=this.getClosestPointLength(new i.Point(e,t));let m=0;if(d!=null)for(const p=a.length;m<p;m+=1){const b=a[m],y=this.getClosestPointLength(b);if(y!=null&&d<y)break}return m}getEventArgs(e,t,n){const a=this,d=a.cell,m=d;return t==null||n==null?{e,view:a,edge:d,cell:m}:{e,x:t,y:n,view:a,edge:d,cell:m}}notifyUnhandledMouseDown(e,t,n){this.notify("edge:unhandled:mousedown",{e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})}notifyMouseDown(e,t,n){super.onMouseDown(e,t,n),this.notify("edge:mousedown",this.getEventArgs(e,t,n))}notifyMouseMove(e,t,n){super.onMouseMove(e,t,n),this.notify("edge:mousemove",this.getEventArgs(e,t,n))}notifyMouseUp(e,t,n){super.onMouseUp(e,t,n),this.notify("edge:mouseup",this.getEventArgs(e,t,n))}onClick(e,t,n){super.onClick(e,t,n),this.notify("edge:click",this.getEventArgs(e,t,n))}onDblClick(e,t,n){super.onDblClick(e,t,n),this.notify("edge:dblclick",this.getEventArgs(e,t,n))}onContextMenu(e,t,n){super.onContextMenu(e,t,n),this.notify("edge:contextmenu",this.getEventArgs(e,t,n))}onMouseDown(e,t,n){this.notifyMouseDown(e,t,n),this.startEdgeDragging(e,t,n)}onMouseMove(e,t,n){const a=this.getEventData(e);switch(a.action){case"drag-label":{this.dragLabel(e,t,n);break}case"drag-arrowhead":{this.dragArrowhead(e,t,n);break}case"drag-edge":{this.dragEdge(e,t,n);break}}return this.notifyMouseMove(e,t,n),a}onMouseUp(e,t,n){const a=this.getEventData(e);switch(a.action){case"drag-label":{this.stopLabelDragging(e,t,n);break}case"drag-arrowhead":{this.stopArrowheadDragging(e,t,n);break}case"drag-edge":{this.stopEdgeDragging(e,t,n);break}}return this.notifyMouseUp(e,t,n),this.checkMouseleave(e),a}onMouseOver(e){super.onMouseOver(e),this.notify("edge:mouseover",this.getEventArgs(e))}onMouseOut(e){super.onMouseOut(e),this.notify("edge:mouseout",this.getEventArgs(e))}onMouseEnter(e){super.onMouseEnter(e),this.notify("edge:mouseenter",this.getEventArgs(e))}onMouseLeave(e){super.onMouseLeave(e),this.notify("edge:mouseleave",this.getEventArgs(e))}onMouseWheel(e,t,n,a){super.onMouseWheel(e,t,n,a),this.notify("edge:mousewheel",Object.assign({delta:a},this.getEventArgs(e,t,n)))}onCustomEvent(e,t,n,a){if(l.Dom.findParentByClass(e.target,"edge-tool",this.container)){if(e.stopPropagation(),this.can("useEdgeTools")){if(t==="edge:remove"){this.cell.remove({ui:!0});return}this.notify("edge:customevent",Object.assign({name:t},this.getEventArgs(e,n,a)))}this.notifyMouseDown(e,n,a)}else this.notify("edge:customevent",Object.assign({name:t},this.getEventArgs(e,n,a))),super.onCustomEvent(e,t,n,a)}onLabelMouseDown(e,t,n){this.notifyMouseDown(e,t,n),this.startLabelDragging(e,t,n),this.getEventData(e).stopPropagation&&e.stopPropagation()}startEdgeDragging(e,t,n){if(!this.can("edgeMovable")){this.notifyUnhandledMouseDown(e,t,n);return}this.setEventData(e,{x:t,y:n,moving:!1,action:"drag-edge"})}dragEdge(e,t,n){const a=this.getEventData(e);a.moving||(a.moving=!0,this.addClass("edge-moving"),this.notify("edge:move",{e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})),this.cell.translate(t-a.x,n-a.y,{ui:!0}),this.setEventData(e,{x:t,y:n}),this.notify("edge:moving",{e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})}stopEdgeDragging(e,t,n){const a=this.getEventData(e);a.moving&&(this.removeClass("edge-moving"),this.notify("edge:moved",{e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})),a.moving=!1}prepareArrowheadDragging(e,t){const n=this.getTerminalMagnet(e),a={action:"drag-arrowhead",x:t.x,y:t.y,isNewEdge:t.isNewEdge===!0,terminalType:e,initialMagnet:n,initialTerminal:l.ObjectExt.clone(this.cell[e]),fallbackAction:t.fallbackAction||"revert",getValidateConnectionArgs:this.createValidateConnectionArgs(e),options:t.options};return this.beforeArrowheadDragging(a),a}createValidateConnectionArgs(e){const t=[];t[4]=e,t[5]=this;let n,a=0,d=0;e==="source"?(a=2,n="target"):(d=2,n="source");const m=this.cell[n],p=m.cell;if(p){let b;const y=t[a]=this.graph.findViewByCell(p);y&&(b=y.getMagnetFromEdgeTerminal(m),b===y.container&&(b=void 0)),t[a+1]=b}return(b,y)=>(t[d]=b,t[d+1]=b.container===y?void 0:y,t)}beforeArrowheadDragging(e){e.zIndex=this.cell.zIndex,this.cell.toFront();const t=this.container.style;e.pointerEvents=t.pointerEvents,t.pointerEvents="none",this.graph.options.connecting.highlight&&this.highlightAvailableMagnets(e)}afterArrowheadDragging(e){e.zIndex!=null&&(this.cell.setZIndex(e.zIndex,{ui:!0}),e.zIndex=null);const t=this.container;t.style.pointerEvents=e.pointerEvents||"",this.graph.options.connecting.highlight&&this.unhighlightAvailableMagnets(e)}validateConnection(e,t,n,a,d,m,p){const b=this.graph.options.connecting,y=b.allowLoop,_=b.allowNode,O=b.allowEdge,x=b.allowPort,C=b.allowMulti,M=b.validateConnection,A=m?m.cell:null,j=d==="target"?n:e,v=d==="target"?a:t;let P=!0;const E=S=>{const T=d==="source"?p?p.port:null:A?A.getSourcePortId():null,R=d==="target"?p?p.port:null:A?A.getTargetPortId():null;return l.FunctionExt.call(S,this.graph,{edge:A,edgeView:m,sourceView:e,targetView:n,sourcePort:T,targetPort:R,sourceMagnet:t,targetMagnet:a,sourceCell:e?e.cell:null,targetCell:n?n.cell:null,type:d})};if(y!=null&&(typeof y=="boolean"?!y&&e===n&&(P=!1):P=E(y)),P&&x!=null&&(typeof x=="boolean"?!x&&v&&(P=!1):P=E(x)),P&&O!=null&&(typeof O=="boolean"?!O&&g.isEdgeView(j)&&(P=!1):P=E(O)),P&&_!=null&&v==null&&(typeof _=="boolean"?!_&&u.NodeView.isNodeView(j)&&(P=!1):P=E(_)),P&&C!=null&&m){const S=m.cell,T=d==="source"?p:S.getSource(),R=d==="target"?p:S.getTarget(),L=p?this.graph.getCellById(p.cell):null;if(T&&R&&T.cell&&R.cell&&L)if(typeof C=="function")P=E(C);else{const _e=this.graph.model.getConnectedEdges(L,{outgoing:d==="source",incoming:d==="target"});_e.length&&(C==="withPort"?_e.some(Q=>{const X=Q.getSource(),G=Q.getTarget();return X&&G&&X.cell===T.cell&&G.cell===R.cell&&X.port!=null&&X.port===T.port&&G.port!=null&&G.port===R.port})&&(P=!1):C||_e.some(Q=>{const X=Q.getSource(),G=Q.getTarget();return X&&G&&X.cell===T.cell&&G.cell===R.cell})&&(P=!1))}}return P&&M!=null&&(P=E(M)),P}allowConnectToBlank(e){const t=this.graph,a=t.options.connecting.allowBlank;if(typeof a!="function")return!!a;const d=t.findViewByCell(e),m=e.getSourceCell(),p=e.getTargetCell(),b=t.findViewByCell(m),y=t.findViewByCell(p);return l.FunctionExt.call(a,t,{edge:e,edgeView:d,sourceCell:m,targetCell:p,sourceView:b,targetView:y,sourcePort:e.getSourcePortId(),targetPort:e.getTargetPortId(),sourceMagnet:d.sourceMagnet,targetMagnet:d.targetMagnet})}validateEdge(e,t,n){const a=this.graph;if(!this.allowConnectToBlank(e)){const m=e.getSourceCellId(),p=e.getTargetCellId();if(!(m&&p))return!1}const d=a.options.connecting.validateEdge;return d?l.FunctionExt.call(d,a,{edge:e,type:t,previous:n}):!0}arrowheadDragging(e,t,n,a){a.x=t,a.y=n,a.currentTarget!==e&&(a.currentMagnet&&a.currentView&&a.currentView.unhighlight(a.currentMagnet,{type:"magnetAdsorbed"}),a.currentView=this.graph.findViewByElem(e),a.currentView?(a.currentMagnet=a.currentView.findMagnet(e),a.currentMagnet&&this.validateConnection(...a.getValidateConnectionArgs(a.currentView,a.currentMagnet),a.currentView.getEdgeTerminal(a.currentMagnet,t,n,this.cell,a.terminalType))?a.currentView.highlight(a.currentMagnet,{type:"magnetAdsorbed"}):a.currentMagnet=null):a.currentMagnet=null),a.currentTarget=e,this.cell.prop(a.terminalType,{x:t,y:n},Object.assign(Object.assign({},a.options),{ui:!0}))}arrowheadDragged(e,t,n){const a=e.currentView,d=e.currentMagnet;if(!d||!a)return;a.unhighlight(d,{type:"magnetAdsorbed"});const m=e.terminalType,p=a.getEdgeTerminal(d,t,n,this.cell,m);this.cell.setTerminal(m,p,{ui:!0})}snapArrowhead(e,t,n){const a=this.graph,{snap:d,allowEdge:m}=a.options.connecting,p=typeof d=="object"&&d.radius||50,b=typeof d=="object"&&d.anchor||"center",y=a.renderer.findViewsInArea({x:e-p,y:t-p,width:2*p,height:2*p},{nodeOnly:!0});if(m){const S=a.renderer.findEdgeViewsFromPoint({x:e,y:t},p).filter(T=>T!==this);y.push(...S)}const _=n.closestView||null,O=n.closestMagnet||null;n.closestView=null,n.closestMagnet=null;let x,C=Number.MAX_SAFE_INTEGER;const M=new i.Point(e,t);y.forEach(S=>{if(S.container.getAttribute("magnet")!=="false"){if(S.isNodeView())x=b==="center"?S.cell.getBBox().getCenter().distance(M):S.cell.getBBox().getNearestPointToPoint(M).distance(M);else if(S.isEdgeView()){const T=S.getClosestPoint(M);T?x=T.distance(M):x=Number.MAX_SAFE_INTEGER}x<p&&x<C&&(O===S.container||this.validateConnection(...n.getValidateConnectionArgs(S,null),S.getEdgeTerminal(S.container,e,t,this.cell,n.terminalType)))&&(C=x,n.closestView=S,n.closestMagnet=S.container)}S.container.querySelectorAll("[magnet]").forEach(T=>{if(T.getAttribute("magnet")!=="false"){const R=S.getBBoxOfElement(T);x=M.distance(R.getCenter()),x<p&&x<C&&(O===T||this.validateConnection(...n.getValidateConnectionArgs(S,T),S.getEdgeTerminal(T,e,t,this.cell,n.terminalType)))&&(C=x,n.closestView=S,n.closestMagnet=T)}})});let A;const j=n.terminalType,v=n.closestView,P=n.closestMagnet,E=O!==P;if(_&&E&&_.unhighlight(O,{type:"magnetAdsorbed"}),v){if(!E)return;v.highlight(P,{type:"magnetAdsorbed"}),A=v.getEdgeTerminal(P,e,t,this.cell,j)}else A={x:e,y:t};this.cell.setTerminal(j,A,{},Object.assign(Object.assign({},n.options),{ui:!0}))}snapArrowheadEnd(e){const t=e.closestView,n=e.closestMagnet;t&&n&&(t.unhighlight(n,{type:"magnetAdsorbed"}),e.currentMagnet=t.findMagnet(n)),e.closestView=null,e.closestMagnet=null}finishEmbedding(e){this.graph.options.embedding.enabled&&this.cell.updateParent()&&(e.zIndex=null)}fallbackConnection(e){switch(e.fallbackAction){case"remove":this.cell.remove({ui:!0});break;case"revert":default:this.cell.prop(e.terminalType,e.initialTerminal,{ui:!0});break}}notifyConnectionEvent(e,t){const n=e.terminalType,a=e.initialTerminal,d=this.cell[n];if(d&&!f.Edge.equalTerminals(a,d)){const p=this.graph,b=a,y=b.cell?p.getCellById(b.cell):null,_=b.port,O=y?p.findViewByCell(y):null,x=y||e.isNewEdge?null:i.Point.create(a).toJSON(),C=d,M=C.cell?p.getCellById(C.cell):null,A=C.port,j=M?p.findViewByCell(M):null,v=M?null:i.Point.create(d).toJSON();this.notify("edge:connected",{e:t,previousCell:y,previousPort:_,previousView:O,previousPoint:x,currentCell:M,currentView:j,currentPort:A,currentPoint:v,previousMagnet:e.initialMagnet,currentMagnet:e.currentMagnet,edge:this.cell,view:this,type:n,isNew:e.isNewEdge})}}highlightAvailableMagnets(e){const t=this.graph,n=t.model.getCells();e.marked={};for(let a=0,d=n.length;a<d;a+=1){const m=t.findViewByCell(n[a]);if(!m||m.cell.id===this.cell.id)continue;const p=Array.prototype.slice.call(m.container.querySelectorAll("[magnet]"));m.container.getAttribute("magnet")!=="false"&&p.push(m.container);const b=p.filter(y=>this.validateConnection(...e.getValidateConnectionArgs(m,y),m.getEdgeTerminal(y,e.x,e.y,this.cell,e.terminalType)));if(b.length>0){for(let y=0,_=b.length;y<_;y+=1)m.highlight(b[y],{type:"magnetAvailable"});m.highlight(null,{type:"nodeAvailable"}),e.marked[m.cell.id]=b}}}unhighlightAvailableMagnets(e){const t=e.marked||{};Object.keys(t).forEach(n=>{const a=this.graph.findViewByCell(n);a&&(t[n].forEach(m=>{a.unhighlight(m,{type:"magnetAvailable"})}),a.unhighlight(null,{type:"nodeAvailable"}))}),e.marked=null}startArrowheadDragging(e,t,n){if(!this.can("arrowheadMovable")){this.notifyUnhandledMouseDown(e,t,n);return}const d=e.target.getAttribute("data-terminal"),m=this.prepareArrowheadDragging(d,{x:t,y:n});this.setEventData(e,m)}dragArrowhead(e,t,n){const a=this.getEventData(e);this.graph.options.connecting.snap?this.snapArrowhead(t,n,a):this.arrowheadDragging(this.getEventTarget(e),t,n,a)}stopArrowheadDragging(e,t,n){const a=this.graph,d=this.getEventData(e);a.options.connecting.snap?this.snapArrowheadEnd(d):this.arrowheadDragged(d,t,n),this.validateEdge(this.cell,d.terminalType,d.initialTerminal)?(this.finishEmbedding(d),this.notifyConnectionEvent(d,e)):this.fallbackConnection(d),this.afterArrowheadDragging(d)}startLabelDragging(e,t,n){if(this.can("edgeLabelMovable")){const a=e.currentTarget,d=parseInt(a.getAttribute("data-index"),10),m=this.getLabelPositionAngle(d),p=this.getLabelPositionArgs(d),b=this.getDefaultLabelPositionArgs(),y=this.mergeLabelPositionArgs(p,b);this.setEventData(e,{index:d,positionAngle:m,positionArgs:y,stopPropagation:!0,action:"drag-label"})}else this.setEventData(e,{stopPropagation:!0});this.graph.view.delegateDragEvents(e,this)}dragLabel(e,t,n){const a=this.getEventData(e),d=this.cell.getLabelAt(a.index),m=l.ObjectExt.merge({},d,{position:this.getLabelPosition(t,n,a.positionAngle,a.positionArgs)});this.cell.setLabelAt(a.index,m)}stopLabelDragging(e,t,n){}}o.EdgeView=g,function(s){s.toStringTag=`X6.${s.name}`;function e(t){if(t==null)return!1;if(t instanceof s)return!0;const n=t[Symbol.toStringTag],a=t;return(n==null||n===s.toStringTag)&&typeof a.isNodeView=="function"&&typeof a.isEdgeView=="function"&&typeof a.confirmUpdate=="function"&&typeof a.update=="function"&&typeof a.getConnection=="function"}s.isEdgeView=e}(g=o.EdgeView||(o.EdgeView={})),g.config({isSvgElement:!0,priority:1,bootstrap:["render","source","target"],actions:{view:["render"],markup:["render"],attrs:["update"],source:["source","update"],target:["target","update"],router:["update"],connector:["update"],labels:["labels"],defaultLabel:["labels"],tools:["tools"],vertices:["vertices","update"]}}),g.registry.register("edge",g,!0)})(Ds);(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(Be,o),i(Te,o),i(sn(),o),i(Ds,o),i(In,o),i(me(),o)})(Ne);var br={},Rr={};(function(o){var r=w&&w.__decorate||function(u,g,s,e){var t=arguments.length,n=t<3?g:e===null?e=Object.getOwnPropertyDescriptor(g,s):e,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(u,g,s,e);else for(var d=u.length-1;d>=0;d--)(a=u[d])&&(n=(t<3?a(n):t>3?a(g,s,n):a(g,s))||n);return t>3&&n&&Object.defineProperty(g,s,n),n};Object.defineProperty(o,"__esModule",{value:!0}),o.GraphView=void 0;const i=D,l=Ge,c=ce,f=Ne;class h extends f.View{get disposeContainer(){return!1}get options(){return this.graph.options}constructor(g){super(),this.graph=g;const{selectors:s,fragment:e}=f.Markup.parseJSONMarkup(h.markup);this.background=s.background,this.grid=s.grid,this.svg=s.svg,this.defs=s.defs,this.viewport=s.viewport,this.primer=s.primer,this.stage=s.stage,this.decorator=s.decorator,this.overlay=s.overlay,this.container=this.options.container,this.restore=h.snapshoot(this.container),i.Dom.addClass(this.container,this.prefixClassName("graph")),i.Dom.append(this.container,e),this.delegateEvents()}delegateEvents(){const g=this.constructor;return super.delegateEvents(g.events),this}guard(g,s){return g.type==="mousedown"&&g.button===2||this.options.guard&&this.options.guard(g,s)?!0:g.data&&g.data.guarded!==void 0?g.data.guarded:!(s&&s.cell&&l.Cell.isCell(s.cell)||this.svg===g.target||this.container===g.target||this.svg.contains(g.target))}findView(g){return this.graph.findViewByElem(g)}onDblClick(g){this.options.preventDefaultDblClick&&g.preventDefault();const s=this.normalizeEvent(g),e=this.findView(s.target);if(this.guard(s,e))return;const t=this.graph.snapToGrid(s.clientX,s.clientY);e?e.onDblClick(s,t.x,t.y):this.graph.trigger("blank:dblclick",{e:s,x:t.x,y:t.y})}onClick(g){if(this.getMouseMovedCount(g)<=this.options.clickThreshold){const s=this.normalizeEvent(g),e=this.findView(s.target);if(this.guard(s,e))return;const t=this.graph.snapToGrid(s.clientX,s.clientY);e?e.onClick(s,t.x,t.y):this.graph.trigger("blank:click",{e:s,x:t.x,y:t.y})}}isPreventDefaultContextMenu(g){let s=this.options.preventDefaultContextMenu;return typeof s=="function"&&(s=i.FunctionExt.call(s,this.graph,{view:g})),s}onContextMenu(g){const s=this.normalizeEvent(g),e=this.findView(s.target);if(this.isPreventDefaultContextMenu(e)&&g.preventDefault(),this.guard(s,e))return;const t=this.graph.snapToGrid(s.clientX,s.clientY);e?e.onContextMenu(s,t.x,t.y):this.graph.trigger("blank:contextmenu",{e:s,x:t.x,y:t.y})}delegateDragEvents(g,s){g.data==null&&(g.data={}),this.setEventData(g,{currentView:s||null,mouseMovedCount:0,startPosition:{x:g.clientX,y:g.clientY}});const e=this.constructor;this.delegateDocumentEvents(e.documentEvents,g.data),this.undelegateEvents()}getMouseMovedCount(g){return this.getEventData(g).mouseMovedCount||0}onMouseDown(g){const s=this.normalizeEvent(g),e=this.findView(s.target);if(this.guard(s,e))return;this.options.preventDefaultMouseDown&&g.preventDefault();const t=this.graph.snapToGrid(s.clientX,s.clientY);e?e.onMouseDown(s,t.x,t.y):(this.options.preventDefaultBlankAction&&["touchstart"].includes(s.type)&&g.preventDefault(),this.graph.trigger("blank:mousedown",{e:s,x:t.x,y:t.y})),this.delegateDragEvents(s,e)}onMouseMove(g){const s=this.getEventData(g),e=s.startPosition;if(e&&e.x===g.clientX&&e.y===g.clientY||(s.mouseMovedCount==null&&(s.mouseMovedCount=0),s.mouseMovedCount+=1,s.mouseMovedCount<=this.options.moveThreshold))return;const n=this.normalizeEvent(g),a=this.graph.snapToGrid(n.clientX,n.clientY),d=s.currentView;d?d.onMouseMove(n,a.x,a.y):this.graph.trigger("blank:mousemove",{e:n,x:a.x,y:a.y}),this.setEventData(n,s)}onMouseUp(g){this.undelegateDocumentEvents();const s=this.normalizeEvent(g),e=this.graph.snapToGrid(s.clientX,s.clientY),n=this.getEventData(g).currentView;if(n?n.onMouseUp(s,e.x,e.y):this.graph.trigger("blank:mouseup",{e:s,x:e.x,y:e.y}),!g.isPropagationStopped()){const a=new i.Dom.EventObject(g,{type:"click",data:g.data});this.onClick(a)}g.stopImmediatePropagation(),this.delegateEvents()}onMouseOver(g){const s=this.normalizeEvent(g),e=this.findView(s.target);if(!this.guard(s,e))if(e)e.onMouseOver(s);else{if(this.container===s.target)return;this.graph.trigger("blank:mouseover",{e:s})}}onMouseOut(g){const s=this.normalizeEvent(g),e=this.findView(s.target);if(!this.guard(s,e))if(e)e.onMouseOut(s);else{if(this.container===s.target)return;this.graph.trigger("blank:mouseout",{e:s})}}onMouseEnter(g){const s=this.normalizeEvent(g),e=this.findView(s.target);if(this.guard(s,e))return;const t=this.graph.findViewByElem(s.relatedTarget);if(e){if(t===e)return;e.onMouseEnter(s)}else{if(t)return;this.graph.trigger("graph:mouseenter",{e:s})}}onMouseLeave(g){const s=this.normalizeEvent(g),e=this.findView(s.target);if(this.guard(s,e))return;const t=this.graph.findViewByElem(s.relatedTarget);if(e){if(t===e)return;e.onMouseLeave(s)}else{if(t)return;this.graph.trigger("graph:mouseleave",{e:s})}}onMouseWheel(g){const s=this.normalizeEvent(g),e=this.findView(s.target);if(this.guard(s,e))return;const t=s.originalEvent,n=this.graph.snapToGrid(t.clientX,t.clientY),a=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));e?e.onMouseWheel(s,n.x,n.y,a):this.graph.trigger("blank:mousewheel",{e:s,delta:a,x:n.x,y:n.y})}onCustomEvent(g){const s=g.currentTarget,e=s.getAttribute("event")||s.getAttribute("data-event");if(e){const t=this.findView(s);if(t){const n=this.normalizeEvent(g);if(this.guard(n,t))return;const a=this.graph.snapToGrid(n.clientX,n.clientY);t.onCustomEvent(n,e,a.x,a.y)}}}handleMagnetEvent(g,s){const e=g.currentTarget,t=e.getAttribute("magnet");if(t&&t.toLowerCase()!=="false"){const n=this.findView(e);if(n){const a=this.normalizeEvent(g);if(this.guard(a,n))return;const d=this.graph.snapToGrid(a.clientX,a.clientY);i.FunctionExt.call(s,this.graph,n,a,e,d.x,d.y)}}}onMagnetMouseDown(g){this.handleMagnetEvent(g,(s,e,t,n,a)=>{s.onMagnetMouseDown(e,t,n,a)})}onMagnetDblClick(g){this.handleMagnetEvent(g,(s,e,t,n,a)=>{s.onMagnetDblClick(e,t,n,a)})}onMagnetContextMenu(g){const s=this.findView(g.target);this.isPreventDefaultContextMenu(s)&&g.preventDefault(),this.handleMagnetEvent(g,(e,t,n,a,d)=>{e.onMagnetContextMenu(t,n,a,d)})}onLabelMouseDown(g){const s=g.currentTarget,e=this.findView(s);if(e){const t=this.normalizeEvent(g);if(this.guard(t,e))return;const n=this.graph.snapToGrid(t.clientX,t.clientY);e.onLabelMouseDown(t,n.x,n.y)}}onImageDragStart(){return!1}dispose(){this.undelegateEvents(),this.undelegateDocumentEvents(),this.restore(),this.restore=()=>{}}}r([f.View.dispose()],h.prototype,"dispose",null),o.GraphView=h,function(u){const g=`${c.Config.prefixCls}-graph`;u.markup=[{ns:i.Dom.ns.xhtml,tagName:"div",selector:"background",className:`${g}-background`},{ns:i.Dom.ns.xhtml,tagName:"div",selector:"grid",className:`${g}-grid`},{ns:i.Dom.ns.svg,tagName:"svg",selector:"svg",className:`${g}-svg`,attrs:{width:"100%",height:"100%","xmlns:xlink":i.Dom.ns.xlink},children:[{tagName:"defs",selector:"defs"},{tagName:"g",selector:"viewport",className:`${g}-svg-viewport`,children:[{tagName:"g",selector:"primer",className:`${g}-svg-primer`},{tagName:"g",selector:"stage",className:`${g}-svg-stage`},{tagName:"g",selector:"decorator",className:`${g}-svg-decorator`},{tagName:"g",selector:"overlay",className:`${g}-svg-overlay`}]}]}];function s(e){const t=e.cloneNode();return e.childNodes.forEach(n=>t.appendChild(n)),()=>{for(i.Dom.empty(e);e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);for(let n=0,a=t.attributes.length;n<a;n+=1){const d=t.attributes[n];e.setAttribute(d.name,d.value)}t.childNodes.forEach(n=>e.appendChild(n))}}u.snapshoot=s}(h=o.GraphView||(o.GraphView={})),function(u){const g=c.Config.prefixCls;u.events={dblclick:"onDblClick",contextmenu:"onContextMenu",touchstart:"onMouseDown",mousedown:"onMouseDown",mouseover:"onMouseOver",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",DOMMouseScroll:"onMouseWheel",[`mouseenter  .${g}-cell`]:"onMouseEnter",[`mouseleave  .${g}-cell`]:"onMouseLeave",[`mouseenter  .${g}-cell-tools`]:"onMouseEnter",[`mouseleave  .${g}-cell-tools`]:"onMouseLeave",[`mousedown   .${g}-cell [event]`]:"onCustomEvent",[`touchstart  .${g}-cell [event]`]:"onCustomEvent",[`mousedown   .${g}-cell [data-event]`]:"onCustomEvent",[`touchstart  .${g}-cell [data-event]`]:"onCustomEvent",[`dblclick    .${g}-cell [magnet]`]:"onMagnetDblClick",[`contextmenu .${g}-cell [magnet]`]:"onMagnetContextMenu",[`mousedown   .${g}-cell [magnet]`]:"onMagnetMouseDown",[`touchstart  .${g}-cell [magnet]`]:"onMagnetMouseDown",[`dblclick    .${g}-cell [data-magnet]`]:"onMagnetDblClick",[`contextmenu .${g}-cell [data-magnet]`]:"onMagnetContextMenu",[`mousedown   .${g}-cell [data-magnet]`]:"onMagnetMouseDown",[`touchstart  .${g}-cell [data-magnet]`]:"onMagnetMouseDown",[`dragstart   .${g}-cell image`]:"onImageDragStart",[`mousedown   .${g}-edge .${g}-edge-label`]:"onLabelMouseDown",[`touchstart  .${g}-edge .${g}-edge-label`]:"onLabelMouseDown"},u.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}}(h=o.GraphView||(o.GraphView={}))})(Rr);var zn={},Fn={};Object.defineProperty(Fn,"__esModule",{value:!0});Fn.content=void 0;Fn.content=`.x6-graph {
  position: relative;
  overflow: hidden;
  outline: none;
  touch-action: none;
}
.x6-graph-background,
.x6-graph-grid,
.x6-graph-svg {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-graph-background-stage,
.x6-graph-grid-stage,
.x6-graph-svg-stage {
  user-select: none;
}
.x6-graph.x6-graph-pannable {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}
.x6-graph.x6-graph-panning {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
  user-select: none;
}
.x6-node {
  cursor: move;
  /* stylelint-disable-next-line */
}
.x6-node.x6-node-immovable {
  cursor: default;
}
.x6-node * {
  -webkit-user-drag: none;
}
.x6-node .scalable * {
  vector-effect: non-scaling-stroke;
}
.x6-node [magnet='true'] {
  cursor: crosshair;
  transition: opacity 0.3s;
}
.x6-node [magnet='true']:hover {
  opacity: 0.7;
}
.x6-node foreignObject {
  display: block;
  overflow: visible;
  background-color: transparent;
}
.x6-node foreignObject > body {
  position: static;
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: visible;
  background-color: transparent;
}
.x6-edge .source-marker,
.x6-edge .target-marker {
  vector-effect: non-scaling-stroke;
}
.x6-edge .connection {
  stroke-linejoin: round;
  fill: none;
}
.x6-edge .connection-wrap {
  cursor: move;
  opacity: 0;
  fill: none;
  stroke: #000;
  stroke-width: 15;
  stroke-linecap: round;
  stroke-linejoin: round;
}
.x6-edge .connection-wrap:hover {
  opacity: 0.4;
  stroke-opacity: 0.4;
}
.x6-edge .vertices {
  cursor: move;
  opacity: 0;
}
.x6-edge .vertices .vertex {
  fill: #1abc9c;
}
.x6-edge .vertices .vertex :hover {
  fill: #34495e;
  stroke: none;
}
.x6-edge .vertices .vertex-remove {
  cursor: pointer;
  fill: #fff;
}
.x6-edge .vertices .vertex-remove-area {
  cursor: pointer;
  opacity: 0.1;
}
.x6-edge .vertices .vertex-group:hover .vertex-remove-area {
  opacity: 1;
}
.x6-edge .arrowheads {
  cursor: move;
  opacity: 0;
}
.x6-edge .arrowheads .arrowhead {
  fill: #1abc9c;
}
.x6-edge .arrowheads .arrowhead :hover {
  fill: #f39c12;
  stroke: none;
}
.x6-edge .tools {
  cursor: pointer;
  opacity: 0;
}
.x6-edge .tools .tool-options {
  display: none;
}
.x6-edge .tools .tool-remove circle {
  fill: #f00;
}
.x6-edge .tools .tool-remove path {
  fill: #fff;
}
.x6-edge:hover .vertices,
.x6-edge:hover .arrowheads,
.x6-edge:hover .tools {
  opacity: 1;
}
.x6-highlight-opacity {
  opacity: 0.3;
}
.x6-cell-tool-editor {
  position: relative;
  display: inline-block;
  min-height: 1em;
  margin: 0;
  padding: 0;
  line-height: 1;
  white-space: normal;
  text-align: center;
  vertical-align: top;
  overflow-wrap: normal;
  outline: none;
  transform-origin: 0 0;
  -webkit-user-drag: none;
}
.x6-edge-tool-editor {
  border: 1px solid #275fc5;
  border-radius: 2px;
}
`;var W={};Object.defineProperty(W,"__esModule",{value:!0});W.Base=void 0;const cu=D;class uu extends cu.Disposable{get options(){return this.graph.options}get model(){return this.graph.model}get view(){return this.graph.view}constructor(r){super(),this.graph=r,this.init()}init(){}}W.Base=uu;var hu=w&&w.__decorate||function(o,r,i,l){var c=arguments.length,f=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,i):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,r,i,l);else for(var u=o.length-1;u>=0;u--)(h=o[u])&&(f=(c<3?h(f):c>3?h(r,i,f):h(r,i))||f);return c>3&&f&&Object.defineProperty(r,i,f),f};Object.defineProperty(zn,"__esModule",{value:!0});zn.CSSManager=void 0;const Pi=D,gu=ce,fu=Fn,du=W;class Cr extends du.Base{init(){gu.Config.autoInsertCSS&&Pi.CssLoader.ensure("core",fu.content)}dispose(){Pi.CssLoader.clean("core")}}hu([Cr.dispose()],Cr.prototype,"dispose",null);zn.CSSManager=Cr;var yr={},Oi;function Ts(){return Oi||(Oi=1,function(o){var r=w&&w.__rest||function(f,h){var u={};for(var g in f)Object.prototype.hasOwnProperty.call(f,g)&&h.indexOf(g)<0&&(u[g]=f[g]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,g=Object.getOwnPropertySymbols(f);s<g.length;s++)h.indexOf(g[s])<0&&Object.prototype.propertyIsEnumerable.call(f,g[s])&&(u[g[s]]=f[g[s]]);return u};Object.defineProperty(o,"__esModule",{value:!0}),o.Options=void 0;const i=D,l=ce,c=Ys();(function(f){function h(u){const{grid:g,panning:s,mousewheel:e,embedding:t}=u,n=r(u,["grid","panning","mousewheel","embedding"]),a=u.container;if(a!=null)n.width==null&&(n.width=a.clientWidth),n.height==null&&(n.height=a.clientHeight);else throw new Error("Ensure the container of the graph is specified and valid");const d=i.ObjectExt.merge({},f.defaults,n),m={size:10,visible:!1};return typeof g=="number"?d.grid={size:g,visible:!1}:typeof g=="boolean"?d.grid=Object.assign(Object.assign({},m),{visible:g}):d.grid=Object.assign(Object.assign({},m),g),["panning","mousewheel","embedding"].forEach(b=>{const y=u[b];typeof y=="boolean"?d[b].enabled=y:d[b]=Object.assign(Object.assign({},d[b]),y)}),d}f.get=h})(o.Options||(o.Options={})),function(f){f.defaults={x:0,y:0,scaling:{min:.01,max:16},grid:{size:10,visible:!1},background:!1,panning:{enabled:!1,eventTypes:["leftMouseDown"]},mousewheel:{enabled:!1,factor:1.2,zoomAtMousePosition:!0},highlighting:{default:{name:"stroke",args:{padding:3}},nodeAvailable:{name:"className",args:{className:l.Config.prefix("available-node")}},magnetAvailable:{name:"className",args:{className:l.Config.prefix("available-magnet")}}},connecting:{snap:!1,allowLoop:!0,allowNode:!0,allowEdge:!1,allowPort:!0,allowBlank:!0,allowMulti:!0,highlight:!1,anchor:"center",edgeAnchor:"ratio",connectionPoint:"boundary",router:"normal",connector:"normal",validateConnection({type:h,sourceView:u,targetView:g}){return(h==="target"?g:u)!=null},createEdge(){return new c.Edge}},translating:{restrict:!1},embedding:{enabled:!1,findParent:"bbox",frontOnly:!0,validate:()=>!0},moveThreshold:0,clickThreshold:0,magnetThreshold:0,preventDefaultDblClick:!0,preventDefaultMouseDown:!1,preventDefaultContextMenu:!0,preventDefaultBlankAction:!0,interacting:{edgeLabelMovable:!1},async:!0,virtual:!1,guard:()=>!1}}(o.Options||(o.Options={}))}(yr)),yr}var Gn={},pu=w&&w.__createBinding||(Object.create?function(o,r,i,l){l===void 0&&(l=i);var c=Object.getOwnPropertyDescriptor(r,i);(!c||("get"in c?!r.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return r[i]}}),Object.defineProperty(o,l,c)}:function(o,r,i,l){l===void 0&&(l=i),o[l]=r[i]}),mu=w&&w.__setModuleDefault||(Object.create?function(o,r){Object.defineProperty(o,"default",{enumerable:!0,value:r})}:function(o,r){o.default=r}),bu=w&&w.__decorate||function(o,r,i,l){var c=arguments.length,f=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,i):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,r,i,l);else for(var u=o.length-1;u>=0;u--)(h=o[u])&&(f=(c<3?h(f):c>3?h(r,i,f):h(r,i))||f);return c>3&&f&&Object.defineProperty(r,i,f),f},yu=w&&w.__importStar||function(o){if(o&&o.__esModule)return o;var r={};if(o!=null)for(var i in o)i!=="default"&&Object.prototype.hasOwnProperty.call(o,i)&&pu(r,o,i);return mu(r,o),r},vu=w&&w.__rest||function(o,r){var i={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.indexOf(l)<0&&(i[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(o);c<l.length;c++)r.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(o,l[c])&&(i[l[c]]=o[l[c]]);return i};Object.defineProperty(Gn,"__esModule",{value:!0});Gn.GridManager=void 0;const vr=D,pt=yu(ae),Bs=W;class Ns extends Bs.Base{get elem(){return this.view.grid}get grid(){return this.options.grid}init(){this.startListening(),this.draw(this.grid)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}setVisible(r){this.grid.visible!==r&&(this.grid.visible=r,this.update())}getGridSize(){return this.grid.size}setGridSize(r){this.grid.size=Math.max(r,1),this.update()}show(){this.setVisible(!0),this.update()}hide(){this.setVisible(!1),this.update()}clear(){this.elem.style.backgroundImage=""}draw(r){this.clear(),this.instance=null,Object.assign(this.grid,r),this.patterns=this.resolveGrid(r),this.update()}update(r={}){const i=this.grid.size;if(i<=1||!this.grid.visible)return this.clear();const l=this.graph.matrix(),c=this.getInstance(),f=Array.isArray(r)?r:[r];this.patterns.forEach((g,s)=>{const e=`pattern_${s}`,t=l.a||1,n=l.d||1,{update:a,markup:d}=g,m=vu(g,["update","markup"]),p=Object.assign(Object.assign(Object.assign({},m),f[s]),{sx:t,sy:n,ox:l.e||0,oy:l.f||0,width:i*t,height:i*n});c.has(e)||c.add(e,vr.Vector.create("pattern",{id:e,patternUnits:"userSpaceOnUse"},vr.Vector.createVectors(d)).node);const b=c.get(e);typeof a=="function"&&a(b.childNodes[0],p);let y=p.ox%p.width;y<0&&(y+=p.width);let _=p.oy%p.height;_<0&&(_+=p.height),vr.Dom.attr(b,{x:y,y:_,width:p.width,height:p.height})});const h=new XMLSerializer().serializeToString(c.root),u=`url(data:image/svg+xml;base64,${btoa(h)})`;this.elem.style.backgroundImage=u}getInstance(){return this.instance||(this.instance=new pt.Grid),this.instance}resolveGrid(r){if(!r)return[];const i=r.type;if(i==null)return[Object.assign(Object.assign({},pt.Grid.presets.dot),r.args)];const l=pt.Grid.registry.get(i);if(l){let c=r.args||[];return Array.isArray(c)||(c=[c]),Array.isArray(l)?l.map((f,h)=>Object.assign(Object.assign({},f),c[h])):[Object.assign(Object.assign({},l),c[0])]}return pt.Grid.registry.onNotFound(i)}dispose(){this.stopListening(),this.clear()}}bu([Bs.Base.dispose()],Ns.prototype,"dispose",null);Gn.GridManager=Ns;var ot={};Object.defineProperty(ot,"__esModule",{value:!0});ot.TransformManager=void 0;const q=D,Pe=B,_u=W,xi=ue;class wu extends _u.Base{get container(){return this.graph.view.container}get viewport(){return this.graph.view.viewport}get stage(){return this.graph.view.stage}init(){this.resize()}getMatrix(){const r=this.viewport.getAttribute("transform");return r!==this.viewportTransformString&&(this.viewportMatrix=this.viewport.getCTM(),this.viewportTransformString=r),q.Dom.createSVGMatrix(this.viewportMatrix)}setMatrix(r){const i=q.Dom.createSVGMatrix(r),l=q.Dom.matrixToTransformString(i);this.viewport.setAttribute("transform",l),this.viewportMatrix=i,this.viewportTransformString=l}resize(r,i){let l=r===void 0?this.options.width:r,c=i===void 0?this.options.height:i;this.options.width=l,this.options.height=c,typeof l=="number"&&(l=Math.round(l)),typeof c=="number"&&(c=Math.round(c)),this.container.style.width=l==null?"":`${l}px`,this.container.style.height=c==null?"":`${c}px`;const f=this.getComputedSize();return this.graph.trigger("resize",Object.assign({},f)),this}getComputedSize(){let r=this.options.width,i=this.options.height;return q.NumberExt.isNumber(r)||(r=this.container.clientWidth),q.NumberExt.isNumber(i)||(i=this.container.clientHeight),{width:r,height:i}}getScale(){return q.Dom.matrixToScale(this.getMatrix())}scale(r,i=r,l=0,c=0){if(r=this.clampScale(r),i=this.clampScale(i),l||c){const h=this.getTranslation(),u=h.tx-l*(r-1),g=h.ty-c*(i-1);(u!==h.tx||g!==h.ty)&&this.translate(u,g)}const f=this.getMatrix();return f.a=r,f.d=i,this.setMatrix(f),this.graph.trigger("scale",{sx:r,sy:i,ox:l,oy:c}),this}clampScale(r){const i=this.graph.options.scaling;return q.NumberExt.clamp(r,i.min||.01,i.max||16)}getZoom(){return this.getScale().sx}zoom(r,i){i=i||{};let l=r,c=r;const f=this.getScale(),h=this.getComputedSize();let u=h.width/2,g=h.height/2;if(i.absolute||(l+=f.sx,c+=f.sy),i.scaleGrid&&(l=Math.round(l/i.scaleGrid)*i.scaleGrid,c=Math.round(c/i.scaleGrid)*i.scaleGrid),i.maxScale&&(l=Math.min(i.maxScale,l),c=Math.min(i.maxScale,c)),i.minScale&&(l=Math.max(i.minScale,l),c=Math.max(i.minScale,c)),i.center&&(u=i.center.x,g=i.center.y),l=this.clampScale(l),c=this.clampScale(c),u||g){const s=this.getTranslation(),e=u-(u-s.tx)*(l/f.sx),t=g-(g-s.ty)*(c/f.sy);(e!==s.tx||t!==s.ty)&&this.translate(e,t)}return this.scale(l,c),this}getRotation(){return q.Dom.matrixToRotation(this.getMatrix())}rotate(r,i,l){if(i==null||l==null){const f=xi.Util.getBBox(this.stage);i=f.width/2,l=f.height/2}const c=this.getMatrix().translate(i,l).rotate(r).translate(-i,-l);return this.setMatrix(c),this}getTranslation(){return q.Dom.matrixToTranslation(this.getMatrix())}translate(r,i){const l=this.getMatrix();l.e=r||0,l.f=i||0,this.setMatrix(l);const c=this.getTranslation();return this.options.x=c.tx,this.options.y=c.ty,this.graph.trigger("translate",Object.assign({},c)),this}setOrigin(r,i){return this.translate(r||0,i||0)}fitToContent(r,i,l,c){if(typeof r=="object"){const _=r;r=_.gridWidth||1,i=_.gridHeight||1,l=_.padding||0,c=_}else r=r||1,i=i||1,l=l||0,c==null&&(c={});const f=q.NumberExt.normalizeSides(l),h=c.border||0,u=c.contentArea?Pe.Rectangle.create(c.contentArea):this.getContentArea(c);h>0&&u.inflate(h);const g=this.getScale(),s=this.getTranslation(),e=g.sx,t=g.sy;u.x*=e,u.y*=t,u.width*=e,u.height*=t;let n=Math.max(Math.ceil((u.width+u.x)/r),1)*r,a=Math.max(Math.ceil((u.height+u.y)/i),1)*i,d=0,m=0;(c.allowNewOrigin==="negative"&&u.x<0||c.allowNewOrigin==="positive"&&u.x>=0||c.allowNewOrigin==="any")&&(d=Math.ceil(-u.x/r)*r,d+=f.left,n+=d),(c.allowNewOrigin==="negative"&&u.y<0||c.allowNewOrigin==="positive"&&u.y>=0||c.allowNewOrigin==="any")&&(m=Math.ceil(-u.y/i)*i,m+=f.top,a+=m),n+=f.right,a+=f.bottom,n=Math.max(n,c.minWidth||0),a=Math.max(a,c.minHeight||0),n=Math.min(n,c.maxWidth||Number.MAX_SAFE_INTEGER),a=Math.min(a,c.maxHeight||Number.MAX_SAFE_INTEGER);const p=this.getComputedSize(),b=n!==p.width||a!==p.height;return(d!==s.tx||m!==s.ty)&&this.translate(d,m),b&&this.resize(n,a),new Pe.Rectangle(-d/e,-m/t,n/e,a/t)}scaleContentToFit(r={}){this.scaleContentToFitImpl(r)}scaleContentToFitImpl(r={},i=!0){let l,c;if(r.contentArea){const b=r.contentArea;l=this.graph.localToGraph(b),c=Pe.Point.create(b)}else l=this.getContentBBox(r),c=this.graph.graphToLocal(l);if(!l.width||!l.height)return;const f=q.NumberExt.normalizeSides(r.padding),h=r.minScale||0,u=r.maxScale||Number.MAX_SAFE_INTEGER,g=r.minScaleX||h,s=r.maxScaleX||u,e=r.minScaleY||h,t=r.maxScaleY||u;let n;if(r.viewportArea)n=r.viewportArea;else{const b=this.getComputedSize(),y=this.getTranslation();n={x:y.tx,y:y.ty,width:b.width,height:b.height}}n=Pe.Rectangle.create(n).moveAndExpand({x:f.left,y:f.top,width:-f.left-f.right,height:-f.top-f.bottom});const a=this.getScale();let d=n.width/l.width*a.sx,m=n.height/l.height*a.sy;r.preserveAspectRatio!==!1&&(d=m=Math.min(d,m));const p=r.scaleGrid;if(p&&(d=p*Math.floor(d/p),m=p*Math.floor(m/p)),d=q.NumberExt.clamp(d,g,s),m=q.NumberExt.clamp(m,e,t),this.scale(d,m),i){const b=this.options,y=n.x-c.x*d-b.x,_=n.y-c.y*m-b.y;this.translate(y,_)}}getContentArea(r={}){return r.useCellGeometry!==!1?this.model.getAllCellsBBox()||new Pe.Rectangle:xi.Util.getBBox(this.stage)}getContentBBox(r={}){return this.graph.localToGraph(this.getContentArea(r))}getGraphArea(){const r=Pe.Rectangle.fromSize(this.getComputedSize());return this.graph.graphToLocal(r)}zoomToRect(r,i={}){const l=Pe.Rectangle.create(r),c=this.graph;i.contentArea=l,i.viewportArea==null&&(i.viewportArea={x:c.options.x,y:c.options.y,width:this.options.width,height:this.options.height}),this.scaleContentToFitImpl(i,!1);const f=l.getCenter();return this.centerPoint(f.x,f.y),this}zoomToFit(r={}){return this.zoomToRect(this.getContentArea(r),r)}centerPoint(r,i){const l=this.getComputedSize(),c=this.getScale(),f=this.getTranslation(),h=l.width/2,u=l.height/2;r=typeof r=="number"?r:h,i=typeof i=="number"?i:u,r=h-r*c.sx,i=u-i*c.sy,(f.tx!==r||f.ty!==i)&&this.translate(r,i)}centerContent(r){const l=this.graph.getContentArea(r).getCenter();this.centerPoint(l.x,l.y)}centerCell(r){return this.positionCell(r,"center")}positionPoint(r,i,l){const c=this.getComputedSize();i=q.NumberExt.normalizePercentage(i,Math.max(0,c.width)),i<0&&(i=c.width+i),l=q.NumberExt.normalizePercentage(l,Math.max(0,c.height)),l<0&&(l=c.height+l);const f=this.getTranslation(),h=this.getScale(),u=i-r.x*h.sx,g=l-r.y*h.sy;(f.tx!==u||f.ty!==g)&&this.translate(u,g)}positionRect(r,i){const l=Pe.Rectangle.create(r);switch(i){case"center":return this.positionPoint(l.getCenter(),"50%","50%");case"top":return this.positionPoint(l.getTopCenter(),"50%",0);case"top-right":return this.positionPoint(l.getTopRight(),"100%",0);case"right":return this.positionPoint(l.getRightMiddle(),"100%","50%");case"bottom-right":return this.positionPoint(l.getBottomRight(),"100%","100%");case"bottom":return this.positionPoint(l.getBottomCenter(),"50%","100%");case"bottom-left":return this.positionPoint(l.getBottomLeft(),0,"100%");case"left":return this.positionPoint(l.getLeftMiddle(),0,"50%");case"top-left":return this.positionPoint(l.getTopLeft(),0,0);default:return this}}positionCell(r,i){const l=r.getBBox();return this.positionRect(l,i)}positionContent(r,i){const l=this.graph.getContentArea(i);return this.positionRect(l,r)}}ot.TransformManager=wu;var at={},Pu=w&&w.__decorate||function(o,r,i,l){var c=arguments.length,f=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,i):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,r,i,l);else for(var u=o.length-1;u>=0;u--)(h=o[u])&&(f=(c<3?h(f):c>3?h(r,i,f):h(r,i))||f);return c>3&&f&&Object.defineProperty(r,i,f),f};Object.defineProperty(at,"__esModule",{value:!0});at.BackgroundManager=void 0;const Ci=D,Ou=B,xu=ae,Rs=W;class $s extends Rs.Base{get elem(){return this.view.background}init(){this.startListening(),this.options.background&&this.draw(this.options.background)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}updateBackgroundImage(r={}){let i=r.size||"auto auto",l=r.position||"center";const c=this.graph.transform.getScale(),f=this.graph.translate();if(typeof l=="object"){const h=f.tx+c.sx*(l.x||0),u=f.ty+c.sy*(l.y||0);l=`${h}px ${u}px`}typeof i=="object"&&(i=Ou.Rectangle.fromSize(i).scale(c.sx,c.sy),i=`${i.width}px ${i.height}px`),this.elem.style.backgroundSize=i,this.elem.style.backgroundPosition=l}drawBackgroundImage(r,i={}){if(!(r instanceof HTMLImageElement)){this.elem.style.backgroundImage="";return}const l=this.optionsCache;if(l&&l.image!==i.image)return;let c;const f=i.opacity,h=i.size;let u=i.repeat||"no-repeat";const g=xu.Background.registry.get(u);if(typeof g=="function"){const e=i.quality||1;r.width*=e,r.height*=e;const t=g(r,i);if(!(t instanceof HTMLCanvasElement))throw new Error("Background pattern must return an HTML Canvas instance");c=t.toDataURL("image/png"),i.repeat&&u!==i.repeat?u=i.repeat:u="repeat",typeof h=="object"?(h.width*=t.width/r.width,h.height*=t.height/r.height):h===void 0&&(i.size={width:t.width/e,height:t.height/e})}else c=r.src,h===void 0&&(i.size={width:r.width,height:r.height});l!=null&&typeof i.size=="object"&&i.image===l.image&&i.repeat===l.repeat&&i.quality===l.quality&&(l.size=Ci.ObjectExt.clone(i.size));const s=this.elem.style;s.backgroundImage=`url(${c})`,s.backgroundRepeat=u,s.opacity=f==null||f>=1?"":`${f}`,this.updateBackgroundImage(i)}updateBackgroundColor(r){this.elem.style.backgroundColor=r||""}updateBackgroundOptions(r){this.graph.options.background=r}update(){this.optionsCache&&this.updateBackgroundImage(this.optionsCache)}draw(r){const i=r||{};if(this.updateBackgroundOptions(r),this.updateBackgroundColor(i.color),i.image){this.optionsCache=Ci.ObjectExt.clone(i);const l=document.createElement("img");l.onload=()=>this.drawBackgroundImage(l,r),l.setAttribute("crossorigin","anonymous"),l.src=i.image}else this.drawBackgroundImage(null),this.optionsCache=null}clear(){this.draw()}dispose(){this.clear(),this.stopListening()}}Pu([Rs.Base.dispose()],$s.prototype,"dispose",null);at.BackgroundManager=$s;var kn={},Cu=w&&w.__decorate||function(o,r,i,l){var c=arguments.length,f=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,i):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,r,i,l);else for(var u=o.length-1;u>=0;u--)(h=o[u])&&(f=(c<3?h(f):c>3?h(r,i,f):h(r,i))||f);return c>3&&f&&Object.defineProperty(r,i,f),f};Object.defineProperty(kn,"__esModule",{value:!0});kn.PanningManager=void 0;const H=D,Vs=W;class Ls extends Vs.Base{get widgetOptions(){return this.options.panning}get pannable(){return this.widgetOptions&&this.widgetOptions.enabled===!0}init(){this.onRightMouseDown=this.onRightMouseDown.bind(this),this.onSpaceKeyDown=this.onSpaceKeyDown.bind(this),this.onSpaceKeyUp=this.onSpaceKeyUp.bind(this),this.startListening(),this.updateClassName()}startListening(){this.graph.on("blank:mousedown",this.onMouseDown,this),this.graph.on("node:unhandled:mousedown",this.onMouseDown,this),this.graph.on("edge:unhandled:mousedown",this.onMouseDown,this),H.Dom.Event.on(this.graph.container,"mousedown",this.onRightMouseDown),H.Dom.Event.on(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle=new H.Dom.MouseWheelHandle(this.graph.container,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.mousewheelHandle.enable()}stopListening(){this.graph.off("blank:mousedown",this.onMouseDown,this),this.graph.off("node:unhandled:mousedown",this.onMouseDown,this),this.graph.off("edge:unhandled:mousedown",this.onMouseDown,this),H.Dom.Event.off(this.graph.container,"mousedown",this.onRightMouseDown),H.Dom.Event.off(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle&&this.mousewheelHandle.disable()}allowPanning(r,i){return r.spaceKey=this.isSpaceKeyPressed,this.pannable&&H.ModifierKey.isMatch(r,this.widgetOptions.modifiers,i)}startPanning(r){const i=this.view.normalizeEvent(r);this.clientX=i.clientX,this.clientY=i.clientY,this.panning=!0,this.updateClassName(),H.Dom.Event.on(document.body,{"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),H.Dom.Event.on(window,"mouseup.panning",this.stopPanning.bind(this))}pan(r){const i=this.view.normalizeEvent(r),l=i.clientX-this.clientX,c=i.clientY-this.clientY;this.clientX=i.clientX,this.clientY=i.clientY,this.graph.translateBy(l,c)}stopPanning(r){this.panning=!1,this.updateClassName(),H.Dom.Event.off(document.body,".panning"),H.Dom.Event.off(window,".panning")}updateClassName(){const r=this.view.container,i=this.view.prefixClassName("graph-panning"),l=this.view.prefixClassName("graph-pannable");this.pannable?this.panning?(H.Dom.addClass(r,i),H.Dom.removeClass(r,l)):(H.Dom.removeClass(r,i),H.Dom.addClass(r,l)):(H.Dom.removeClass(r,i),H.Dom.removeClass(r,l))}onMouseDown({e:r}){if(!this.allowBlankMouseDown(r))return;const i=this.graph.getPlugin("selection"),l=i&&i.allowRubberband(r,!0);(this.allowPanning(r,!0)||this.allowPanning(r)&&!l)&&this.startPanning(r)}onRightMouseDown(r){const i=this.widgetOptions.eventTypes;!((i==null?void 0:i.includes("rightMouseDown"))&&r.button===2)||this.allowPanning(r,!0)&&this.startPanning(r)}onMouseWheel(r,i,l){this.graph.translateBy(-i,-l)}onSpaceKeyDown(r){r.which===32&&(this.isSpaceKeyPressed=!0)}onSpaceKeyUp(r){r.which===32&&(this.isSpaceKeyPressed=!1)}allowBlankMouseDown(r){const i=this.widgetOptions.eventTypes;return(i==null?void 0:i.includes("leftMouseDown"))&&r.button===0||(i==null?void 0:i.includes("mouseWheelDown"))&&r.button===1}allowMouseWheel(r){var i;return this.pannable&&!r.ctrlKey&&((i=this.widgetOptions.eventTypes)===null||i===void 0?void 0:i.includes("mouseWheel"))}autoPanning(r,i){const c=this.graph.getGraphArea();let f=0,h=0;r<=c.left+10&&(f=-10),i<=c.top+10&&(h=-10),r>=c.right-10&&(f=10),i>=c.bottom-10&&(h=10),(f!==0||h!==0)&&this.graph.translateBy(-f,-h)}enablePanning(){this.pannable||(this.widgetOptions.enabled=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.widgetOptions.enabled=!1,this.updateClassName())}dispose(){this.stopListening()}}Cu([Vs.Base.dispose()],Ls.prototype,"dispose",null);kn.PanningManager=Ls;var Hn={},Mu=w&&w.__decorate||function(o,r,i,l){var c=arguments.length,f=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,i):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,r,i,l);else for(var u=o.length-1;u>=0;u--)(h=o[u])&&(f=(c<3?h(f):c>3?h(r,i,f):h(r,i))||f);return c>3&&f&&Object.defineProperty(r,i,f),f};Object.defineProperty(Hn,"__esModule",{value:!0});Hn.MouseWheel=void 0;const Xe=D,Eu=W;class Is extends Eu.Base{constructor(){super(...arguments),this.cumulatedFactor=1}get widgetOptions(){return this.options.mousewheel}init(){this.container=this.graph.container,this.target=this.widgetOptions.global?document:this.container,this.mousewheelHandle=new Xe.Dom.MouseWheelHandle(this.target,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.widgetOptions.enabled&&this.enable(!0)}get disabled(){return this.widgetOptions.enabled!==!0}enable(r){(this.disabled||r)&&(this.widgetOptions.enabled=!0,this.mousewheelHandle.enable())}disable(){this.disabled||(this.widgetOptions.enabled=!1,this.mousewheelHandle.disable())}allowMouseWheel(r){const i=this.widgetOptions.guard;return(i==null||i(r))&&Xe.ModifierKey.isMatch(r,this.widgetOptions.modifiers)}onMouseWheel(r){const i=this.widgetOptions.guard;if((i==null||i(r))&&Xe.ModifierKey.isMatch(r,this.widgetOptions.modifiers)){const l=this.widgetOptions.factor||1.2;this.currentScale==null&&(this.startPos={x:r.clientX,y:r.clientY},this.currentScale=this.graph.transform.getScale().sx),r.deltaY<0?this.currentScale<.15?this.cumulatedFactor=(this.currentScale+.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*l*20)/20/this.currentScale,this.cumulatedFactor===1&&(this.cumulatedFactor=1.05)):this.currentScale<=.15?this.cumulatedFactor=(this.currentScale-.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*(1/l)*20)/20/this.currentScale,this.cumulatedFactor===1&&(this.cumulatedFactor=.95)),this.cumulatedFactor=Math.max(.01,Math.min(this.currentScale*this.cumulatedFactor,160)/this.currentScale);const f=this.currentScale;let h=this.graph.transform.clampScale(f*this.cumulatedFactor);const u=this.widgetOptions.minScale||Number.MIN_SAFE_INTEGER,g=this.widgetOptions.maxScale||Number.MAX_SAFE_INTEGER;if(h=Xe.NumberExt.clamp(h,u,g),h!==f)if(this.widgetOptions.zoomAtMousePosition){const e=!!this.graph.getPlugin("scroller")?this.graph.clientToLocal(this.startPos):this.graph.clientToGraph(this.startPos);this.graph.zoom(h,{absolute:!0,center:e.clone()})}else this.graph.zoom(h,{absolute:!0});this.currentScale=null,this.cumulatedFactor=1}}dispose(){this.disable()}}Mu([Xe.Disposable.dispose()],Is.prototype,"dispose",null);Hn.MouseWheel=Is;var Un={},ju=w&&w.__decorate||function(o,r,i,l){var c=arguments.length,f=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,i):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,r,i,l);else for(var u=o.length-1;u>=0;u--)(h=o[u])&&(f=(c<3?h(f):c>3?h(r,i,f):h(r,i))||f);return c>3&&f&&Object.defineProperty(r,i,f),f};Object.defineProperty(Un,"__esModule",{value:!0});Un.VirtualRenderManager=void 0;const Su=D,zs=W;class Fs extends zs.Base{init(){this.resetRenderArea=Su.FunctionExt.throttle(this.resetRenderArea,200,{leading:!0}),this.resetRenderArea(),this.startListening()}startListening(){this.graph.on("translate",this.resetRenderArea,this),this.graph.on("scale",this.resetRenderArea,this),this.graph.on("resize",this.resetRenderArea,this)}stopListening(){this.graph.off("translate",this.resetRenderArea,this),this.graph.off("scale",this.resetRenderArea,this),this.graph.off("resize",this.resetRenderArea,this)}enableVirtualRender(){this.options.virtual=!0,this.resetRenderArea()}disableVirtualRender(){this.options.virtual=!1,this.graph.renderer.setRenderArea(void 0)}resetRenderArea(){if(this.options.virtual){const r=this.graph.getGraphArea();this.graph.renderer.setRenderArea(r)}}dispose(){this.stopListening()}}ju([zs.Base.dispose()],Fs.prototype,"dispose",null);Un.VirtualRenderManager=Fs;var Gs={},qn={},ks={},Hs={};(function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.JOB_PRIORITY=o.JobQueue=void 0;class r{constructor(){this.isFlushing=!1,this.isFlushPending=!1,this.scheduleId=0,this.queue=[],this.frameInterval=33,this.initialTime=Date.now()}queueJob(c){if(c.priority&i.PRIOR)c.cb();else{const f=this.findInsertionIndex(c);f>=0&&this.queue.splice(f,0,c)}}queueFlush(){!this.isFlushing&&!this.isFlushPending&&(this.isFlushPending=!0,this.scheduleJob())}queueFlushSync(){!this.isFlushing&&!this.isFlushPending&&(this.isFlushPending=!0,this.flushJobsSync())}clearJobs(){this.queue.length=0,this.isFlushing=!1,this.isFlushPending=!1,this.cancelScheduleJob()}flushJobs(){this.isFlushPending=!1,this.isFlushing=!0;const c=this.getCurrentTime();let f;for(;(f=this.queue.shift())&&(f.cb(),!(this.getCurrentTime()-c>=this.frameInterval)););this.isFlushing=!1,this.queue.length&&this.queueFlush()}flushJobsSync(){this.isFlushPending=!1,this.isFlushing=!0;let c;for(;c=this.queue.shift();)try{c.cb()}catch(f){console.log(f)}this.isFlushing=!1}findInsertionIndex(c){let f=0,h=this.queue.length,u=h-1;const g=c.priority;for(;f<=u;){const s=(u-f>>1)+f;g<=this.queue[s].priority?f=s+1:(h=s,u=s-1)}return h}scheduleJob(){"requestIdleCallback"in window?(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.requestIdleCallback(this.flushJobs.bind(this),{timeout:100})):(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.setTimeout(this.flushJobs.bind(this)))}cancelScheduleJob(){"cancelIdleCallback"in window?(this.scheduleId&&window.cancelIdleCallback(this.scheduleId),this.scheduleId=0):(this.scheduleId&&clearTimeout(this.scheduleId),this.scheduleId=0)}getCurrentTime(){return typeof performance=="object"&&typeof performance.now=="function"?performance.now():Date.now()-this.initialTime}}o.JobQueue=r;var i;(function(l){l[l.Update=2]="Update",l[l.RenderEdge=4]="RenderEdge",l[l.RenderNode=8]="RenderNode",l[l.PRIOR=1048576]="PRIOR"})(i=o.JOB_PRIORITY||(o.JOB_PRIORITY={}))})(Hs);(function(o){var r=w&&w.__decorate||function(h,u,g,s){var e=arguments.length,t=e<3?u:s===null?s=Object.getOwnPropertyDescriptor(u,g):s,n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")t=Reflect.decorate(h,u,g,s);else for(var a=h.length-1;a>=0;a--)(n=h[a])&&(t=(e<3?n(t):e>3?n(u,g,t):n(u,g))||t);return e>3&&t&&Object.defineProperty(u,g,t),t};Object.defineProperty(o,"__esModule",{value:!0}),o.Scheduler=void 0;const i=D,l=Ne,c=Hs;class f extends i.Disposable{get model(){return this.graph.model}get container(){return this.graph.view.stage}constructor(u){super(),this.views={},this.willRemoveViews={},this.queue=new c.JobQueue,this.graph=u,this.init()}init(){this.startListening(),this.renderViews(this.model.getCells())}startListening(){this.model.on("reseted",this.onModelReseted,this),this.model.on("cell:added",this.onCellAdded,this),this.model.on("cell:removed",this.onCellRemoved,this),this.model.on("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.on("cell:change:visible",this.onCellVisibleChanged,this)}stopListening(){this.model.off("reseted",this.onModelReseted,this),this.model.off("cell:added",this.onCellAdded,this),this.model.off("cell:removed",this.onCellRemoved,this),this.model.off("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.off("cell:change:visible",this.onCellVisibleChanged,this)}onModelReseted({options:u}){this.queue.clearJobs(),this.removeZPivots(),this.resetViews();const g=this.model.getCells();this.renderViews(g,Object.assign(Object.assign({},u),{queue:g.map(s=>s.id)}))}onCellAdded({cell:u,options:g}){this.renderViews([u],g)}onCellRemoved({cell:u}){this.removeViews([u])}onCellZIndexChanged({cell:u,options:g}){const s=this.views[u.id];s&&this.requestViewUpdate(s.view,f.FLAG_INSERT,g,c.JOB_PRIORITY.Update,!0)}onCellVisibleChanged({cell:u,current:g}){this.toggleVisible(u,!!g)}requestViewUpdate(u,g,s={},e=c.JOB_PRIORITY.Update,t=!0){const n=u.cell.id,a=this.views[n];if(!a)return;a.flag=g,a.options=s,(u.hasAction(g,["translate","resize","rotate"])||s.async===!1)&&(e=c.JOB_PRIORITY.PRIOR,t=!1),this.queue.queueJob({id:n,priority:e,cb:()=>{this.renderViewInArea(u,g,s);const p=s.queue;if(p){const b=p.indexOf(u.cell.id);b>=0&&p.splice(b,1),p.length===0&&this.graph.trigger("render:done")}}}),this.getEffectedEdges(u).forEach(p=>{this.requestViewUpdate(p.view,p.flag,s,e,!1)}),t&&this.flush()}setRenderArea(u){this.renderArea=u,this.flushWaitingViews()}isViewMounted(u){if(u==null)return!1;const g=this.views[u.cell.id];return g?g.state===f.ViewState.MOUNTED:!1}renderViews(u,g={}){u.sort((s,e)=>s.isNode()&&e.isEdge()?-1:0),u.forEach(s=>{const e=s.id,t=this.views;let n=0,a=t[e];if(a)n=f.FLAG_INSERT;else{const d=this.createCellView(s);d&&(d.graph=this.graph,n=f.FLAG_INSERT|d.getBootstrapFlag(),a={view:d,flag:n,options:g,state:f.ViewState.CREATED},this.views[e]=a)}a&&this.requestViewUpdate(a.view,n,g,this.getRenderPriority(a.view),!1)}),this.flush()}renderViewInArea(u,g,s={}){const e=u.cell,t=e.id,n=this.views[t];if(!n)return;let a=0;this.isUpdatable(u)?(a=this.updateView(u,g,s),n.flag=a):n.state===f.ViewState.MOUNTED?(a=this.updateView(u,g,s),n.flag=a):n.state=f.ViewState.WAITING,a&&e.isEdge()&&(a&u.getFlag(["source","target"]))===0&&this.queue.queueJob({id:t,priority:c.JOB_PRIORITY.RenderEdge,cb:()=>{this.updateView(u,g,s)}})}removeViews(u){u.forEach(g=>{const s=g.id,e=this.views[s];e&&(this.willRemoveViews[s]=e,delete this.views[s],this.queue.queueJob({id:s,priority:this.getRenderPriority(e.view),cb:()=>{this.removeView(e.view)}}))}),this.flush()}flush(){this.graph.options.async?this.queue.queueFlush():this.queue.queueFlushSync()}flushWaitingViews(){Object.values(this.views).forEach(u=>{if(u&&u.state===f.ViewState.WAITING){const{view:g,flag:s,options:e}=u;this.requestViewUpdate(g,s,e,this.getRenderPriority(g),!1)}}),this.flush()}updateView(u,g,s={}){if(u==null)return 0;if(l.CellView.isCellView(u)){if(g&f.FLAG_REMOVE)return this.removeView(u.cell),0;g&f.FLAG_INSERT&&(this.insertView(u),g^=f.FLAG_INSERT)}return g?u.confirmUpdate(g,s):0}insertView(u){const g=this.views[u.cell.id];if(g){const s=u.cell.getZIndex(),e=this.addZPivot(s);this.container.insertBefore(u.container,e),u.cell.isVisible()||this.toggleVisible(u.cell,!1),g.state=f.ViewState.MOUNTED,this.graph.trigger("view:mounted",{view:u})}}resetViews(){this.willRemoveViews=Object.assign(Object.assign({},this.views),this.willRemoveViews),Object.values(this.willRemoveViews).forEach(u=>{u&&this.removeView(u.view)}),this.views={},this.willRemoveViews={}}removeView(u){const g=u.cell,s=this.willRemoveViews[g.id];s&&u&&(s.view.remove(),delete this.willRemoveViews[g.id],this.graph.trigger("view:unmounted",{view:u}))}toggleVisible(u,g){const s=this.model.getConnectedEdges(u);for(let t=0,n=s.length;t<n;t+=1){const a=s[t];if(g){const d=a.getSourceCell(),m=a.getTargetCell();if(d&&!d.isVisible()||m&&!m.isVisible())continue;this.toggleVisible(a,!0)}else this.toggleVisible(a,!1)}const e=this.views[u.id];e&&i.Dom.css(e.view.container,{display:g?"unset":"none"})}addZPivot(u=0){this.zPivots==null&&(this.zPivots={});const g=this.zPivots;let s=g[u];if(s)return s;s=g[u]=document.createComment(`z-index:${u+1}`);let e=-1/0;for(const n in g){const a=+n;a<u&&a>e&&(e=a,u-1)}const t=this.container;if(e!==-1/0){const n=g[e];t.insertBefore(s,n.nextSibling)}else t.insertBefore(s,t.firstChild);return s}removeZPivots(){this.zPivots&&Object.values(this.zPivots).forEach(u=>{u&&u.parentNode&&u.parentNode.removeChild(u)}),this.zPivots={}}createCellView(u){const g={graph:this.graph},s=this.graph.options.createCellView;if(s){const t=i.FunctionExt.call(s,this.graph,u);if(t)return new t(u,g);if(t===null)return null}const e=u.view;if(e!=null&&typeof e=="string"){const t=l.CellView.registry.get(e);return t?new t(u,g):l.CellView.registry.onNotFound(e)}return u.isNode()?new l.NodeView(u,g):u.isEdge()?new l.EdgeView(u,g):null}getEffectedEdges(u){const g=[],s=u.cell,e=this.model.getConnectedEdges(s);for(let t=0,n=e.length;t<n;t+=1){const a=e[t],d=this.views[a.id];if(!d)continue;const m=d.view;if(!this.isViewMounted(m))continue;const p=["update"];a.getTargetCell()===s&&p.push("target"),a.getSourceCell()===s&&p.push("source"),g.push({id:a.id,view:m,flag:m.getFlag(p)})}return g}isUpdatable(u){if(u.isNodeView())return this.renderArea?this.renderArea.isIntersectWithRect(u.cell.getBBox()):!0;if(u.isEdgeView()){const g=u.cell,s=g.getSourceCell(),e=g.getTargetCell();if(this.renderArea&&s&&e)return this.renderArea.isIntersectWithRect(s.getBBox())||this.renderArea.isIntersectWithRect(e.getBBox())}return!0}getRenderPriority(u){return u.cell.isNode()?c.JOB_PRIORITY.RenderNode:c.JOB_PRIORITY.RenderEdge}dispose(){this.stopListening(),Object.keys(this.views).forEach(u=>{this.views[u].view.dispose()}),this.views={}}}r([i.Disposable.dispose()],f.prototype,"dispose",null),o.Scheduler=f,function(h){h.FLAG_INSERT=1<<30,h.FLAG_REMOVE=1<<29,h.FLAG_RENDER=(1<<26)-1}(f=o.Scheduler||(o.Scheduler={})),function(h){(function(u){u[u.CREATED=0]="CREATED",u[u.MOUNTED=1]="MOUNTED",u[u.WAITING=2]="WAITING"})(h.ViewState||(h.ViewState={}))}(f=o.Scheduler||(o.Scheduler={}))})(ks);var Au=w&&w.__decorate||function(o,r,i,l){var c=arguments.length,f=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,i):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,r,i,l);else for(var u=o.length-1;u>=0;u--)(h=o[u])&&(f=(c<3?h(f):c>3?h(r,i,f):h(r,i))||f);return c>3&&f&&Object.defineProperty(r,i,f),f};Object.defineProperty(qn,"__esModule",{value:!0});qn.Renderer=void 0;const Du=B,Us=W,Tu=Ge,Bu=ks,Mi=ue;class qs extends Us.Base{constructor(){super(...arguments),this.schedule=new Bu.Scheduler(this.graph)}requestViewUpdate(r,i,l={}){this.schedule.requestViewUpdate(r,i,l)}isViewMounted(r){return this.schedule.isViewMounted(r)}setRenderArea(r){this.schedule.setRenderArea(r)}findViewByElem(r){if(r==null)return null;const i=this.options.container,l=typeof r=="string"?i.querySelector(r):r instanceof Element?r:r[0];if(l){const c=this.graph.view.findAttr("data-cell-id",l);if(c){const f=this.schedule.views;if(f[c])return f[c].view}}return null}findViewByCell(r){if(r==null)return null;const i=Tu.Cell.isCell(r)?r.id:r,l=this.schedule.views;return l[i]?l[i].view:null}findViewsFromPoint(r){const i={x:r.x,y:r.y};return this.model.getCells().map(l=>this.findViewByCell(l)).filter(l=>l!=null?Mi.Util.getBBox(l.container,{target:this.view.stage}).containsPoint(i):!1)}findEdgeViewsFromPoint(r,i=5){return this.model.getEdges().map(l=>this.findViewByCell(l)).filter(l=>{if(l!=null){const c=l.getClosestPoint(r);if(c)return c.distance(r)<=i}return!1})}findViewsInArea(r,i={}){const l=Du.Rectangle.create(r);return this.model.getCells().map(c=>this.findViewByCell(c)).filter(c=>{if(c){if(i.nodeOnly&&!c.isNodeView())return!1;const f=Mi.Util.getBBox(c.container,{target:this.view.stage});return f.width===0?f.inflate(1,0):f.height===0&&f.inflate(0,1),i.strict?l.containsRect(f):l.isIntersectWithRect(f)}return!1})}dispose(){this.schedule.dispose()}}Au([Us.Base.dispose()],qs.prototype,"dispose",null);qn.Renderer=qs;(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(qn,o)})(Gs);var Wn={},Ei=w&&w.__rest||function(o,r){var i={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.indexOf(l)<0&&(i[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,l=Object.getOwnPropertySymbols(o);c<l.length;c++)r.indexOf(l[c])<0&&Object.prototype.propertyIsEnumerable.call(o,l[c])&&(i[l[c]]=o[l[c]]);return i};Object.defineProperty(Wn,"__esModule",{value:!0});Wn.DefsManager=void 0;const ge=D,ji=ae,Nu=Ne,Ru=W;class $u extends Ru.Base{get cid(){return this.graph.view.cid}get svg(){return this.view.svg}get defs(){return this.view.defs}isDefined(r){return this.svg.getElementById(r)!=null}filter(r){let i=r.id;const l=r.name;if(i||(i=`filter-${l}-${this.cid}-${ge.StringExt.hashcode(JSON.stringify(r))}`),!this.isDefined(i)){const c=ji.Filter.registry.get(l);if(c==null)return ji.Filter.registry.onNotFound(l);const f=c(r.args||{}),h=Object.assign(Object.assign({x:-1,y:-1,width:3,height:3,filterUnits:"objectBoundingBox"},r.attrs),{id:i});ge.Vector.create(Nu.Markup.sanitize(f),h).appendTo(this.defs)}return i}gradient(r){let i=r.id;const l=r.type;if(i||(i=`gradient-${l}-${this.cid}-${ge.StringExt.hashcode(JSON.stringify(r))}`),!this.isDefined(i)){const f=r.stops.map(g=>{const s=g.opacity!=null&&Number.isFinite(g.opacity)?g.opacity:1;return`<stop offset="${g.offset}" stop-color="${g.color}" stop-opacity="${s}"/>`}),h=`<${l}>${f.join("")}</${l}>`,u=Object.assign({id:i},r.attrs);ge.Vector.create(h,u).appendTo(this.defs)}return i}marker(r){const{id:i,refX:l,refY:c,markerUnits:f,markerOrient:h,tagName:u,children:g}=r,s=Ei(r,["id","refX","refY","markerUnits","markerOrient","tagName","children"]);let e=i;if(e||(e=`marker-${this.cid}-${ge.StringExt.hashcode(JSON.stringify(r))}`),!this.isDefined(e)){u!=="path"&&delete s.d;const t=ge.Vector.create("marker",{refX:l,refY:c,id:e,overflow:"visible",orient:h!=null?h:"auto",markerUnits:f||"userSpaceOnUse"},g?g.map(n=>{var{tagName:a}=n,d=Ei(n,["tagName"]);return ge.Vector.create(`${a}`||"path",ge.Dom.kebablizeAttrs(Object.assign(Object.assign({},s),d)))}):[ge.Vector.create(u||"path",ge.Dom.kebablizeAttrs(s))]);this.defs.appendChild(t.node)}return e}remove(r){const i=this.svg.getElementById(r);i&&i.parentNode&&i.parentNode.removeChild(i)}}Wn.DefsManager=$u;var Xn={};Object.defineProperty(Xn,"__esModule",{value:!0});Xn.CoordManager=void 0;const Vu=D,K=B,Lu=W,fe=ue;class Iu extends Lu.Base{getClientMatrix(){return Vu.Dom.createSVGMatrix(this.view.stage.getScreenCTM())}getClientOffset(){const r=this.view.svg.getBoundingClientRect();return new K.Point(r.left,r.top)}getPageOffset(){return this.getClientOffset().translate(window.scrollX,window.scrollY)}snapToGrid(r,i){return(typeof r=="number"?this.clientToLocalPoint(r,i):this.clientToLocalPoint(r.x,r.y)).snapToGrid(this.graph.getGridSize())}localToGraphPoint(r,i){const l=K.Point.create(r,i);return fe.Util.transformPoint(l,this.graph.matrix())}localToClientPoint(r,i){const l=K.Point.create(r,i);return fe.Util.transformPoint(l,this.getClientMatrix())}localToPagePoint(r,i){return(typeof r=="number"?this.localToGraphPoint(r,i):this.localToGraphPoint(r)).translate(this.getPageOffset())}localToGraphRect(r,i,l,c){const f=K.Rectangle.create(r,i,l,c);return fe.Util.transformRectangle(f,this.graph.matrix())}localToClientRect(r,i,l,c){const f=K.Rectangle.create(r,i,l,c);return fe.Util.transformRectangle(f,this.getClientMatrix())}localToPageRect(r,i,l,c){return(typeof r=="number"?this.localToGraphRect(r,i,l,c):this.localToGraphRect(r)).translate(this.getPageOffset())}graphToLocalPoint(r,i){const l=K.Point.create(r,i);return fe.Util.transformPoint(l,this.graph.matrix().inverse())}clientToLocalPoint(r,i){const l=K.Point.create(r,i);return fe.Util.transformPoint(l,this.getClientMatrix().inverse())}clientToGraphPoint(r,i){const l=K.Point.create(r,i);return fe.Util.transformPoint(l,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalPoint(r,i){const c=K.Point.create(r,i).diff(this.getPageOffset());return this.graphToLocalPoint(c)}graphToLocalRect(r,i,l,c){const f=K.Rectangle.create(r,i,l,c);return fe.Util.transformRectangle(f,this.graph.matrix().inverse())}clientToLocalRect(r,i,l,c){const f=K.Rectangle.create(r,i,l,c);return fe.Util.transformRectangle(f,this.getClientMatrix().inverse())}clientToGraphRect(r,i,l,c){const f=K.Rectangle.create(r,i,l,c);return fe.Util.transformRectangle(f,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalRect(r,i,l,c){const f=K.Rectangle.create(r,i,l,c),h=this.getPageOffset();return f.x-=h.x,f.y-=h.y,this.graphToLocalRect(f)}}Xn.CoordManager=Iu;var Jn={},zu=w&&w.__decorate||function(o,r,i,l){var c=arguments.length,f=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,i):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,r,i,l);else for(var u=o.length-1;u>=0;u--)(h=o[u])&&(f=(c<3?h(f):c>3?h(r,i,f):h(r,i))||f);return c>3&&f&&Object.defineProperty(r,i,f),f};Object.defineProperty(Jn,"__esModule",{value:!0});Jn.HighlightManager=void 0;const Fu=D,_r=ae,Gu=W;class Mr extends Gu.Base{constructor(){super(...arguments),this.highlights={}}init(){this.startListening()}startListening(){this.graph.on("cell:highlight",this.onCellHighlight,this),this.graph.on("cell:unhighlight",this.onCellUnhighlight,this)}stopListening(){this.graph.off("cell:highlight",this.onCellHighlight,this),this.graph.off("cell:unhighlight",this.onCellUnhighlight,this)}onCellHighlight({view:r,magnet:i,options:l={}}){const c=this.resolveHighlighter(l);if(!c)return;const f=this.getHighlighterId(i,c);if(!this.highlights[f]){const h=c.highlighter;h.highlight(r,i,Object.assign({},c.args)),this.highlights[f]={cellView:r,magnet:i,highlighter:h,args:c.args}}}onCellUnhighlight({magnet:r,options:i={}}){const l=this.resolveHighlighter(i);if(!l)return;const c=this.getHighlighterId(r,l);this.unhighlight(c)}resolveHighlighter(r){const i=this.options;let l=r.highlighter;if(l==null){const u=r.type;l=u&&i.highlighting[u]||i.highlighting.default}if(l==null)return null;const c=typeof l=="string"?{name:l}:l,f=c.name,h=_r.Highlighter.registry.get(f);return h==null?_r.Highlighter.registry.onNotFound(f):(_r.Highlighter.check(f,h),{name:f,highlighter:h,args:c.args||{}})}getHighlighterId(r,i){return Fu.Dom.ensureId(r),i.name+r.id+JSON.stringify(i.args)}unhighlight(r){const i=this.highlights[r];i&&(i.highlighter.unhighlight(i.cellView,i.magnet,i.args),delete this.highlights[r])}dispose(){Object.keys(this.highlights).forEach(r=>this.unhighlight(r)),this.stopListening()}}zu([Mr.dispose()],Mr.prototype,"dispose",null);Jn.HighlightManager=Mr;var Yn={},ku=w&&w.__decorate||function(o,r,i,l){var c=arguments.length,f=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,i):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(o,r,i,l);else for(var u=o.length-1;u>=0;u--)(h=o[u])&&(f=(c<3?h(f):c>3?h(r,i,f):h(r,i))||f);return c>3&&f&&Object.defineProperty(r,i,f),f};Object.defineProperty(Yn,"__esModule",{value:!0});Yn.SizeManager=void 0;const Si=D,Ws=W;class Xs extends Ws.Base{getScroller(){const r=this.graph.getPlugin("scroller");return r&&r.options.enabled?r:null}getContainer(){const r=this.getScroller();return r?r.container.parentElement:this.graph.container.parentElement}getSensorTarget(){const r=this.options.autoResize;if(r)return typeof r=="boolean"?this.getContainer():r}init(){if(this.options.autoResize){const i=this.getSensorTarget();i&&Si.SizeSensor.bind(i,()=>{const l=i.offsetWidth,c=i.offsetHeight;this.resize(l,c)})}}resize(r,i){const l=this.getScroller();l?l.resize(r,i):this.graph.transform.resize(r,i)}dispose(){Si.SizeSensor.clear(this.graph.container)}}ku([Ws.Base.dispose()],Xs.prototype,"dispose",null);Yn.SizeManager=Xs;var Ai;function Js(){return Ai||(Ai=1,function(o){var r=w&&w.__createBinding||(Object.create?function(j,v,P,E){E===void 0&&(E=P);var S=Object.getOwnPropertyDescriptor(v,P);(!S||("get"in S?!v.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return v[P]}}),Object.defineProperty(j,E,S)}:function(j,v,P,E){E===void 0&&(E=P),j[E]=v[P]}),i=w&&w.__setModuleDefault||(Object.create?function(j,v){Object.defineProperty(j,"default",{enumerable:!0,value:v})}:function(j,v){j.default=v}),l=w&&w.__decorate||function(j,v,P,E){var S=arguments.length,T=S<3?v:E===null?E=Object.getOwnPropertyDescriptor(v,P):E,R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(j,v,P,E);else for(var L=j.length-1;L>=0;L--)(R=j[L])&&(T=(S<3?R(T):S>3?R(v,P,T):R(v,P))||T);return S>3&&T&&Object.defineProperty(v,P,T),T},c=w&&w.__importStar||function(j){if(j&&j.__esModule)return j;var v={};if(j!=null)for(var P in j)P!=="default"&&Object.prototype.hasOwnProperty.call(j,P)&&r(v,j,P);return i(v,j),v};Object.defineProperty(o,"__esModule",{value:!0}),o.Graph=void 0;const f=D,h=B,u=Ge,g=Ne,s=c(ae),e=Rr,t=zn,n=Ts(),a=Gn,d=ot,m=at,p=kn,b=Hn,y=Un,_=Gs,O=Wn,x=Xn,C=Jn,M=Yn;class A extends f.Basecoat{get container(){return this.options.container}get[Symbol.toStringTag](){return A.toStringTag}constructor(v){super(),this.installedPlugins=new Set,this.options=n.Options.get(v),this.css=new t.CSSManager(this),this.view=new e.GraphView(this),this.defs=new O.DefsManager(this),this.coord=new x.CoordManager(this),this.transform=new d.TransformManager(this),this.highlight=new C.HighlightManager(this),this.grid=new a.GridManager(this),this.background=new m.BackgroundManager(this),this.options.model?this.model=this.options.model:(this.model=new u.Model,this.model.graph=this),this.renderer=new _.Renderer(this),this.panning=new p.PanningManager(this),this.mousewheel=new b.MouseWheel(this),this.virtualRender=new y.VirtualRenderManager(this),this.size=new M.SizeManager(this)}isNode(v){return v.isNode()}isEdge(v){return v.isEdge()}resetCells(v,P={}){return this.model.resetCells(v,P),this}clearCells(v={}){return this.model.clear(v),this}toJSON(v={}){return this.model.toJSON(v)}parseJSON(v){return this.model.parseJSON(v)}fromJSON(v,P={}){return this.model.fromJSON(v,P),this}getCellById(v){return this.model.getCell(v)}addNode(v,P={}){return this.model.addNode(v,P)}addNodes(v,P={}){return this.addCell(v.map(E=>u.Node.isNode(E)?E:this.createNode(E)),P)}createNode(v){return this.model.createNode(v)}removeNode(v,P={}){return this.model.removeCell(v,P)}addEdge(v,P={}){return this.model.addEdge(v,P)}addEdges(v,P={}){return this.addCell(v.map(E=>u.Edge.isEdge(E)?E:this.createEdge(E)),P)}removeEdge(v,P={}){return this.model.removeCell(v,P)}createEdge(v){return this.model.createEdge(v)}addCell(v,P={}){return this.model.addCell(v,P),this}removeCell(v,P={}){return this.model.removeCell(v,P)}removeCells(v,P={}){return this.model.removeCells(v,P)}removeConnectedEdges(v,P={}){return this.model.removeConnectedEdges(v,P)}disconnectConnectedEdges(v,P={}){return this.model.disconnectConnectedEdges(v,P),this}hasCell(v){return this.model.has(v)}getCells(){return this.model.getCells()}getCellCount(){return this.model.total()}getNodes(){return this.model.getNodes()}getEdges(){return this.model.getEdges()}getOutgoingEdges(v){return this.model.getOutgoingEdges(v)}getIncomingEdges(v){return this.model.getIncomingEdges(v)}getConnectedEdges(v,P={}){return this.model.getConnectedEdges(v,P)}getRootNodes(){return this.model.getRoots()}getLeafNodes(){return this.model.getLeafs()}isRootNode(v){return this.model.isRoot(v)}isLeafNode(v){return this.model.isLeaf(v)}getNeighbors(v,P={}){return this.model.getNeighbors(v,P)}isNeighbor(v,P,E={}){return this.model.isNeighbor(v,P,E)}getSuccessors(v,P={}){return this.model.getSuccessors(v,P)}isSuccessor(v,P,E={}){return this.model.isSuccessor(v,P,E)}getPredecessors(v,P={}){return this.model.getPredecessors(v,P)}isPredecessor(v,P,E={}){return this.model.isPredecessor(v,P,E)}getCommonAncestor(...v){return this.model.getCommonAncestor(...v)}getSubGraph(v,P={}){return this.model.getSubGraph(v,P)}cloneSubGraph(v,P={}){return this.model.cloneSubGraph(v,P)}cloneCells(v){return this.model.cloneCells(v)}getNodesFromPoint(v,P){return this.model.getNodesFromPoint(v,P)}getNodesInArea(v,P,E,S,T){return this.model.getNodesInArea(v,P,E,S,T)}getNodesUnderNode(v,P={}){return this.model.getNodesUnderNode(v,P)}searchCell(v,P,E={}){return this.model.search(v,P,E),this}getShortestPath(v,P,E={}){return this.model.getShortestPath(v,P,E)}getAllCellsBBox(){return this.model.getAllCellsBBox()}getCellsBBox(v,P={}){return this.model.getCellsBBox(v,P)}startBatch(v,P={}){this.model.startBatch(v,P)}stopBatch(v,P={}){this.model.stopBatch(v,P)}batchUpdate(v,P,E){const S=typeof v=="string"?v:"update",T=typeof v=="string"?P:v,R=typeof P=="function"?E:P;this.startBatch(S,R);const L=T();return this.stopBatch(S,R),L}updateCellId(v,P){return this.model.updateCellId(v,P)}findView(v){return u.Cell.isCell(v)?this.findViewByCell(v):this.findViewByElem(v)}findViews(v){return h.Rectangle.isRectangleLike(v)?this.findViewsInArea(v):h.Point.isPointLike(v)?this.findViewsFromPoint(v):[]}findViewByCell(v){return this.renderer.findViewByCell(v)}findViewByElem(v){return this.renderer.findViewByElem(v)}findViewsFromPoint(v,P){const E=typeof v=="number"?{x:v,y:P}:v;return this.renderer.findViewsFromPoint(E)}findViewsInArea(v,P,E,S,T){const R=typeof v=="number"?{x:v,y:P,width:E,height:S}:v,L=typeof v=="number"?T:P;return this.renderer.findViewsInArea(R,L)}matrix(v){return typeof v>"u"?this.transform.getMatrix():(this.transform.setMatrix(v),this)}resize(v,P){const E=this.getPlugin("scroller");return E?E.resize(v,P):this.transform.resize(v,P),this}scale(v,P=v,E=0,S=0){return typeof v>"u"?this.transform.getScale():(this.transform.scale(v,P,E,S),this)}zoom(v,P){const E=this.getPlugin("scroller");if(E){if(typeof v>"u")return E.zoom();E.zoom(v,P)}else{if(typeof v>"u")return this.transform.getZoom();this.transform.zoom(v,P)}return this}zoomTo(v,P={}){const E=this.getPlugin("scroller");return E?E.zoom(v,Object.assign(Object.assign({},P),{absolute:!0})):this.transform.zoom(v,Object.assign(Object.assign({},P),{absolute:!0})),this}zoomToRect(v,P={}){const E=this.getPlugin("scroller");return E?E.zoomToRect(v,P):this.transform.zoomToRect(v,P),this}zoomToFit(v={}){const P=this.getPlugin("scroller");return P?P.zoomToFit(v):this.transform.zoomToFit(v),this}rotate(v,P,E){return typeof v>"u"?this.transform.getRotation():(this.transform.rotate(v,P,E),this)}translate(v,P){return typeof v>"u"?this.transform.getTranslation():(this.transform.translate(v,P),this)}translateBy(v,P){const E=this.translate(),S=E.tx+v,T=E.ty+P;return this.translate(S,T)}getGraphArea(){return this.transform.getGraphArea()}getContentArea(v={}){return this.transform.getContentArea(v)}getContentBBox(v={}){return this.transform.getContentBBox(v)}fitToContent(v,P,E,S){return this.transform.fitToContent(v,P,E,S)}scaleContentToFit(v={}){return this.transform.scaleContentToFit(v),this}center(v){return this.centerPoint(v)}centerPoint(v,P,E){const S=this.getPlugin("scroller");return S?S.centerPoint(v,P,E):this.transform.centerPoint(v,P),this}centerContent(v){const P=this.getPlugin("scroller");return P?P.centerContent(v):this.transform.centerContent(v),this}centerCell(v,P){const E=this.getPlugin("scroller");return E?E.centerCell(v,P):this.transform.centerCell(v),this}positionPoint(v,P,E,S={}){const T=this.getPlugin("scroller");return T?T.positionPoint(v,P,E,S):this.transform.positionPoint(v,P,E),this}positionRect(v,P,E){const S=this.getPlugin("scroller");return S?S.positionRect(v,P,E):this.transform.positionRect(v,P),this}positionCell(v,P,E){const S=this.getPlugin("scroller");return S?S.positionCell(v,P,E):this.transform.positionCell(v,P),this}positionContent(v,P){const E=this.getPlugin("scroller");return E?E.positionContent(v,P):this.transform.positionContent(v,P),this}snapToGrid(v,P){return this.coord.snapToGrid(v,P)}pageToLocal(v,P,E,S){return h.Rectangle.isRectangleLike(v)?this.coord.pageToLocalRect(v):typeof v=="number"&&typeof P=="number"&&typeof E=="number"&&typeof S=="number"?this.coord.pageToLocalRect(v,P,E,S):this.coord.pageToLocalPoint(v,P)}localToPage(v,P,E,S){return h.Rectangle.isRectangleLike(v)?this.coord.localToPageRect(v):typeof v=="number"&&typeof P=="number"&&typeof E=="number"&&typeof S=="number"?this.coord.localToPageRect(v,P,E,S):this.coord.localToPagePoint(v,P)}clientToLocal(v,P,E,S){return h.Rectangle.isRectangleLike(v)?this.coord.clientToLocalRect(v):typeof v=="number"&&typeof P=="number"&&typeof E=="number"&&typeof S=="number"?this.coord.clientToLocalRect(v,P,E,S):this.coord.clientToLocalPoint(v,P)}localToClient(v,P,E,S){return h.Rectangle.isRectangleLike(v)?this.coord.localToClientRect(v):typeof v=="number"&&typeof P=="number"&&typeof E=="number"&&typeof S=="number"?this.coord.localToClientRect(v,P,E,S):this.coord.localToClientPoint(v,P)}localToGraph(v,P,E,S){return h.Rectangle.isRectangleLike(v)?this.coord.localToGraphRect(v):typeof v=="number"&&typeof P=="number"&&typeof E=="number"&&typeof S=="number"?this.coord.localToGraphRect(v,P,E,S):this.coord.localToGraphPoint(v,P)}graphToLocal(v,P,E,S){return h.Rectangle.isRectangleLike(v)?this.coord.graphToLocalRect(v):typeof v=="number"&&typeof P=="number"&&typeof E=="number"&&typeof S=="number"?this.coord.graphToLocalRect(v,P,E,S):this.coord.graphToLocalPoint(v,P)}clientToGraph(v,P,E,S){return h.Rectangle.isRectangleLike(v)?this.coord.clientToGraphRect(v):typeof v=="number"&&typeof P=="number"&&typeof E=="number"&&typeof S=="number"?this.coord.clientToGraphRect(v,P,E,S):this.coord.clientToGraphPoint(v,P)}defineFilter(v){return this.defs.filter(v)}defineGradient(v){return this.defs.gradient(v)}defineMarker(v){return this.defs.marker(v)}getGridSize(){return this.grid.getGridSize()}setGridSize(v){return this.grid.setGridSize(v),this}showGrid(){return this.grid.show(),this}hideGrid(){return this.grid.hide(),this}clearGrid(){return this.grid.clear(),this}drawGrid(v){return this.grid.draw(v),this}updateBackground(){return this.background.update(),this}drawBackground(v,P){const E=this.getPlugin("scroller");return E!=null&&(this.options.background==null||!P)?E.drawBackground(v,P):this.background.draw(v),this}clearBackground(v){const P=this.getPlugin("scroller");return P!=null&&(this.options.background==null||!v)?P.clearBackground(v):this.background.clear(),this}enableVirtualRender(){return this.virtualRender.enableVirtualRender(),this}disableVirtualRender(){return this.virtualRender.disableVirtualRender(),this}isMouseWheelEnabled(){return!this.mousewheel.disabled}enableMouseWheel(){return this.mousewheel.enable(),this}disableMouseWheel(){return this.mousewheel.disable(),this}toggleMouseWheel(v){return v==null?this.isMouseWheelEnabled()?this.disableMouseWheel():this.enableMouseWheel():v?this.enableMouseWheel():this.disableMouseWheel(),this}isPannable(){const v=this.getPlugin("scroller");return v?v.isPannable():this.panning.pannable}enablePanning(){const v=this.getPlugin("scroller");return v?v.enablePanning():this.panning.enablePanning(),this}disablePanning(){const v=this.getPlugin("scroller");return v?v.disablePanning():this.panning.disablePanning(),this}togglePanning(v){return v==null?this.isPannable()?this.disablePanning():this.enablePanning():v!==this.isPannable()&&(v?this.enablePanning():this.disablePanning()),this}use(v,...P){return this.installedPlugins.has(v)||(this.installedPlugins.add(v),v.init(this,...P)),this}getPlugin(v){return Array.from(this.installedPlugins).find(P=>P.name===v)}getPlugins(v){return Array.from(this.installedPlugins).filter(P=>v.includes(P.name))}enablePlugins(v){let P=v;Array.isArray(P)||(P=[P]);const E=this.getPlugins(P);return E==null||E.forEach(S=>{var T;(T=S==null?void 0:S.enable)===null||T===void 0||T.call(S)}),this}disablePlugins(v){let P=v;Array.isArray(P)||(P=[P]);const E=this.getPlugins(P);return E==null||E.forEach(S=>{var T;(T=S==null?void 0:S.disable)===null||T===void 0||T.call(S)}),this}isPluginEnabled(v){var P;const E=this.getPlugin(v);return(P=E==null?void 0:E.isEnabled)===null||P===void 0?void 0:P.call(E)}disposePlugins(v){let P=v;Array.isArray(P)||(P=[P]);const E=this.getPlugins(P);return E==null||E.forEach(S=>{S.dispose(),this.installedPlugins.delete(S)}),this}dispose(v=!0){v&&this.model.dispose(),this.css.dispose(),this.defs.dispose(),this.grid.dispose(),this.coord.dispose(),this.transform.dispose(),this.highlight.dispose(),this.background.dispose(),this.mousewheel.dispose(),this.panning.dispose(),this.view.dispose(),this.renderer.dispose(),this.installedPlugins.forEach(P=>{P.dispose()})}}l([f.Basecoat.dispose()],A.prototype,"dispose",null),o.Graph=A,function(j){j.View=e.GraphView,j.Renderer=_.Renderer,j.MouseWheel=b.MouseWheel,j.DefsManager=O.DefsManager,j.GridManager=a.GridManager,j.CoordManager=x.CoordManager,j.TransformManager=d.TransformManager,j.HighlightManager=C.HighlightManager,j.BackgroundManager=m.BackgroundManager,j.PanningManager=p.PanningManager}(A=o.Graph||(o.Graph={})),function(j){j.toStringTag=`X6.${j.name}`;function v(P){if(P==null)return!1;if(P instanceof j)return!0;const E=P[Symbol.toStringTag];return E==null||E===j.toStringTag}j.isGraph=v}(A=o.Graph||(o.Graph={})),function(j){function v(P,E){const S=P instanceof HTMLElement?new j({container:P}):new j(P);return E!=null&&S.fromJSON(E),S}j.render=v}(A=o.Graph||(o.Graph={})),function(j){j.registerNode=u.Node.registry.register,j.registerEdge=u.Edge.registry.register,j.registerView=g.CellView.registry.register,j.registerAttr=s.Attr.registry.register,j.registerGrid=s.Grid.registry.register,j.registerFilter=s.Filter.registry.register,j.registerNodeTool=s.NodeTool.registry.register,j.registerEdgeTool=s.EdgeTool.registry.register,j.registerBackground=s.Background.registry.register,j.registerHighlighter=s.Highlighter.registry.register,j.registerPortLayout=s.PortLayout.registry.register,j.registerPortLabelLayout=s.PortLabelLayout.registry.register,j.registerMarker=s.Marker.registry.register,j.registerRouter=s.Router.registry.register,j.registerConnector=s.Connector.registry.register,j.registerAnchor=s.NodeAnchor.registry.register,j.registerEdgeAnchor=s.EdgeAnchor.registry.register,j.registerConnectionPoint=s.ConnectionPoint.registry.register}(A=o.Graph||(o.Graph={})),function(j){j.unregisterNode=u.Node.registry.unregister,j.unregisterEdge=u.Edge.registry.unregister,j.unregisterView=g.CellView.registry.unregister,j.unregisterAttr=s.Attr.registry.unregister,j.unregisterGrid=s.Grid.registry.unregister,j.unregisterFilter=s.Filter.registry.unregister,j.unregisterNodeTool=s.NodeTool.registry.unregister,j.unregisterEdgeTool=s.EdgeTool.registry.unregister,j.unregisterBackground=s.Background.registry.unregister,j.unregisterHighlighter=s.Highlighter.registry.unregister,j.unregisterPortLayout=s.PortLayout.registry.unregister,j.unregisterPortLabelLayout=s.PortLabelLayout.registry.unregister,j.unregisterMarker=s.Marker.registry.unregister,j.unregisterRouter=s.Router.registry.unregister,j.unregisterConnector=s.Connector.registry.unregister,j.unregisterAnchor=s.NodeAnchor.registry.unregister,j.unregisterEdgeAnchor=s.EdgeAnchor.registry.unregister,j.unregisterConnectionPoint=s.ConnectionPoint.registry.unregister}(A=o.Graph||(o.Graph={}))}(br)),br}var Di;function Hu(){return Di||(Di=1,function(o){var r=w&&w.__decorate||function(s,e,t,n){var a=arguments.length,d=a<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(s,e,t,n);else for(var p=s.length-1;p>=0;p--)(m=s[p])&&(d=(a<3?m(d):a>3?m(e,t,d):m(e,t))||d);return a>3&&d&&Object.defineProperty(e,t,d),d},i=w&&w.__rest||function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(t[n[a]]=s[n[a]]);return t};Object.defineProperty(o,"__esModule",{value:!0}),o.HTML=void 0;const l=D,c=Ne,f=An,h=In,u=Js();class g extends f.Node{}o.HTML=g,function(s){class e extends h.NodeView{init(){super.init(),this.cell.on("change:*",this.onCellChangeAny,this)}onCellChangeAny({key:n}){const a=s.shapeMaps[this.cell.shape];if(a){const{effect:d}=a;(!d||d.includes(n))&&this.renderHTMLComponent()}}confirmUpdate(n){const a=super.confirmUpdate(n);return this.handleAction(a,e.action,()=>this.renderHTMLComponent())}renderHTMLComponent(){const n=this.selectors&&this.selectors.foContent;if(n){l.Dom.empty(n);const a=s.shapeMaps[this.cell.shape];if(!a)return;let{html:d}=a;typeof d=="function"&&(d=d(this.cell)),d&&(typeof d=="string"?n.innerHTML=d:l.Dom.append(n,d))}}dispose(){this.cell.off("change:*",this.onCellChangeAny,this)}}r([e.dispose()],e.prototype,"dispose",null),s.View=e,function(t){t.action="html",t.config({bootstrap:[t.action],actions:{html:t.action}}),h.NodeView.registry.register("html-view",t,!0)}(e=s.View||(s.View={}))}(g=o.HTML||(o.HTML={})),function(s){s.config({view:"html-view",markup:[{tagName:"rect",selector:"body"},Object.assign({},c.Markup.getForeignObjectMarkup()),{tagName:"text",selector:"label"}],attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}}}),f.Node.registry.register("html",s,!0)}(g=o.HTML||(o.HTML={})),function(s){s.shapeMaps={};function e(t){const{shape:n,html:a,effect:d,inherit:m}=t,p=i(t,["shape","html","effect","inherit"]);if(!n)throw new Error("should specify shape in config");s.shapeMaps[n]={html:a,effect:d},u.Graph.registerNode(n,Object.assign({inherit:m||"html"},p),!0)}s.register=e}(g=o.HTML||(o.HTML={}))}(mr)),mr}var Ti;function Ys(){return Ti||(Ti=1,function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(Je,o),i(Ke,o),i(Je,o),i(Tn,o),i(Bn,o),i(Nn,o),i(Rn,o),i($n,o),i(Vn,o),i(Ke,o),i(Ln,o),i(Hu(),o)}(Zn)),Zn}var Ks={},Zs={};Object.defineProperty(Zs,"__esModule",{value:!0});(function(o){var r=w&&w.__createBinding||(Object.create?function(l,c,f,h){h===void 0&&(h=f);var u=Object.getOwnPropertyDescriptor(c,f);(!u||("get"in u?!c.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return c[f]}}),Object.defineProperty(l,h,u)}:function(l,c,f,h){h===void 0&&(h=f),l[h]=c[f]}),i=w&&w.__exportStar||function(l,c){for(var f in l)f!=="default"&&!Object.prototype.hasOwnProperty.call(c,f)&&r(c,l,f)};Object.defineProperty(o,"__esModule",{value:!0}),i(Js(),o),i(Rr,o),i(Zs,o),i(ot,o),i(at,o),i(Ts(),o)})(Ks);(function(o){var r=w&&w.__createBinding||(Object.create?function(u,g,s,e){e===void 0&&(e=s);var t=Object.getOwnPropertyDescriptor(g,s);(!t||("get"in t?!g.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return g[s]}}),Object.defineProperty(u,e,t)}:function(u,g,s,e){e===void 0&&(e=s),u[e]=g[s]}),i=w&&w.__setModuleDefault||(Object.create?function(u,g){Object.defineProperty(u,"default",{enumerable:!0,value:g})}:function(u,g){u.default=g}),l=w&&w.__importStar||function(u){if(u&&u.__esModule)return u;var g={};if(u!=null)for(var s in u)s!=="default"&&Object.prototype.hasOwnProperty.call(u,s)&&r(g,u,s);return i(g,u),g},c=w&&w.__exportStar||function(u,g){for(var s in u)s!=="default"&&!Object.prototype.hasOwnProperty.call(g,s)&&r(g,u,s)};Object.defineProperty(o,"__esModule",{value:!0}),o.Registry=o.Shape=void 0;const f=l(Ys());o.Shape=f;const h=l(ae);o.Registry=h,c(Ge,o),c(Ne,o),c(Ks,o),c(ce,o),c(ue,o),c(D,o),c(B,o)})(no);export{no as l};

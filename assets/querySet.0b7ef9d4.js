import{g as vt,a2 as Mt,_ as st}from"./index.0af4b258.js";import{f as $t}from"./index.efeafa02.js";const Rt={name:"categoryTree",props:{treeTitle:{type:String,default:"\u8868\u5355\u7BA1\u7406"},actived:{type:String,default:"-0000"},type:{type:String,default:"1"},type_name:{type:String,default:"\u6570\u636E\u96C6\u5206\u7C7B"},setList:{type:Array,default:()=>[]},list:{type:Array,default:()=>[]},isEditable:{type:Boolean,default:!0},boxwidth:{type:String,default:"279px"},isCheckable:{type:Boolean,default:!1},showTitle:{type:String,default:""}},data(){return{activeTab:"0",ruleForm:{},typeTitle:"\u5206\u7EC4",dialogTitle:"",showTypeVisible:!1,rules:{name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:["change","input","blur"]}]},act:"",arr:[],isShow:!0,editCheckedId:"",isClear:!1}},watch:{list:{deep:!0,handler(a){this.arr=JSON.parse(JSON.stringify(a))}},actived:{deep:!0,handler(a){this.$nextTick(()=>{this.$refs.tree.setCurrentKey(a)})}}},methods:{foldTree(){this.isShow=!this.isShow,this.$emit("toggleShow",this.isShow)},handleTabClick(a){this.activeTab=a.name,this.$emit("getCate")},onMove(a){return a.to.id!="-0000"},onEnd(a){const{from:{id:e},to:{id:t}}=a;let i=this.list.find(o=>o.id===e),n=this.list.find(o=>o.id===t);if(e!==t&&i.parent_id!==t&&i.parent_id!==n.parent_id){const o={act:"mov",id:i.id,type:this.type,parent_id:i.parent_id,nparent_id:n.parent_id!=="0"?n.parent_id:t};console.log(o),this.$api.customForm.actSort(o).then(r=>{r.status==100?(this.$message.success(r.msg),this.$emit("getCate",this.ruleForm.id)):this.$message.error(r.msg)})}},handleTypeCommand(a,e){a==="a"?this.addType(e.level,e):a==="b"?this.editType(e.level,e.data):a==="c"&&this.delType(e)},chooseType(a){this.$emit("chooseType",a)},check(a){this.$emit("check",a)},checkChange(a,e){this.isClear?this.$refs.tree.setCheckedKeys([]):(e===!0&&(this.editCheckedId=a.id,this.$refs.tree.setCheckedKeys([a.id]),console.log(this.$refs.tree)),this.$emit("check",this.editCheckedId))},clearChecked(){this.isClear=!0,this.$refs.tree.setCheckedKeys([])},changeClear(){this.isClear=!1},addType(a,e){this.act="add",this.ruleForm=this.$options.data().ruleForm,this.showTypeVisible=!0,this.$refs.ruleForm&&this.$refs.ruleForm.resetFields(),a?(this.typeTitle="\u5206\u7C7B",this.dialogTitle="\u65B0\u589E\u5206\u7C7B",this.ruleForm.parent_id=e.data.id):(this.typeTitle="\u5206\u7EC4",this.dialogTitle="\u65B0\u5EFA\u5206\u7EC4",this.ruleForm.parent_id="0")},editType(a,e){this.$refs.ruleForm&&this.$refs.ruleForm.clearValidate(),this.act="mod",this.showTypeVisible=!0,this.ruleForm={...e,level:a},a==1?(this.typeTitle="\u5206\u7EC4",this.dialogTitle="\u7F16\u8F91\u5206\u7EC4"):(this.typeTitle="\u5206\u7C7B",this.dialogTitle="\u7F16\u8F91\u5206\u7C7B")},async delType(a){this.$confirm("\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u6570\u636E, \u662F\u5426\u7EE7\u7EED?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88"}).then(async()=>{this.act="del";const e={act:this.act,...a.data,type:this.type,type_name:this.type_name,dat_range:this.activeTab};if(a.data.children&&a.data.children.length>0){this.$message.warning("\u8BF7\u5148\u5220\u9664\u5B50\u7EA7\u6570\u636E");return}else{let t={};const n={1:"getTableList",2:"getFormListByCate",3:"getQryPgLstBySort"}[this.type],o=this.type=="3"?"qrypage":"customForm";t=await this.$api[o][n]({pageNum:0,pageSize:0,filter:{sortId:a.data.id}});const{data:{list:r}}=t,s=r.filter(l=>l.status!=="3");if(s&&s.length>0){this.$message.warning("\u8BF7\u5148\u5220\u9664\u5B50\u7EA7\u6570\u636E");return}}this.$api.customForm.submitSortInfo(e).then(t=>{t.status==102?(this.$message.success(t.msg),this.$emit("getCate")):this.$message.warning(t.msg)})}).catch(e=>{console.log(e)})},submitForm(){this.$refs.ruleForm.validate(a=>{if(a){delete this.ruleForm.children,delete this.ruleForm.level;const e={act:this.act,...this.ruleForm,type:this.type,type_name:this.type_name,dat_range:this.activeTab};console.log(e),this.$api.customForm.submitSortInfo(e).then(t=>{t.status==100?(this.$message.success(t.msg),this.$emit("getCate",this.ruleForm.id),this.closeForm()):this.$message.error(t.msg)})}})},closeForm(){this.showTypeVisible=!1,this.$refs.ruleForm.resetFields()}}};var Pt=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"treeCon",class:e.isEditable?"":"moveCon",style:{width:e.boxwidth}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isEditable||e.showTitle=="1",expression:"isEditable || showTitle=='1'"}],staticClass:"tree-title"},[t("span",[e._v(e._s(e.treeTitle))]),t("i",{staticClass:"el-icon-d-arrow-left",on:{click:e.foldTree}})]),t("el-tabs",{style:e.isEditable?"":{height:"100%"},on:{"tab-click":e.handleTabClick},model:{value:e.activeTab,callback:function(i){e.activeTab=i},expression:"activeTab"}},[t("el-tab-pane",{attrs:{label:"\u7EC4\u7EC7\u7A7A\u95F4",name:"0"}},[e.activeTab==="0"?t("el-tree",{ref:"tree",staticClass:"aside_tree",style:e.isEditable?"":{height:"100%"},attrs:{data:e.setList,"node-key":"id","default-expand-all":"","check-strictly":"",indent:24,"show-checkbox":e.isCheckable,"expand-on-click-node":!1,"highlight-current":!e.isCheckable,"current-node-key":e.actived},on:{"node-click":e.chooseType,"check-change":e.checkChange},scopedSlots:e._u([{key:"default",fn:function({node:i,data:n}){return t("span",{staticClass:"custom-tree-node"},[t("draggable",e._b({staticClass:"draggable-node",attrs:{id:n.id,filter:".forbid",chosenClass:"chosen",ghostClass:"ghost",move:e.onMove},on:{end:e.onEnd},model:{value:e.arr,callback:function(o){e.arr=o},expression:"arr"}},"draggable",{animation:150,group:{name:"name",pull:!0},sort:!0},!1),[t("span",{class:[e.actived==n.id?"activedColor":"",n.parent_id=="0"?"forbid":""]},[i.level===1?t("i",{class:n.icon?`el-icon-my-${n.icon}`:"el-icon-my-folder",staticStyle:{"margin-right":"8px"}}):e._e(),t("span",[e._v(e._s(n.name))])]),t("div",{directives:[{name:"show",rawName:"v-show",value:n.name!=="\u9ED8\u8BA4\u5206\u7EC4"&&e.isEditable,expression:"data.name !=='\u9ED8\u8BA4\u5206\u7EC4' && isEditable"}],staticClass:"card-item-dropMenu",on:{click:function(o){o.stopPropagation()}}},[t("el-dropdown",{attrs:{trigger:"click","hide-on-click":!1},on:{command:o=>{e.handleTypeCommand(o,i)}}},[t("i",{staticClass:"el-dropdown-link",class:e.actived===n.id?"el-icon-my-moreActive":"",staticStyle:{cursor:"pointer"}}),t("el-dropdown-menu",[i.level===1?t("el-dropdown-item",{attrs:{command:"a"}},[e._v("\u65B0\u589E\u5206\u7C7B")]):e._e(),t("el-dropdown-item",{attrs:{command:"b"}},[e._v(e._s(i.level===1?"\u7F16\u8F91\u5206\u7EC4":"\u7F16\u8F91\u5206\u7C7B"))]),t("el-dropdown-item",{attrs:{command:"c"}},[e._v(e._s(i.level===1?"\u5220\u9664\u5206\u7EC4":"\u5220\u9664\u5206\u7C7B"))])],1)],1)],1)])],1)}}],null,!1,3405495654)}):e._e()],1),t("el-tab-pane",{attrs:{label:"\u5E73\u53F0\u7A7A\u95F4",name:"1"}},[e.activeTab==="1"?t("el-tree",{ref:"tree",staticClass:"aside_tree",attrs:{data:e.setList,"node-key":"id","default-expand-all":"","check-strictly":"",indent:24,"show-checkbox":e.isCheckable,"expand-on-click-node":!1,"highlight-current":!e.isCheckable,"current-node-key":e.actived},on:{"node-click":e.chooseType,"check-change":e.checkChange},scopedSlots:e._u([{key:"default",fn:function({node:i,data:n}){return t("span",{staticClass:"custom-tree-node"},[t("draggable",e._b({staticClass:"draggable-node",attrs:{id:n.id,filter:".forbid",chosenClass:"chosen",ghostClass:"ghost",move:e.onMove},on:{end:e.onEnd},model:{value:e.arr,callback:function(o){e.arr=o},expression:"arr"}},"draggable",{animation:150,group:{name:"name",pull:!0},sort:!0},!1),[t("span",{class:[e.actived==n.id?"activedColor":"",n.parent_id=="0"?"forbid":""]},[i.level===1?t("i",{class:n.icon?`el-icon-my-${n.icon}`:"el-icon-my-folder",staticStyle:{"margin-right":"8px"}}):e._e(),t("span",[e._v(e._s(n.name))])]),t("div",{directives:[{name:"show",rawName:"v-show",value:n.name!=="\u9ED8\u8BA4\u5206\u7EC4"&&e.isEditable,expression:"data.name !=='\u9ED8\u8BA4\u5206\u7EC4' && isEditable"}],staticClass:"card-item-dropMenu",on:{click:function(o){o.stopPropagation()}}},[t("el-dropdown",{attrs:{trigger:"click","hide-on-click":!1},on:{command:o=>{e.handleTypeCommand(o,i)}}},[t("i",{staticClass:"el-dropdown-link",class:e.actived===n.id?"el-icon-my-moreActive":"",staticStyle:{cursor:"pointer"}}),t("el-dropdown-menu",[i.level===1?t("el-dropdown-item",{attrs:{command:"a"}},[e._v("\u65B0\u589E\u5206\u7C7B")]):e._e(),t("el-dropdown-item",{attrs:{command:"b"}},[e._v(e._s(i.level===1?"\u7F16\u8F91\u5206\u7EC4":"\u7F16\u8F91\u5206\u7C7B"))]),t("el-dropdown-item",{attrs:{command:"c"}},[e._v(e._s(i.level===1?"\u5220\u9664\u5206\u7EC4":"\u5220\u9664\u5206\u7C7B"))])],1)],1)],1)])],1)}}],null,!1,3405495654)}):e._e()],1)],1),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isEditable,expression:"isEditable"}],staticClass:"bottom_btn",attrs:{plain:"",type:"primary",icon:"el-icon-plus"},on:{click:function(i){return e.addType(0)}}},[e._v("\u65B0\u5EFA\u5206\u7EC4")]),t("el-dialog",{staticClass:"view-edit",attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.showTypeVisible,"before-close":e.closeForm,"append-to-body":""},on:{"update:visible":function(i){e.showTypeVisible=i}}},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px",size:"mini"}},[t("el-form-item",{attrs:{label:e.typeTitle+"\u540D\u79F0",prop:"name",required:""}},[t("el-input",{model:{value:e.ruleForm.name,callback:function(i){e.$set(e.ruleForm,"name",typeof i=="string"?i.trim():i)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:"\u5E8F\u53F7",prop:"sort_index"}},[t("el-input-number",{attrs:{"controls-position":"right"},model:{value:e.ruleForm.sort_index,callback:function(i){e.$set(e.ruleForm,"sort_index",i)},expression:"ruleForm.sort_index"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.submitForm}},[e._v("\u786E\u5B9A")]),t("el-button",{attrs:{size:"mini"},on:{click:e.closeForm}},[e._v("\u53D6\u6D88")])],1)],1)],1)},Vt=[],Lt=vt(Rt,Pt,Vt,!1,null,"6e99e2ce",null,null);const Ht=Lt.exports;/**!
 * Sortable 1.15.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function lt(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),t.push.apply(t,i)}return t}function Y(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?lt(Object(t),!0).forEach(function(i){zt(a,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):lt(Object(t)).forEach(function(i){Object.defineProperty(a,i,Object.getOwnPropertyDescriptor(t,i))})}return a}function Ae(a){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ae=function(e){return typeof e}:Ae=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(a)}function zt(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function q(){return q=Object.assign||function(a){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i])}return a},q.apply(this,arguments)}function Bt(a,e){if(a==null)return{};var t={},i=Object.keys(a),n,o;for(o=0;o<i.length;o++)n=i[o],!(e.indexOf(n)>=0)&&(t[n]=a[n]);return t}function Xt(a,e){if(a==null)return{};var t=Bt(a,e),i,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(n=0;n<o.length;n++)i=o[n],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(a,i)||(t[i]=a[i]))}return t}var Yt="1.15.2";function G(a){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(a)}var j=G(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Ee=G(/Edge/i),ct=G(/firefox/i),we=G(/safari/i)&&!G(/chrome/i)&&!G(/android/i),bt=G(/iP(ad|od|hone)/i),yt=G(/chrome/i)&&G(/android/i),St={capture:!1,passive:!1};function y(a,e,t){a.addEventListener(e,t,!j&&St)}function b(a,e,t){a.removeEventListener(e,t,!j&&St)}function Ve(a,e){if(!!e){if(e[0]===">"&&(e=e.substring(1)),a)try{if(a.matches)return a.matches(e);if(a.msMatchesSelector)return a.msMatchesSelector(e);if(a.webkitMatchesSelector)return a.webkitMatchesSelector(e)}catch{return!1}return!1}}function Wt(a){return a.host&&a!==document&&a.host.nodeType?a.host:a.parentNode}function z(a,e,t,i){if(a){t=t||document;do{if(e!=null&&(e[0]===">"?a.parentNode===t&&Ve(a,e):Ve(a,e))||i&&a===t)return a;if(a===t)break}while(a=Wt(a))}return null}var dt=/\s+/g;function M(a,e,t){if(a&&e)if(a.classList)a.classList[t?"add":"remove"](e);else{var i=(" "+a.className+" ").replace(dt," ").replace(" "+e+" "," ");a.className=(i+(t?" "+e:"")).replace(dt," ")}}function h(a,e,t){var i=a&&a.style;if(i){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(a,""):a.currentStyle&&(t=a.currentStyle),e===void 0?t:t[e];!(e in i)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),i[e]=t+(typeof t=="string"?"":"px")}}function ue(a,e){var t="";if(typeof a=="string")t=a;else do{var i=h(a,"transform");i&&i!=="none"&&(t=i+" "+t)}while(!e&&(a=a.parentNode));var n=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return n&&new n(t)}function wt(a,e,t){if(a){var i=a.getElementsByTagName(e),n=0,o=i.length;if(t)for(;n<o;n++)t(i[n],n);return i}return[]}function X(){var a=document.scrollingElement;return a||document.documentElement}function E(a,e,t,i,n){if(!(!a.getBoundingClientRect&&a!==window)){var o,r,s,l,c,u,f;if(a!==window&&a.parentNode&&a!==X()?(o=a.getBoundingClientRect(),r=o.top,s=o.left,l=o.bottom,c=o.right,u=o.height,f=o.width):(r=0,s=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,f=window.innerWidth),(e||t)&&a!==window&&(n=n||a.parentNode,!j))do if(n&&n.getBoundingClientRect&&(h(n,"transform")!=="none"||t&&h(n,"position")!=="static")){var g=n.getBoundingClientRect();r-=g.top+parseInt(h(n,"border-top-width")),s-=g.left+parseInt(h(n,"border-left-width")),l=r+o.height,c=s+o.width;break}while(n=n.parentNode);if(i&&a!==window){var w=ue(n||a),v=w&&w.a,S=w&&w.d;w&&(r/=S,s/=v,f/=v,u/=S,l=r+u,c=s+f)}return{top:r,left:s,bottom:l,right:c,width:f,height:u}}}function ut(a,e,t){for(var i=ee(a,!0),n=E(a)[e];i;){var o=E(i)[t],r=void 0;if(t==="top"||t==="left"?r=n>=o:r=n<=o,!r)return i;if(i===X())break;i=ee(i,!1)}return!1}function fe(a,e,t,i){for(var n=0,o=0,r=a.children;o<r.length;){if(r[o].style.display!=="none"&&r[o]!==p.ghost&&(i||r[o]!==p.dragged)&&z(r[o],t.draggable,a,!1)){if(n===e)return r[o];n++}o++}return null}function at(a,e){for(var t=a.lastElementChild;t&&(t===p.ghost||h(t,"display")==="none"||e&&!Ve(t,e));)t=t.previousElementSibling;return t||null}function P(a,e){var t=0;if(!a||!a.parentNode)return-1;for(;a=a.previousElementSibling;)a.nodeName.toUpperCase()!=="TEMPLATE"&&a!==p.clone&&(!e||Ve(a,e))&&t++;return t}function ft(a){var e=0,t=0,i=X();if(a)do{var n=ue(a),o=n.a,r=n.d;e+=a.scrollLeft*o,t+=a.scrollTop*r}while(a!==i&&(a=a.parentNode));return[e,t]}function Jt(a,e){for(var t in a)if(!!a.hasOwnProperty(t)){for(var i in e)if(e.hasOwnProperty(i)&&e[i]===a[t][i])return Number(t)}return-1}function ee(a,e){if(!a||!a.getBoundingClientRect)return X();var t=a,i=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var n=h(t);if(t.clientWidth<t.scrollWidth&&(n.overflowX=="auto"||n.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(n.overflowY=="auto"||n.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return X();if(i||e)return t;i=!0}}while(t=t.parentNode);return X()}function Gt(a,e){if(a&&e)for(var t in e)e.hasOwnProperty(t)&&(a[t]=e[t]);return a}function Ye(a,e){return Math.round(a.top)===Math.round(e.top)&&Math.round(a.left)===Math.round(e.left)&&Math.round(a.height)===Math.round(e.height)&&Math.round(a.width)===Math.round(e.width)}var _e;function _t(a,e){return function(){if(!_e){var t=arguments,i=this;t.length===1?a.call(i,t[0]):a.apply(i,t),_e=setTimeout(function(){_e=void 0},e)}}}function qt(){clearTimeout(_e),_e=void 0}function Dt(a,e,t){a.scrollLeft+=e,a.scrollTop+=t}function Ct(a){var e=window.Polymer,t=window.jQuery||window.Zepto;return e&&e.dom?e.dom(a).cloneNode(!0):t?t(a).clone(!0)[0]:a.cloneNode(!0)}function Tt(a,e,t){var i={};return Array.from(a.children).forEach(function(n){var o,r,s,l;if(!(!z(n,e.draggable,a,!1)||n.animated||n===t)){var c=E(n);i.left=Math.min((o=i.left)!==null&&o!==void 0?o:1/0,c.left),i.top=Math.min((r=i.top)!==null&&r!==void 0?r:1/0,c.top),i.right=Math.max((s=i.right)!==null&&s!==void 0?s:-1/0,c.right),i.bottom=Math.max((l=i.bottom)!==null&&l!==void 0?l:-1/0,c.bottom)}}),i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}var R="Sortable"+new Date().getTime();function jt(){var a=[],e;return{captureAnimationState:function(){if(a=[],!!this.options.animation){var i=[].slice.call(this.el.children);i.forEach(function(n){if(!(h(n,"display")==="none"||n===p.ghost)){a.push({target:n,rect:E(n)});var o=Y({},a[a.length-1].rect);if(n.thisAnimationDuration){var r=ue(n,!0);r&&(o.top-=r.f,o.left-=r.e)}n.fromRect=o}})}},addAnimationState:function(i){a.push(i)},removeAnimationState:function(i){a.splice(Jt(a,{target:i}),1)},animateAll:function(i){var n=this;if(!this.options.animation){clearTimeout(e),typeof i=="function"&&i();return}var o=!1,r=0;a.forEach(function(s){var l=0,c=s.target,u=c.fromRect,f=E(c),g=c.prevFromRect,w=c.prevToRect,v=s.rect,S=ue(c,!0);S&&(f.top-=S.f,f.left-=S.e),c.toRect=f,c.thisAnimationDuration&&Ye(g,f)&&!Ye(u,f)&&(v.top-f.top)/(v.left-f.left)===(u.top-f.top)/(u.left-f.left)&&(l=Kt(v,g,w,n.options)),Ye(f,u)||(c.prevFromRect=u,c.prevToRect=f,l||(l=n.options.animation),n.animate(c,v,f,l)),l&&(o=!0,r=Math.max(r,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(e),o?e=setTimeout(function(){typeof i=="function"&&i()},r):typeof i=="function"&&i(),a=[]},animate:function(i,n,o,r){if(r){h(i,"transition",""),h(i,"transform","");var s=ue(this.el),l=s&&s.a,c=s&&s.d,u=(n.left-o.left)/(l||1),f=(n.top-o.top)/(c||1);i.animatingX=!!u,i.animatingY=!!f,h(i,"transform","translate3d("+u+"px,"+f+"px,0)"),this.forRepaintDummy=Ut(i),h(i,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),h(i,"transform","translate3d(0,0,0)"),typeof i.animated=="number"&&clearTimeout(i.animated),i.animated=setTimeout(function(){h(i,"transition",""),h(i,"transform",""),i.animated=!1,i.animatingX=!1,i.animatingY=!1},r)}}}}function Ut(a){return a.offsetWidth}function Kt(a,e,t,i){return Math.sqrt(Math.pow(e.top-a.top,2)+Math.pow(e.left-a.left,2))/Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))*i.animation}var se=[],We={initializeByDefault:!0},xe={mount:function(e){for(var t in We)We.hasOwnProperty(t)&&!(t in e)&&(e[t]=We[t]);se.forEach(function(i){if(i.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),se.push(e)},pluginEvent:function(e,t,i){var n=this;this.eventCanceled=!1,i.cancel=function(){n.eventCanceled=!0};var o=e+"Global";se.forEach(function(r){!t[r.pluginName]||(t[r.pluginName][o]&&t[r.pluginName][o](Y({sortable:t},i)),t.options[r.pluginName]&&t[r.pluginName][e]&&t[r.pluginName][e](Y({sortable:t},i)))})},initializePlugins:function(e,t,i,n){se.forEach(function(s){var l=s.pluginName;if(!(!e.options[l]&&!s.initializeByDefault)){var c=new s(e,t,e.options);c.sortable=e,c.options=e.options,e[l]=c,q(i,c.defaults)}});for(var o in e.options)if(!!e.options.hasOwnProperty(o)){var r=this.modifyOption(e,o,e.options[o]);typeof r<"u"&&(e.options[o]=r)}},getEventProperties:function(e,t){var i={};return se.forEach(function(n){typeof n.eventProperties=="function"&&q(i,n.eventProperties.call(t[n.pluginName],e))}),i},modifyOption:function(e,t,i){var n;return se.forEach(function(o){!e[o.pluginName]||o.optionListeners&&typeof o.optionListeners[t]=="function"&&(n=o.optionListeners[t].call(e[o.pluginName],i))}),n}};function Qt(a){var e=a.sortable,t=a.rootEl,i=a.name,n=a.targetEl,o=a.cloneEl,r=a.toEl,s=a.fromEl,l=a.oldIndex,c=a.newIndex,u=a.oldDraggableIndex,f=a.newDraggableIndex,g=a.originalEvent,w=a.putSortable,v=a.extraEventProperties;if(e=e||t&&t[R],!!e){var S,V=e.options,W="on"+i.charAt(0).toUpperCase()+i.substr(1);window.CustomEvent&&!j&&!Ee?S=new CustomEvent(i,{bubbles:!0,cancelable:!0}):(S=document.createEvent("Event"),S.initEvent(i,!0,!0)),S.to=r||t,S.from=s||t,S.item=n||t,S.clone=o,S.oldIndex=l,S.newIndex=c,S.oldDraggableIndex=u,S.newDraggableIndex=f,S.originalEvent=g,S.pullMode=w?w.lastPutMode:void 0;var I=Y(Y({},v),xe.getEventProperties(i,e));for(var L in I)S[L]=I[L];t&&t.dispatchEvent(S),V[W]&&V[W].call(e,S)}}var Zt=["evt"],O=function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=i.evt,o=Xt(i,Zt);xe.pluginEvent.bind(p)(e,t,Y({dragEl:d,parentEl:C,ghostEl:m,rootEl:_,nextEl:re,lastDownEl:Me,cloneEl:D,cloneHidden:Z,dragStarted:be,putSortable:x,activeSortable:p.active,originalEvent:n,oldIndex:de,oldDraggableIndex:De,newIndex:$,newDraggableIndex:Q,hideGhostForTarget:It,unhideGhostForTarget:Nt,cloneNowHidden:function(){Z=!0},cloneNowShown:function(){Z=!1},dispatchSortableEvent:function(s){N({sortable:t,name:s,originalEvent:n})}},o))};function N(a){Qt(Y({putSortable:x,cloneEl:D,targetEl:d,rootEl:_,oldIndex:de,oldDraggableIndex:De,newIndex:$,newDraggableIndex:Q},a))}var d,C,m,_,re,Me,D,Z,de,$,De,Q,Ie,x,ce=!1,Le=!1,He=[],ne,H,Je,Ge,ht,pt,be,le,Ce,Te=!1,Ne=!1,$e,k,qe=[],Ze=!1,ze=[],Xe=typeof document<"u",Oe=bt,mt=Ee||j?"cssFloat":"float",ei=Xe&&!yt&&!bt&&"draggable"in document.createElement("div"),Et=function(){if(!!Xe){if(j)return!1;var a=document.createElement("x");return a.style.cssText="pointer-events:auto",a.style.pointerEvents==="auto"}}(),xt=function(e,t){var i=h(e),n=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),o=fe(e,0,t),r=fe(e,1,t),s=o&&h(o),l=r&&h(r),c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+E(o).width,u=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+E(r).width;if(i.display==="flex")return i.flexDirection==="column"||i.flexDirection==="column-reverse"?"vertical":"horizontal";if(i.display==="grid")return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&s.float&&s.float!=="none"){var f=s.float==="left"?"left":"right";return r&&(l.clear==="both"||l.clear===f)?"vertical":"horizontal"}return o&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||c>=n&&i[mt]==="none"||r&&i[mt]==="none"&&c+u>n)?"vertical":"horizontal"},ti=function(e,t,i){var n=i?e.left:e.top,o=i?e.right:e.bottom,r=i?e.width:e.height,s=i?t.left:t.top,l=i?t.right:t.bottom,c=i?t.width:t.height;return n===s||o===l||n+r/2===s+c/2},ii=function(e,t){var i;return He.some(function(n){var o=n[R].options.emptyInsertThreshold;if(!(!o||at(n))){var r=E(n),s=e>=r.left-o&&e<=r.right+o,l=t>=r.top-o&&t<=r.bottom+o;if(s&&l)return i=n}}),i},kt=function(e){function t(o,r){return function(s,l,c,u){var f=s.options.group.name&&l.options.group.name&&s.options.group.name===l.options.group.name;if(o==null&&(r||f))return!0;if(o==null||o===!1)return!1;if(r&&o==="clone")return o;if(typeof o=="function")return t(o(s,l,c,u),r)(s,l,c,u);var g=(r?s:l).options.group.name;return o===!0||typeof o=="string"&&o===g||o.join&&o.indexOf(g)>-1}}var i={},n=e.group;(!n||Ae(n)!="object")&&(n={name:n}),i.name=n.name,i.checkPull=t(n.pull,!0),i.checkPut=t(n.put),i.revertClone=n.revertClone,e.group=i},It=function(){!Et&&m&&h(m,"display","none")},Nt=function(){!Et&&m&&h(m,"display","")};Xe&&!yt&&document.addEventListener("click",function(a){if(Le)return a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.stopImmediatePropagation&&a.stopImmediatePropagation(),Le=!1,!1},!0);var oe=function(e){if(d){e=e.touches?e.touches[0]:e;var t=ii(e.clientX,e.clientY);if(t){var i={};for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);i.target=i.rootEl=t,i.preventDefault=void 0,i.stopPropagation=void 0,t[R]._onDragOver(i)}}},ai=function(e){d&&d.parentNode[R]._isOutsideThisEl(e.target)};function p(a,e){if(!(a&&a.nodeType&&a.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(a));this.el=a,this.options=e=q({},e),a[R]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(a.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return xt(a,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(r,s){r.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:p.supportPointer!==!1&&"PointerEvent"in window&&!we,emptyInsertThreshold:5};xe.initializePlugins(this,a,t);for(var i in t)!(i in e)&&(e[i]=t[i]);kt(e);for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this));this.nativeDraggable=e.forceFallback?!1:ei,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?y(a,"pointerdown",this._onTapStart):(y(a,"mousedown",this._onTapStart),y(a,"touchstart",this._onTapStart)),this.nativeDraggable&&(y(a,"dragover",this),y(a,"dragenter",this)),He.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),q(this,jt())}p.prototype={constructor:p,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(le=null)},_getDirection:function(e,t){return typeof this.options.direction=="function"?this.options.direction.call(this,e,t,d):this.options.direction},_onTapStart:function(e){if(!!e.cancelable){var t=this,i=this.el,n=this.options,o=n.preventOnFilter,r=e.type,s=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(s||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,u=n.filter;if(ui(i),!d&&!(/mousedown|pointerdown/.test(r)&&e.button!==0||n.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&we&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=z(l,n.draggable,i,!1),!(l&&l.animated)&&Me!==l)){if(de=P(l),De=P(l,n.draggable),typeof u=="function"){if(u.call(this,e,l,this)){N({sortable:t,rootEl:c,name:"filter",targetEl:l,toEl:i,fromEl:i}),O("filter",t,{evt:e}),o&&e.cancelable&&e.preventDefault();return}}else if(u&&(u=u.split(",").some(function(f){if(f=z(c,f.trim(),i,!1),f)return N({sortable:t,rootEl:f,name:"filter",targetEl:l,fromEl:i,toEl:i}),O("filter",t,{evt:e}),!0}),u)){o&&e.cancelable&&e.preventDefault();return}n.handle&&!z(c,n.handle,i,!1)||this._prepareDragStart(e,s,l)}}},_prepareDragStart:function(e,t,i){var n=this,o=n.el,r=n.options,s=o.ownerDocument,l;if(i&&!d&&i.parentNode===o){var c=E(i);if(_=o,d=i,C=d.parentNode,re=d.nextSibling,Me=i,Ie=r.group,p.dragged=d,ne={target:d,clientX:(t||e).clientX,clientY:(t||e).clientY},ht=ne.clientX-c.left,pt=ne.clientY-c.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,d.style["will-change"]="all",l=function(){if(O("delayEnded",n,{evt:e}),p.eventCanceled){n._onDrop();return}n._disableDelayedDragEvents(),!ct&&n.nativeDraggable&&(d.draggable=!0),n._triggerDragStart(e,t),N({sortable:n,name:"choose",originalEvent:e}),M(d,r.chosenClass,!0)},r.ignore.split(",").forEach(function(u){wt(d,u.trim(),je)}),y(s,"dragover",oe),y(s,"mousemove",oe),y(s,"touchmove",oe),y(s,"mouseup",n._onDrop),y(s,"touchend",n._onDrop),y(s,"touchcancel",n._onDrop),ct&&this.nativeDraggable&&(this.options.touchStartThreshold=4,d.draggable=!0),O("delayStart",this,{evt:e}),r.delay&&(!r.delayOnTouchOnly||t)&&(!this.nativeDraggable||!(Ee||j))){if(p.eventCanceled){this._onDrop();return}y(s,"mouseup",n._disableDelayedDrag),y(s,"touchend",n._disableDelayedDrag),y(s,"touchcancel",n._disableDelayedDrag),y(s,"mousemove",n._delayedDragTouchMoveHandler),y(s,"touchmove",n._delayedDragTouchMoveHandler),r.supportPointer&&y(s,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(l,r.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){d&&je(d),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;b(e,"mouseup",this._disableDelayedDrag),b(e,"touchend",this._disableDelayedDrag),b(e,"touchcancel",this._disableDelayedDrag),b(e,"mousemove",this._delayedDragTouchMoveHandler),b(e,"touchmove",this._delayedDragTouchMoveHandler),b(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||e.pointerType=="touch"&&e,!this.nativeDraggable||t?this.options.supportPointer?y(document,"pointermove",this._onTouchMove):t?y(document,"touchmove",this._onTouchMove):y(document,"mousemove",this._onTouchMove):(y(d,"dragend",this),y(_,"dragstart",this._onDragStart));try{document.selection?Re(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,t){if(ce=!1,_&&d){O("dragStarted",this,{evt:t}),this.nativeDraggable&&y(document,"dragover",ai);var i=this.options;!e&&M(d,i.dragClass,!1),M(d,i.ghostClass,!0),p.active=this,e&&this._appendGhost(),N({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(H){this._lastX=H.clientX,this._lastY=H.clientY,It();for(var e=document.elementFromPoint(H.clientX,H.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(H.clientX,H.clientY),e!==t);)t=e;if(d.parentNode[R]._isOutsideThisEl(e),t)do{if(t[R]){var i=void 0;if(i=t[R]._onDragOver({clientX:H.clientX,clientY:H.clientY,target:e,rootEl:t}),i&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);Nt()}},_onTouchMove:function(e){if(ne){var t=this.options,i=t.fallbackTolerance,n=t.fallbackOffset,o=e.touches?e.touches[0]:e,r=m&&ue(m,!0),s=m&&r&&r.a,l=m&&r&&r.d,c=Oe&&k&&ft(k),u=(o.clientX-ne.clientX+n.x)/(s||1)+(c?c[0]-qe[0]:0)/(s||1),f=(o.clientY-ne.clientY+n.y)/(l||1)+(c?c[1]-qe[1]:0)/(l||1);if(!p.active&&!ce){if(i&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(m){r?(r.e+=u-(Je||0),r.f+=f-(Ge||0)):r={a:1,b:0,c:0,d:1,e:u,f};var g="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");h(m,"webkitTransform",g),h(m,"mozTransform",g),h(m,"msTransform",g),h(m,"transform",g),Je=u,Ge=f,H=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!m){var e=this.options.fallbackOnBody?document.body:_,t=E(d,!0,Oe,!0,e),i=this.options;if(Oe){for(k=e;h(k,"position")==="static"&&h(k,"transform")==="none"&&k!==document;)k=k.parentNode;k!==document.body&&k!==document.documentElement?(k===document&&(k=X()),t.top+=k.scrollTop,t.left+=k.scrollLeft):k=X(),qe=ft(k)}m=d.cloneNode(!0),M(m,i.ghostClass,!1),M(m,i.fallbackClass,!0),M(m,i.dragClass,!0),h(m,"transition",""),h(m,"transform",""),h(m,"box-sizing","border-box"),h(m,"margin",0),h(m,"top",t.top),h(m,"left",t.left),h(m,"width",t.width),h(m,"height",t.height),h(m,"opacity","0.8"),h(m,"position",Oe?"absolute":"fixed"),h(m,"zIndex","100000"),h(m,"pointerEvents","none"),p.ghost=m,e.appendChild(m),h(m,"transform-origin",ht/parseInt(m.style.width)*100+"% "+pt/parseInt(m.style.height)*100+"%")}},_onDragStart:function(e,t){var i=this,n=e.dataTransfer,o=i.options;if(O("dragStart",this,{evt:e}),p.eventCanceled){this._onDrop();return}O("setupClone",this),p.eventCanceled||(D=Ct(d),D.removeAttribute("id"),D.draggable=!1,D.style["will-change"]="",this._hideClone(),M(D,this.options.chosenClass,!1),p.clone=D),i.cloneId=Re(function(){O("clone",i),!p.eventCanceled&&(i.options.removeCloneOnHide||_.insertBefore(D,d),i._hideClone(),N({sortable:i,name:"clone"}))}),!t&&M(d,o.dragClass,!0),t?(Le=!0,i._loopId=setInterval(i._emulateDragOver,50)):(b(document,"mouseup",i._onDrop),b(document,"touchend",i._onDrop),b(document,"touchcancel",i._onDrop),n&&(n.effectAllowed="move",o.setData&&o.setData.call(i,n,d)),y(document,"drop",i),h(d,"transform","translateZ(0)")),ce=!0,i._dragStartId=Re(i._dragStarted.bind(i,t,e)),y(document,"selectstart",i),be=!0,we&&h(document.body,"user-select","none")},_onDragOver:function(e){var t=this.el,i=e.target,n,o,r,s=this.options,l=s.group,c=p.active,u=Ie===l,f=s.sort,g=x||c,w,v=this,S=!1;if(Ze)return;function V(ve,Ft){O(ve,v,Y({evt:e,isOwner:u,axis:w?"vertical":"horizontal",revert:r,dragRect:n,targetRect:o,canSort:f,fromSortable:g,target:i,completed:I,onMove:function(rt,At){return Fe(_,t,d,n,rt,E(rt),e,At)},changed:L},Ft))}function W(){V("dragOverAnimationCapture"),v.captureAnimationState(),v!==g&&g.captureAnimationState()}function I(ve){return V("dragOverCompleted",{insertion:ve}),ve&&(u?c._hideClone():c._showClone(v),v!==g&&(M(d,x?x.options.ghostClass:c.options.ghostClass,!1),M(d,s.ghostClass,!0)),x!==v&&v!==p.active?x=v:v===p.active&&x&&(x=null),g===v&&(v._ignoreWhileAnimating=i),v.animateAll(function(){V("dragOverAnimationComplete"),v._ignoreWhileAnimating=null}),v!==g&&(g.animateAll(),g._ignoreWhileAnimating=null)),(i===d&&!d.animated||i===t&&!i.animated)&&(le=null),!s.dragoverBubble&&!e.rootEl&&i!==document&&(d.parentNode[R]._isOutsideThisEl(e.target),!ve&&oe(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),S=!0}function L(){$=P(d),Q=P(d,s.draggable),N({sortable:v,name:"change",toEl:t,newIndex:$,newDraggableIndex:Q,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),i=z(i,s.draggable,t,!0),V("dragOver"),p.eventCanceled)return S;if(d.contains(e.target)||i.animated&&i.animatingX&&i.animatingY||v._ignoreWhileAnimating===i)return I(!1);if(Le=!1,c&&!s.disabled&&(u?f||(r=C!==_):x===this||(this.lastPutMode=Ie.checkPull(this,c,d,e))&&l.checkPut(this,c,d,e))){if(w=this._getDirection(e,i)==="vertical",n=E(d),V("dragOverValid"),p.eventCanceled)return S;if(r)return C=_,W(),this._hideClone(),V("revert"),p.eventCanceled||(re?_.insertBefore(d,re):_.appendChild(d)),I(!0);var F=at(t,s.draggable);if(!F||si(e,w,this)&&!F.animated){if(F===d)return I(!1);if(F&&t===e.target&&(i=F),i&&(o=E(i)),Fe(_,t,d,n,i,o,e,!!i)!==!1)return W(),F&&F.nextSibling?t.insertBefore(d,F.nextSibling):t.appendChild(d),C=t,L(),I(!0)}else if(F&&ri(e,w,this)){var te=fe(t,0,s,!0);if(te===d)return I(!1);if(i=te,o=E(i),Fe(_,t,d,n,i,o,e,!1)!==!1)return W(),t.insertBefore(d,te),C=t,L(),I(!0)}else if(i.parentNode===t){o=E(i);var B=0,ie,he=d.parentNode!==t,A=!ti(d.animated&&d.toRect||n,i.animated&&i.toRect||o,w),pe=w?"top":"left",U=ut(i,"top","top")||ut(d,"top","top"),me=U?U.scrollTop:void 0;le!==i&&(ie=o[pe],Te=!1,Ne=!A&&s.invertSwap||he),B=li(e,i,o,w,A?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,Ne,le===i);var J;if(B!==0){var ae=P(d);do ae-=B,J=C.children[ae];while(J&&(h(J,"display")==="none"||J===m))}if(B===0||J===i)return I(!1);le=i,Ce=B;var ge=i.nextElementSibling,K=!1;K=B===1;var ke=Fe(_,t,d,n,i,o,e,K);if(ke!==!1)return(ke===1||ke===-1)&&(K=ke===1),Ze=!0,setTimeout(oi,30),W(),K&&!ge?t.appendChild(d):i.parentNode.insertBefore(d,K?ge:i),U&&Dt(U,0,me-U.scrollTop),C=d.parentNode,ie!==void 0&&!Ne&&($e=Math.abs(ie-E(i)[pe])),L(),I(!0)}if(t.contains(d))return I(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){b(document,"mousemove",this._onTouchMove),b(document,"touchmove",this._onTouchMove),b(document,"pointermove",this._onTouchMove),b(document,"dragover",oe),b(document,"mousemove",oe),b(document,"touchmove",oe)},_offUpEvents:function(){var e=this.el.ownerDocument;b(e,"mouseup",this._onDrop),b(e,"touchend",this._onDrop),b(e,"pointerup",this._onDrop),b(e,"touchcancel",this._onDrop),b(document,"selectstart",this)},_onDrop:function(e){var t=this.el,i=this.options;if($=P(d),Q=P(d,i.draggable),O("drop",this,{evt:e}),C=d&&d.parentNode,$=P(d),Q=P(d,i.draggable),p.eventCanceled){this._nulling();return}ce=!1,Ne=!1,Te=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),et(this.cloneId),et(this._dragStartId),this.nativeDraggable&&(b(document,"drop",this),b(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),we&&h(document.body,"user-select",""),h(d,"transform",""),e&&(be&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),m&&m.parentNode&&m.parentNode.removeChild(m),(_===C||x&&x.lastPutMode!=="clone")&&D&&D.parentNode&&D.parentNode.removeChild(D),d&&(this.nativeDraggable&&b(d,"dragend",this),je(d),d.style["will-change"]="",be&&!ce&&M(d,x?x.options.ghostClass:this.options.ghostClass,!1),M(d,this.options.chosenClass,!1),N({sortable:this,name:"unchoose",toEl:C,newIndex:null,newDraggableIndex:null,originalEvent:e}),_!==C?($>=0&&(N({rootEl:C,name:"add",toEl:C,fromEl:_,originalEvent:e}),N({sortable:this,name:"remove",toEl:C,originalEvent:e}),N({rootEl:C,name:"sort",toEl:C,fromEl:_,originalEvent:e}),N({sortable:this,name:"sort",toEl:C,originalEvent:e})),x&&x.save()):$!==de&&$>=0&&(N({sortable:this,name:"update",toEl:C,originalEvent:e}),N({sortable:this,name:"sort",toEl:C,originalEvent:e})),p.active&&(($==null||$===-1)&&($=de,Q=De),N({sortable:this,name:"end",toEl:C,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){O("nulling",this),_=d=C=m=re=D=Me=Z=ne=H=be=$=Q=de=De=le=Ce=x=Ie=p.dragged=p.ghost=p.clone=p.active=null,ze.forEach(function(e){e.checked=!0}),ze.length=Je=Ge=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":d&&(this._onDragOver(e),ni(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],t,i=this.el.children,n=0,o=i.length,r=this.options;n<o;n++)t=i[n],z(t,r.draggable,this.el,!1)&&e.push(t.getAttribute(r.dataIdAttr)||di(t));return e},sort:function(e,t){var i={},n=this.el;this.toArray().forEach(function(o,r){var s=n.children[r];z(s,this.options.draggable,n,!1)&&(i[o]=s)},this),t&&this.captureAnimationState(),e.forEach(function(o){i[o]&&(n.removeChild(i[o]),n.appendChild(i[o]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return z(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var i=this.options;if(t===void 0)return i[e];var n=xe.modifyOption(this,e,t);typeof n<"u"?i[e]=n:i[e]=t,e==="group"&&kt(i)},destroy:function(){O("destroy",this);var e=this.el;e[R]=null,b(e,"mousedown",this._onTapStart),b(e,"touchstart",this._onTapStart),b(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(b(e,"dragover",this),b(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),He.splice(He.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Z){if(O("hideClone",this),p.eventCanceled)return;h(D,"display","none"),this.options.removeCloneOnHide&&D.parentNode&&D.parentNode.removeChild(D),Z=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Z){if(O("showClone",this),p.eventCanceled)return;d.parentNode==_&&!this.options.group.revertClone?_.insertBefore(D,d):re?_.insertBefore(D,re):_.appendChild(D),this.options.group.revertClone&&this.animate(d,D),h(D,"display",""),Z=!1}}};function ni(a){a.dataTransfer&&(a.dataTransfer.dropEffect="move"),a.cancelable&&a.preventDefault()}function Fe(a,e,t,i,n,o,r,s){var l,c=a[R],u=c.options.onMove,f;return window.CustomEvent&&!j&&!Ee?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=a,l.dragged=t,l.draggedRect=i,l.related=n||e,l.relatedRect=o||E(e),l.willInsertAfter=s,l.originalEvent=r,a.dispatchEvent(l),u&&(f=u.call(c,l,r)),f}function je(a){a.draggable=!1}function oi(){Ze=!1}function ri(a,e,t){var i=E(fe(t.el,0,t.options,!0)),n=Tt(t.el,t.options,m),o=10;return e?a.clientX<n.left-o||a.clientY<i.top&&a.clientX<i.right:a.clientY<n.top-o||a.clientY<i.bottom&&a.clientX<i.left}function si(a,e,t){var i=E(at(t.el,t.options.draggable)),n=Tt(t.el,t.options,m),o=10;return e?a.clientX>n.right+o||a.clientY>i.bottom&&a.clientX>i.left:a.clientY>n.bottom+o||a.clientX>i.right&&a.clientY>i.top}function li(a,e,t,i,n,o,r,s){var l=i?a.clientY:a.clientX,c=i?t.height:t.width,u=i?t.top:t.left,f=i?t.bottom:t.right,g=!1;if(!r){if(s&&$e<c*n){if(!Te&&(Ce===1?l>u+c*o/2:l<f-c*o/2)&&(Te=!0),Te)g=!0;else if(Ce===1?l<u+$e:l>f-$e)return-Ce}else if(l>u+c*(1-n)/2&&l<f-c*(1-n)/2)return ci(e)}return g=g||r,g&&(l<u+c*o/2||l>f-c*o/2)?l>u+c/2?1:-1:0}function ci(a){return P(d)<P(a)?1:-1}function di(a){for(var e=a.tagName+a.className+a.src+a.href+a.textContent,t=e.length,i=0;t--;)i+=e.charCodeAt(t);return i.toString(36)}function ui(a){ze.length=0;for(var e=a.getElementsByTagName("input"),t=e.length;t--;){var i=e[t];i.checked&&ze.push(i)}}function Re(a){return setTimeout(a,0)}function et(a){return clearTimeout(a)}Xe&&y(document,"touchmove",function(a){(p.active||ce)&&a.cancelable&&a.preventDefault()});p.utils={on:y,off:b,css:h,find:wt,is:function(e,t){return!!z(e,t,e,!1)},extend:Gt,throttle:_t,closest:z,toggleClass:M,clone:Ct,index:P,nextTick:Re,cancelNextTick:et,detectDirection:xt,getChild:fe};p.get=function(a){return a[R]};p.mount=function(){for(var a=arguments.length,e=new Array(a),t=0;t<a;t++)e[t]=arguments[t];e[0].constructor===Array&&(e=e[0]),e.forEach(function(i){if(!i.prototype||!i.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(i));i.utils&&(p.utils=Y(Y({},p.utils),i.utils)),xe.mount(i)})};p.create=function(a,e){return new p(a,e)};p.version=Yt;var T=[],ye,tt,it=!1,Ue,Ke,Be,Se;function fi(){function a(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return a.prototype={dragStarted:function(t){var i=t.originalEvent;this.sortable.nativeDraggable?y(document,"dragover",this._handleAutoScroll):this.options.supportPointer?y(document,"pointermove",this._handleFallbackAutoScroll):i.touches?y(document,"touchmove",this._handleFallbackAutoScroll):y(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var i=t.originalEvent;!this.options.dragOverBubble&&!i.rootEl&&this._handleAutoScroll(i)},drop:function(){this.sortable.nativeDraggable?b(document,"dragover",this._handleAutoScroll):(b(document,"pointermove",this._handleFallbackAutoScroll),b(document,"touchmove",this._handleFallbackAutoScroll),b(document,"mousemove",this._handleFallbackAutoScroll)),gt(),Pe(),qt()},nulling:function(){Be=tt=ye=it=Se=Ue=Ke=null,T.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,i){var n=this,o=(t.touches?t.touches[0]:t).clientX,r=(t.touches?t.touches[0]:t).clientY,s=document.elementFromPoint(o,r);if(Be=t,i||this.options.forceAutoScrollFallback||Ee||j||we){Qe(t,this.options,s,i);var l=ee(s,!0);it&&(!Se||o!==Ue||r!==Ke)&&(Se&&gt(),Se=setInterval(function(){var c=ee(document.elementFromPoint(o,r),!0);c!==l&&(l=c,Pe()),Qe(t,n.options,c,i)},10),Ue=o,Ke=r)}else{if(!this.options.bubbleScroll||ee(s,!0)===X()){Pe();return}Qe(t,this.options,ee(s,!1),!1)}}},q(a,{pluginName:"scroll",initializeByDefault:!0})}function Pe(){T.forEach(function(a){clearInterval(a.pid)}),T=[]}function gt(){clearInterval(Se)}var Qe=_t(function(a,e,t,i){if(!!e.scroll){var n=(a.touches?a.touches[0]:a).clientX,o=(a.touches?a.touches[0]:a).clientY,r=e.scrollSensitivity,s=e.scrollSpeed,l=X(),c=!1,u;tt!==t&&(tt=t,Pe(),ye=e.scroll,u=e.scrollFn,ye===!0&&(ye=ee(t,!0)));var f=0,g=ye;do{var w=g,v=E(w),S=v.top,V=v.bottom,W=v.left,I=v.right,L=v.width,F=v.height,te=void 0,B=void 0,ie=w.scrollWidth,he=w.scrollHeight,A=h(w),pe=w.scrollLeft,U=w.scrollTop;w===l?(te=L<ie&&(A.overflowX==="auto"||A.overflowX==="scroll"||A.overflowX==="visible"),B=F<he&&(A.overflowY==="auto"||A.overflowY==="scroll"||A.overflowY==="visible")):(te=L<ie&&(A.overflowX==="auto"||A.overflowX==="scroll"),B=F<he&&(A.overflowY==="auto"||A.overflowY==="scroll"));var me=te&&(Math.abs(I-n)<=r&&pe+L<ie)-(Math.abs(W-n)<=r&&!!pe),J=B&&(Math.abs(V-o)<=r&&U+F<he)-(Math.abs(S-o)<=r&&!!U);if(!T[f])for(var ae=0;ae<=f;ae++)T[ae]||(T[ae]={});(T[f].vx!=me||T[f].vy!=J||T[f].el!==w)&&(T[f].el=w,T[f].vx=me,T[f].vy=J,clearInterval(T[f].pid),(me!=0||J!=0)&&(c=!0,T[f].pid=setInterval(function(){i&&this.layer===0&&p.active._onTouchMove(Be);var ge=T[this.layer].vy?T[this.layer].vy*s:0,K=T[this.layer].vx?T[this.layer].vx*s:0;typeof u=="function"&&u.call(p.dragged.parentNode[R],K,ge,a,Be,T[this.layer].el)!=="continue"||Dt(T[this.layer].el,K,ge)}.bind({layer:f}),24))),f++}while(e.bubbleScroll&&g!==l&&(g=ee(g,!1)));it=c}},30),Ot=function(e){var t=e.originalEvent,i=e.putSortable,n=e.dragEl,o=e.activeSortable,r=e.dispatchSortableEvent,s=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(!!t){var c=i||o;s();var u=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,f=document.elementFromPoint(u.clientX,u.clientY);l(),c&&!c.el.contains(f)&&(r("spill"),this.onSpill({dragEl:n,putSortable:i}))}};function nt(){}nt.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var n=fe(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(t,n):this.sortable.el.appendChild(t),this.sortable.animateAll(),i&&i.animateAll()},drop:Ot};q(nt,{pluginName:"revertOnSpill"});function ot(){}ot.prototype={onSpill:function(e){var t=e.dragEl,i=e.putSortable,n=i||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:Ot};q(ot,{pluginName:"removeOnSpill"});p.mount(new fi);p.mount(ot,nt);const hi={name:"querySet",components:{categoryTree:Ht},data(){return{row:"",datasetVisible:!1,loading:!1,state:null,setInfo:{menu_id:"",datset_id:"",datset_name:"",name:"",data:[]},hadMore:!1,showMore:!1,conditionHeight:12,enableArr:[],currentDataSetMenu:null,currentDataSet:null,tempDataSetMenu:null,tempDataSet:null,dataSetMenu:[],dataSetList:[],dataSetFields:null,dicSetRow:null,dicSetDrawer:!1,editName:!1,showSet:!0,isCbValue:!1,typeDic:[{label:"\u8F93\u5165\u6846",value:"dInput"},{label:"\u4E0B\u62C9\u9009\u62E9\u5668",value:"dSelect"},{label:"\u65E5\u671F\u9009\u62E9\u5668",value:"dTime"}],timeTypeDic:[{label:"\u65E5\u671F\u548C\u65F6\u95F4\u70B9",value:"datetime"},{label:"\u65E5\u671F\u548C\u65F6\u95F4\u8303\u56F4",value:"datetimerange"}],timeFormatDic:[{label:"\u5E74-\u6708-\u65E5",value:"yyyy-MM-dd"},{label:"\u5E74-\u6708-\u65E5 \u65F6",value:"yyyy-MM-dd HH"},{label:"\u5E74-\u6708-\u65E5 \u65F6-\u5206",value:"yyyy-MM-dd HH:mm"},{label:"\u5E74-\u6708-\u65E5 \u65F6-\u5206-\u79D2",value:"yyyy-MM-dd HH:mm:ss"}],listFlat:[],datasetViewList:[],page:{pageNum:1,pageSize:10,total:0}}},methods:{goBack(){this.state?this.$confirm("\u82E5\u5185\u5BB9\u672A\u4FDD\u5B58\u6570\u636E\u4F1A\u4E22\u5931\uFF0C\u662F\u5426\u9000\u51FA?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88"}).then(()=>{this.$router.push({name:"querypageconfig",params:{currentGroup:this.$route.params.currentGroup}})}).catch(a=>{console.log(a)}):this.$router.push({name:"querypageconfig",params:{currentGroup:this.$route.params.currentGroup}})},handleConHeight(){let a=0,e=0,t=this.$refs.tableView,i=this.$refs.conditionItem;if(t&&i&&i.length>0){let n=t.clientWidth-185,o=[],r=0,s=0;for(;s<=i.length-1;){let l=0;if(o[r]=[],i[s].clientWidth+28+1>n)o[r].push(i[s]),s++;else for(;s<=i.length-1&&l+i[s].clientWidth+28<=n;)l+=i[s].clientWidth+28,o[r].push(i[s]),s++;r++}e=o.length,console.log(o,"rows"),a=e*44}else a=0;return a>88&&!this.showMore?(this.hadMore=!0,a=88):a<=88&&(this.hadMore=!1,this.showMore=!1),a},async dataSetHandler(){this.datasetVisible=!0,await this.getSetList(this.row.dat_range);const{menu_id:a,datset_id:e}=this.setInfo;let t=this.listFlat.find(i=>i.id===a);if(t){this.currentDataSetMenu=JSON.parse(JSON.stringify(t)),this.tempDataSetMenu=JSON.parse(JSON.stringify(t)),await this.getSetTableList(this.tempDataSetMenu.id,this.row.dat_range);let i=this.dataSetList.find(n=>n.id===e);i&&(this.currentDataSet=JSON.parse(JSON.stringify(i)),this.tempDataSet=JSON.parse(JSON.stringify(i)))}},feedbackInfo(){this.loading=!0,this.setInfo=this.row.setInfo,console.log(this.setInfo,"setInfo"),this.setInfo.datset_type!=="P"&&this.setInfo.datset_id&&this.queryInfo(),this.enableArr=this.setInfo.enableArr,this.currentDataSetMenu={id:this.setInfo.menu_id},this.currentDataSet={id:this.setInfo.datset_id,datset_name:this.setInfo.datset_name,datset_type:this.setInfo.datset_type},this.$nextTick(()=>{this.rowDrop();for(let a of this.enableArr)this.$refs.setInfoTable.toggleRowSelection(a);this.loading=!1})},flatDataSetMenu(a){let e=[];for(let t of a){let i=JSON.parse(JSON.stringify(t));if(delete i.children,e.push(i),t.children&&t.children.length>0){let n=this.flatDataSetMenu(t.children);e=[...e,...n]}}return e},getCate(){this.$nextTick(()=>{this.getSetList(),this.getSetTableList("-0000")})},async chooseDataset(a){if(console.log(a,"dataset"),!this.tempDataSet||!this.tempDataSetMenu){this.$message.warning("\u8BF7\u9009\u62E9\u6570\u636E\u96C6");return}this.$confirm("\u8BE5\u64CD\u4F5C\u5C06\u6E05\u7A7A\u5DF2\u914D\u7F6E\u7684\u6570\u636E\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{this.datasetVisible=!1,await e.call(this)}).catch(t=>{console.log(t)}).finally(()=>{this.datasetVisible=!1});async function e(){let i=(await this.getSetFields(a.id)||[]).map(({name:n,describe:o})=>({id:this.$F.nanoid(),name:n,describe:o,alias:o,type:"",search:!1,width:150,dicSet:[],allowDrag:!0,props:{defVal:""},dicType:"1"}));this.$set(this.setInfo,"data",i),this.$set(this.setInfo,"enableArr",[]),this.setInfo.menu_id=this.tempDataSetMenu.id,this.setInfo.datset_id=this.tempDataSet.id,this.currentDataSetMenu=JSON.parse(JSON.stringify(this.tempDataSetMenu)),this.currentDataSet=JSON.parse(JSON.stringify(this.tempDataSet)),this.tempDataSetMenu=null,this.tempDataSet=null,this.enableArr=[],this.$nextTick(()=>{this.rowDrop();for(let n of this.setInfo.data)this.$refs.setInfoTable.toggleRowSelection(n)})}},async getSetList(a){const e=a||this.$refs.cusListTree2&&this.$refs.cusListTree2.activeTab||"0";return this.$F.isEmpty(a)||this.$nextTick(()=>{this.$refs.cusListTree2.activeTab=e}),await this.$api.customForm.getSortLst(1,e).then(t=>{const{status:i,data:n,msg:o}=t;if(i==104){let r=[{id:"-0000",name:"\u9ED8\u8BA4\u5206\u7EC4",parent_id:"0"},...n];this.listFlat=JSON.parse(JSON.stringify(r)),this.dataSetMenu=$t(r)}else this.$message({type:"warning",message:o})}).catch(()=>{})},async getSetTableList(a,e){const t=e||this.$refs.cusListTree2&&this.$refs.cusListTree2.activeTab||"0";this.$F.isEmpty(e)||this.$nextTick(()=>{this.$refs.cusListTree2.activeTab=t});const i={pageNum:0,pageSize:0,filter:{sortId:a,likeVal:"",dat_range:t}};return await this.$api.customForm.getTableList(i).then(n=>{const{status:o,data:{list:r},msg:s}=n;o==104?this.dataSetList=r||[]:this.$message({type:"warning",message:s})}).catch(()=>{})},async getSetFields(a){this.loading=!0;const e={id:a,pageNum:0,pageSize:0,total:0};return await this.$api.customForm.getDtSetFieldInfo(e).then(t=>{const{status:i,data:n}=t;if(i===104)return n.list}).finally(()=>{this.loading=!1})},handleTypeChange(a,e){let t={dInput:{defVal:""},dSelect:{defVal:"",multiple:!1},dRadio:{defVal:""},dCheckbox:{defVal:""},dTime:{defVal:[],timeType:"datetimerange",format:"yyyy-MM-dd HH:mm"}};e.props=t[a],e.dicType="1",e.dicSet=[]},filterDicInfo(a){return a?a.filter(e=>!this.$F.isEmpty(e.label)&&!this.$F.isEmpty(e.value)):[]},handleCellWidth(){return this.setInfo&&this.setInfo.data.some(e=>e.search===!0)?"140":"100"},handleSelectionChange(a){this.enableArr=a},savePageCfg(){if(this.$F.isEmpty(this.setInfo.name)){this.$message.warning({message:"\u8BF7\u8F93\u5165\u540D\u79F0",showClose:!0,duration:3e3,offset:50}),this.editName=!0,this.$nextTick(()=>{this.$refs.pageNameIpt.focus()});return}const{dat_range:a,act:e,id:t}=this.row,{datset_id:i,datset_name:n,name:o,sort_id:r,status:s}=this.setInfo;let l=this.enableArr.map(u=>u.name);l=l.join(",");let c={act:e,datset_id:i,datset_name:n,field_text:JSON.stringify(this.enableArr),fields:l,name:o,sort_id:r,status:s,dat_range:a};e==="mod"&&(c.id=t),console.log(c,"params"),this.$api.qrypage.submitQryPageCfgInfo(c).then(u=>{const{status:f,msg:g}=u;f==100?(this.$message.success("\u64CD\u4F5C\u6210\u529F"),this.$router.push({name:"querypageconfig",params:{currentGroup:this.$route.params.currentGroup}})):this.$message({type:"warning",message:g})}).catch(u=>{console.log(u)})},async handleDicOrigin(){this.isCbValue=!0,this.datasetVisible=!0,await this.getSetList();let a=this.dicSetRow.sort_id||this.listFlat[0].id,e=this.listFlat.find(i=>i.id===a);e&&(this.tempDataSetMenu=JSON.parse(JSON.stringify(e))),await this.getSetTableList(a);let t=this.dicSetRow.datset_id;if(t){let i=this.dataSetList.find(n=>n.id===t);i&&(this.tempDataSet=JSON.parse(JSON.stringify(i)))}},getActiveDic(a){if(!this.tempDataSet||!this.tempDataSetMenu){this.$message.warning("\u8BF7\u9009\u62E9\u6570\u636E\u96C6");return}const{id:e,datset_name:t}=a,i={filter:{datset_id:e,datset_name:t},pageNum:0,pageSize:0};this.$api.customForm.getBusDicLst(i).then(n=>{const{status:o,data:r}=n;if(o===104){const{list:s}=r;if(s&&s.length>0){const l=s.reduce((c,u)=>[...c,{value:u.id,label:u.name}],[]);this.dicSetRow=Object.assign(this.dicSetRow,{dicActiveSet:l,datset_name:t,datset_id:e,sort_id:this.tempDataSetMenu.id})}}}).finally(()=>{this.isCbValue=!1,this.tempDataSetMenu=null,this.tempDataSet=null,this.datasetVisible=!1})},rowDrop(a){const e=document.querySelector(".setInfoTable .el-table__body-wrapper tbody"),t=this;new p(e,{animation:300,draggable:".allowDrag",onUpdate({newIndex:i,oldIndex:n}){let o=e.children[i],r=e.children[n];e.removeChild(o),i>n?e.insertBefore(o,r):e.insertBefore(o,r.nextSibling);let s=t.setInfo.data.splice(n,1);t.setInfo.data.splice(i,0,s[0]),t.$nextTick(()=>{let l={};for(let c in t.setInfo.data){let u=t.setInfo.data[c];l[u.name]=Number(c)}t.$refs.setInfoTable.selection.sort((c,u)=>l[c.name]-l[u.name]),t.enableArr=t.$refs.setInfoTable.selection,typeof a=="function"&&a()})}})},setRowActiveClass({row:a}){return a.allowDrag===!1?"":"allowDrag"},queryInfo(){console.log(this.setInfo,"setInfo");const{datset_id:a,datset_name:e,datset_type:t}=this.setInfo;let i={pageNum:this.page.pageNum,pageSize:this.page.pageSize,filter:{datset_id:a,datset_name:e}};if(t==="P"){let n=this.enableArr.filter(r=>r.cType==="P");if(n=n.map(r=>r.props.defVal),n.some(r=>this.$F.isEmpty(r))){this.$message.warning("\u67E5\u8BE2\u6761\u4EF6\u672A\u586B\u5199");return}let o=Object.values(n).join("|");i.filter.paramValue=o}Mt(i).then(n=>{const{data:o}=n;o?(this.datasetViewList=o.list||[],this.page.total=o.total):(this.datasetViewList=[],this.page.total=0)}).finally(()=>{this.datasetViewVisible=!0})},onReset(){let a=this.$F.copy(this.enableArr);for(let e of a)Array.isArray(e.props.defVal)?e.props.defVal=[]:e.props.defVal="";this.enableArr=a}},mounted(){this.row=this.$route.params,this.row.act&&(this.state=this.row.act!=="view",this.feedbackInfo()),window.onresize=()=>{this.conditionHeight=this.handleConHeight()+12}},watch:{enableArr:{deep:!0,handler(a){this.$nextTick(()=>{this.conditionHeight=this.handleConHeight()+12})}}},beforeRouteEnter(a,e,t){a.path==="/querySet"&&e.path==="/"?t("/querypageconfig"):t()}};var pi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"querySet"},[t("div",{staticClass:"search-header"},[t("div",{staticClass:"go-back"},[t("i",{staticClass:"el-icon-my-back-search",on:{click:e.goBack}}),t("span",{staticStyle:{cursor:"pointer"},on:{click:e.goBack}},[e._v("\u8FD4\u56DE\u5217\u8868")])]),t("div",{staticClass:"page-name"},[e.editName?t("el-input",{ref:"pageNameIpt",attrs:{type:"text"},on:{blur:function(i){e.editName=!1}},model:{value:e.setInfo.name,callback:function(i){e.$set(e.setInfo,"name",typeof i=="string"?i.trim():i)},expression:"setInfo.name"}}):t("span",{attrs:{title:e.setInfo.name},on:{click:()=>{e.editName=!0,e.$nextTick(()=>{e.$refs.pageNameIpt.focus()})}}},[e._v(" "+e._s(e.setInfo.name)+" ")]),t("i",{directives:[{name:"show",rawName:"v-show",value:!e.editName&&e.row.act!=="view",expression:"!editName && row.act !== 'view'"}],staticClass:"el-icon-my-edit-search",on:{click:()=>{e.editName=!0,e.$nextTick(()=>{e.$refs.pageNameIpt.focus()})}}})],1),e.state?t("div",{staticClass:"fns"},[t("div",{staticClass:"fns-dataset",staticStyle:{cursor:"pointer"},on:{click:e.dataSetHandler}},[t("i",{staticClass:"el-icon-my-dataset-search"}),t("span",[e._v("\u6570\u636E\u96C6")])]),t("el-button",{attrs:{type:"primary"},on:{click:e.savePageCfg}},[e._v("\u4FDD\u5B58")])],1):e._e()]),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"content"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.state&&e.showSet,expression:"state && showSet"}],staticClass:"table-set"},[t("div",{staticClass:"table-set-title"},[t("span",[e._v("\u6570\u636E\u96C6\u5B57\u6BB5\u5217\u8868")]),t("i",{staticClass:"el-icon-d-arrow-left",on:{click:()=>{e.showSet=!1,e.$nextTick(()=>{e.conditionHeight=e.handleConHeight()+12})}}})]),t("el-table",{ref:"setInfoTable",staticClass:"setInfoTable",staticStyle:{width:"100%"},attrs:{data:e.setInfo.data,stripe:"",height:"calc(100% - 33px)","row-class-name":e.setRowActiveClass},on:{"selection-change":e.handleSelectionChange}},[t("template",{slot:"empty"},[t("img",{attrs:{src:st,alt:""}}),t("span",[e._v("\u6682\u65E0\u6570\u636E\u54E6\uFF5E")])]),t("el-table-column",{attrs:{type:"selection",width:"42"}}),t("el-table-column",{attrs:{width:"54",label:"\u5E8F\u53F7"},scopedSlots:e._u([{key:"default",fn:function({$index:i}){return[t("div",{staticStyle:{"text-align":"center"}},[e._v(e._s(i))])]}}])}),t("el-table-column",{attrs:{prop:"name","show-overflow-tooltip":"",label:"\u5B57\u6BB5\u540D"}}),t("el-table-column",{attrs:{prop:"alias",label:"\u522B\u540D"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-input",{attrs:{type:"text",placeholder:"\u8BF7\u8F93\u5165\u522B\u540D"},on:{focus:()=>{i.allowDrag=!1},blur:()=>{i.allowDrag=!0}},model:{value:i.alias,callback:function(n){e.$set(i,"alias",typeof n=="string"?n.trim():n)},expression:"row.alias"}})]}}])}),t("el-table-column",{attrs:{prop:"width",label:"\u5217\u5BBD",width:"100"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",size:"small"},on:{focus:()=>{i.allowDrag=!1},blur:()=>{i.allowDrag=!0}},model:{value:i.width,callback:function(n){e.$set(i,"width",typeof n=="string"?n.trim():n)},expression:"row.width"}})]}}])}),e.currentDataSet&&e.currentDataSet.datset_type!=="P"?[t("el-table-column",{attrs:{label:"\u641C\u7D22",width:"55"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-switch",{attrs:{"active-color":"#007aff","inactive-color":"#bfbfbf"},on:{change:n=>{n||(i.type="")}},model:{value:i.search,callback:function(n){e.$set(i,"search",n)},expression:"row.search"}})]}}],null,!1,2788940341)}),t("el-table-column",{attrs:{label:"\u641C\u7D22\u7C7B\u578B",width:e.handleCellWidth()},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[i.search?[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"\u8BF7\u9009\u62E9"},on:{change:n=>{e.handleTypeChange(n,i)}},model:{value:i.type,callback:function(n){e.$set(i,"type",n)},expression:"row.type"}},e._l(e.typeDic,function(n){return t("el-option",{key:n.value,attrs:{label:n.label,value:n.value}})}),1)]:e._e()]}}],null,!1,5285924)}),t("el-table-column",{attrs:{fixed:"right",label:"\u64CD\u4F5C",width:"58"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[["dRadio","dCheckbox","dSelect","dTime"].includes(i.type)?t("el-button",{staticStyle:{display:"inline-flex","font-size":"14px"},attrs:{type:"text",size:"small"},on:{click:()=>{e.dicSetRow=i,e.dicSetDrawer=!0}}},[e._v(" \u914D\u7F6E ")]):e._e()]}}],null,!1,813515237)})]:e._e()],2)],1),e.showSet?e._e():t("div",{staticClass:"show-bar"},[t("i",{staticClass:"el-icon-d-arrow-right",on:{click:()=>{e.showSet=!0,e.$nextTick(()=>{e.conditionHeight=e.handleConHeight()+12})}}})]),t("div",{ref:"tableView",staticClass:"table-view",style:{width:e.currentDataSet&&e.state?"calc(100% - 804px)":"100%"}},[t("div",{staticClass:"conditions",class:{"conditions-more":e.showMore},style:{height:`${e.conditionHeight}px`}},[t("div",{staticClass:"condition-group"},[e._l(e.enableArr.filter(i=>i.search&&i.type),function(i){return[t("div",{key:i.name,ref:"conditionItem",refInFor:!0,staticClass:"condition-item"},[t("span",{staticClass:"condition-item-label"},[e._v(e._s(i.alias)+"\uFF1A")]),i.type==="dInput"?[t("el-input",{staticClass:"condition-item-com",attrs:{onKeyUp:"value=value.replace(/[% ]+/g, '')",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",clearable:""},model:{value:i.props.defVal,callback:function(n){e.$set(i.props,"defVal",typeof n=="string"?n.trim():n)},expression:"item.props.defVal"}})]:i.type==="dSelect"?[t("el-select",{staticClass:"condition-item-com",attrs:{multiple:i.props.multiple,"collapse-tags":i.props.multiple,clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9"},model:{value:i.props.defVal,callback:function(n){e.$set(i.props,"defVal",n)},expression:"item.props.defVal"}},e._l(e.filterDicInfo(i.dicType==="1"?i.dicSet:i.dicActiveSet),function(n){return t("el-option",{key:n.value,attrs:{label:n.label,value:n.value}})}),1)]:i.type==="dRadio"?[t("el-radio-group",{staticClass:"condition-item-com",model:{value:i.defVal,callback:function(n){e.$set(i,"defVal",n)},expression:"item.defVal"}},e._l(e.filterDicInfo(i.dicSet),function(n){return t("el-radio",{key:n.value,attrs:{label:n.value}},[e._v(e._s(n.label))])}),1)]:i.type==="dTime"?[i.props.timeType==="datetime"?[t("el-date-picker",{staticClass:"condition-item-com",attrs:{format:i.props.format,"value-format":i.props.format,type:"datetime",placeholder:"\u9009\u62E9\u65E5\u671F\u65F6\u95F4"},model:{value:i.props.defVal,callback:function(n){e.$set(i.props,"defVal",n)},expression:"item.props.defVal"}})]:[t("el-date-picker",{staticClass:"condition-item-com",attrs:{size:"mini",type:"datetimerange",format:i.props.format,"value-format":i.props.format,"range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F"},model:{value:i.props.defVal,callback:function(n){e.$set(i.props,"defVal",n)},expression:"item.props.defVal"}})]]:i.type==="dCheckbox"?[t("el-checkbox-group",{staticClass:"condition-item-com",model:{value:i.props.defVal,callback:function(n){e.$set(i.props,"defVal",n)},expression:"item.props.defVal"}},e._l(e.filterDicInfo(i.dicSet),function(n){return t("el-checkbox",{key:n.value,attrs:{label:n.value}},[e._v(e._s(n.label))])}),1)]:e._e()],2)]})],2),t("div",{staticClass:"condition-btn"},[t("el-button",{on:{click:e.onReset}},[e._v("\u91CD\u7F6E")]),t("el-button",{attrs:{type:"primary"},on:{click:e.queryInfo}},[e._v("\u67E5\u8BE2")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.hadMore,expression:"hadMore"}],staticStyle:{"margin-left":"8px","font-size":"14px"},attrs:{size:"mini",type:"text",icon:e.showMore?"el-icon-caret-top":"el-icon-caret-bottom"},on:{click:()=>{e.showMore=!e.showMore,e.conditionHeight=e.handleConHeight()+12}}},[e._v(" "+e._s(e.showMore?"\u6536\u8D77":"\u5C55\u5F00")+" ")])],1)]),t("el-table",{ref:"enableTable",staticClass:"enableTable",class:{"enableTable-more":e.showMore},attrs:{data:e.datasetViewList,height:e.currentDataSet&&e.currentDataSet.datset_type!=="P"?`calc(100% - ${e.conditionHeight+12+52}px)`:`calc(100% - ${e.conditionHeight+12}px)`}},[t("template",{slot:"empty"},[t("img",{attrs:{src:st,alt:""}}),t("span",[e._v("\u6682\u65E0\u6570\u636E\u54E6\uFF5E")])]),e._l(e.enableArr.filter(i=>i.cType!=="P"),function(i,n){return[t("el-table-column",{key:n,attrs:{prop:i.name,width:i.width,label:i.alias}})]})],2),e.currentDataSet&&e.currentDataSet.datset_type!=="P"?t("d-page",{staticStyle:{padding:"8px","box-sizing":"border-box"},attrs:{"pager-count":5,"current-page":e.page.pageNum,"page-sizes":[10,20,30,50,100],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":i=>{e.page.pageNum=1,e.page.pageSize=i,e.queryInfo()},"current-change":i=>{e.page.pageNum=i,e.queryInfo()}}}):e._e()],1)]),t("el-dialog",{staticClass:"dataset-dialog",attrs:{title:"\u9009\u62E9\u6570\u636E\u96C6",visible:e.datasetVisible,"close-on-click-modal":!1,width:"938px"},on:{"update:visible":function(i){e.datasetVisible=i}}},[e.currentDataSet&&e.currentDataSet.id?t("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"8px"}},[t("div",[e._v("\u5F53\u524D\u7ED1\u5B9A\u6570\u636E\u96C6\uFF1A"+e._s(e.currentDataSet.datset_name))])]):e._e(),t("el-container",[t("el-aside",{attrs:{width:"240px"}},[t("categoryTree",{ref:"cusListTree2",attrs:{actived:e.tempDataSetMenu?e.tempDataSetMenu.id:"-0000",setList:e.dataSetMenu,list:e.listFlat,boxwidth:"240px","is-editable":!1,type:"3",treeTitle:"\u67E5\u8BE2\u9875\u9762\u914D\u7F6E"},on:{chooseType:i=>{e.tempDataSetMenu=JSON.parse(JSON.stringify(i)),e.getSetTableList(i.id)},getCate:e.getCate}})],1),t("el-main",[t("el-row",e._l(e.dataSetList,function(i){return t("el-col",{key:i.id,class:e.tempDataSet&&e.tempDataSet.id===i.id?"box-border":"",attrs:{span:12}},[t("div",{staticClass:"box-btn",on:{click:function(n){e.tempDataSet=JSON.parse(JSON.stringify(i))},dblclick:()=>{e.isCbValue?e.getActiveDic(i):e.chooseDataset(i)}}},[t("i",{staticClass:"el-icon-my-dataset2"}),t("div",{staticClass:"box-fit"},[e._v(" "+e._s(i.datset_name)+" "),t("div",{staticClass:"databaseName"},[e._v(" "+e._s(i.datset_content)+" ")])])])])}),1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:()=>{e.isCbValue?e.getActiveDic(e.tempDataSet):e.chooseDataset(e.tempDataSet)}}},[e._v(" \u786E\u5B9A ")]),t("el-button",{on:{click:()=>{e.tempDataSetMenu=null,e.tempDataSet=null,e.datasetVisible=!1,e.isCbValue=!1}}},[e._v(" \u53D6\u6D88 ")])],1)],1),t("el-drawer",{staticClass:"dic-set-drawer",attrs:{title:"\u6570\u636E\u914D\u7F6E",visible:e.dicSetDrawer,wrapperClosable:!1,direction:"rtl","before-close":()=>{e.isCbValue=!1,e.dicSetDrawer=!1},"destroy-on-close":""},on:{"update:visible":function(i){e.dicSetDrawer=i}}},[e.dicSetRow?[["dTime","dSelect"].includes(e.dicSetRow.type)?[t("div",{staticClass:"dic-set-title"},[e._v("\u5C5E\u6027\u914D\u7F6E")]),e.dicSetRow.type==="dTime"?[t("div",{staticClass:"dic-set-prop"},[t("span",[e._v("\u65E5\u671F\u9009\u62E9\u5668\u7C7B\u578B\uFF1A")]),t("el-select",{staticClass:"dic-set-prop-com",attrs:{placeholder:"\u8BF7\u9009\u62E9"},on:{change:i=>{i==="datetimerange"?e.dicSetRow.props.defVal=[]:e.dicSetRow.props.defVal=""}},model:{value:e.dicSetRow.props.timeType,callback:function(i){e.$set(e.dicSetRow.props,"timeType",i)},expression:"dicSetRow.props.timeType"}},e._l(e.timeTypeDic,function(i){return t("el-option",{key:i.value,attrs:{label:i.label,value:i.value}})}),1)],1),t("div",{staticClass:"dic-set-prop"},[t("span",[e._v("\u65E5\u671F\u683C\u5F0F\u5316\u9009\u62E9\uFF1A")]),t("el-select",{staticClass:"dic-set-prop-com",attrs:{placeholder:"\u8BF7\u9009\u62E9"},model:{value:e.dicSetRow.props.format,callback:function(i){e.$set(e.dicSetRow.props,"format",i)},expression:"dicSetRow.props.format"}},e._l(e.timeFormatDic,function(i){return t("el-option",{key:i.value,attrs:{label:i.label,value:i.value}})}),1)],1)]:[t("div",{staticClass:"dic-set-prop"},[t("span",[e._v("\u662F\u5426\u591A\u9009\uFF1A")]),t("el-switch",{staticClass:"dic-set-prop-com",attrs:{"active-color":"#007aff","inactive-color":"#bfbfbf"},on:{change:i=>{i?e.dicSetRow.props.defVal=[]:e.dicSetRow.props.defVal=""}},model:{value:e.dicSetRow.props.multiple,callback:function(i){e.$set(e.dicSetRow.props,"multiple",i)},expression:"dicSetRow.props.multiple"}})],1)]]:e._e(),e.dicSetRow.type!=="dTime"?[e.dicSetRow.type==="dSelect"?[t("div",{staticClass:"dic-set-title"},[e._v("\u5B57\u5178\u914D\u7F6E")]),t("div",{staticStyle:{color:"#9da3ac","font-size":"14px","margin-bottom":"8px"}},[e._v("\u6570\u636E\u6765\u6E90")]),t("el-select",{staticClass:"dic-origin-select",staticStyle:{width:"100%"},attrs:{placeholder:"\u8BF7\u9009\u62E9"},model:{value:e.dicSetRow.dicType,callback:function(i){e.$set(e.dicSetRow,"dicType",i)},expression:"dicSetRow.dicType"}},[t("el-option",{attrs:{label:"\u9759\u6001\u6570\u636E",value:"1"}}),t("el-option",{attrs:{label:"\u52A8\u6001\u6570\u636E",value:"2"}})],1),e.dicSetRow.dicType==="1"?t("div",{staticClass:"dic-static"},[t("div",{staticClass:"dic-con"},[t("div",{staticClass:"dic-title"},[t("span",{staticStyle:{"margin-right":"8px"}},[e._v("\u6807\u7B7E")]),t("span",[e._v("\u503C")])]),!e.dicSetRow||e.dicSetRow.dicSet.length===0?t("div",{staticStyle:{"text-align":"center"}},[e._v("\u6682\u65E0\u6570\u636E")]):e._e(),e._l(e.dicSetRow.dicSet,function(i,n){return t("div",{key:n,staticClass:"option-item"},[t("el-input",{staticStyle:{width:"126px","margin-right":"8px"},attrs:{type:"text",placeholder:"\u6807\u9898"},model:{value:i.label,callback:function(o){e.$set(i,"label",typeof o=="string"?o.trim():o)},expression:"item.label"}}),t("el-input",{staticStyle:{width:"126px","margin-right":"8px"},attrs:{type:"text",placeholder:"\u503C"},model:{value:i.value,callback:function(o){e.$set(i,"value",typeof o=="string"?o.trim():o)},expression:"item.value"}}),t("i",{staticClass:"el-icon-delete",on:{click:function(o){return e.dicSetRow.dicSet.splice(n,1)}}})],1)})],2),t("div",{staticClass:"add-btn",staticStyle:{"font-size":"14px",width:"73px"},on:{click:()=>{e.dicSetRow.dicSet.push({label:"",value:""})}}},[t("div",{staticClass:"plus"}),e._v(" \u65B0\u589E\u5173\u8054 ")])]):e.dicSetRow.dicType==="2"?t("div",{staticClass:"dic-active"},[t("div",{staticStyle:{color:"#9da3ac","font-size":"14px",margin:"8px 0"}},[e._v("\u52A8\u6001\u5B57\u5178\u6570\u636E\u6E90")]),t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"\u8BF7\u9009\u62E9"},on:{focus:e.handleDicOrigin},model:{value:e.dicSetRow.datset_name,callback:function(i){e.$set(e.dicSetRow,"datset_name",i)},expression:"dicSetRow.datset_name"}})],1):e._e()]:e.dicSetRow.type!=="dSelect"?t("div",{staticClass:"dic-set-container isStatic",staticStyle:{height:"calc(100% - 33px)"}},[!e.dicSetRow||e.dicSetRow.dicSet.length===0?t("div",{staticClass:"dic-set__empty"},[t("div",[e._v("\u6682\u65E0\u6570\u636E")]),t("el-button",{attrs:{type:"primary"},on:{click:()=>{e.dicSetRow.dicSet.push({label:"",value:""})}}},[e._v(" \u65B0\u589E\u6570\u636E ")])],1):e._l(e.dicSetRow.dicSet,function(i,n){return t("div",{key:n,staticClass:"dic-set-item"},[t("div",{staticClass:"dic-set-con"},[t("el-input",{staticStyle:{"margin-bottom":"8px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u9009\u9879\u540D\u79F0"},model:{value:i.label,callback:function(o){e.$set(i,"label",typeof o=="string"?o.trim():o)},expression:"item.label"}}),t("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u9009\u9879\u503C"},model:{value:i.value,callback:function(o){e.$set(i,"value",typeof o=="string"?o.trim():o)},expression:"item.value"}})],1),t("div",{staticClass:"dic-set-tool"},[t("i",{staticClass:"el-icon-remove-outline",staticStyle:{color:"#eb291e","margin-bottom":"8px"},on:{click:function(o){return e.dicSetRow.dicSet.splice(n,1)}}}),n==e.dicSetRow.dicSet.length-1?t("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{color:"#007aff"},on:{click:()=>{e.dicSetRow.dicSet.push({label:"",value:""})}}}):e._e()])])})],2):e._e()]:e._e()]:e._e()],2)],1)},mi=[],gi=vt(hi,pi,mi,!1,null,"497144c6",null,null);const Si=gi.exports;export{Si as default};
